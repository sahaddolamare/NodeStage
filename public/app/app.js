angular.module("stage",["ngResource","ngRoute","ui.gravatar","ngAnimate"]),angular.module("stage").config(["$routeProvider","$locationProvider",function(e,t){var r={admin:{auth:["stAuthSvc",function(e){return e.authorizeCurrentUserForRoute("admin")}]},user:{auth:["stAuthSvc",function(e){return e.authorizeAuthenticatedUserForRoute()}]},guest:{auth:["stAuthSvc",function(e){return e.unauthenticatedUser()}]}};t.html5Mode(!0),e.when("/",{templateUrl:"/partials/main/main",controller:"stMainCtrl"}).when("/admin",{templateUrl:"/partials/admin/views/admin",controller:"stAdminCtrl",resolve:r.admin}).when("/admin/ddb",{templateUrl:"/partials/admin/views/dev-dashboard",controller:"stDevDbCtrl",resolve:r.admin}).when("/admin/users/add",{templateUrl:"/partials/admin/views/add-user",controller:"stAdminCtrl",resolve:r.admin}).when("/admin/users/delete",{templateUrl:"/partials/admin/views/delete-user",controller:"stAdminCtrl",resolve:r.admin}).when("/admin/users/purge",{templateUrl:"/partials/admin/views/purge-users",controller:"stAdminCtrl",resolve:r.admin}).when("/admin/users/sync",{templateUrl:"/partials/admin/views/sync-users",controller:"stAdminCtrl",resolve:r.admin}).when("/login",{templateUrl:"/partials/account/views/login",controller:"stLoginCtrl",resolve:r.guest}).when("/signup",{templateUrl:"/partials/account/views/signup",controller:"stSignupCtrl",resolve:r.guest}).when("/settings",{templateUrl:"/partials/account/views/settings",controller:"stProfileCtrl",resolve:r.user}).otherwise({redirectTo:"/"})}]),angular.module("stage").run(["$rootScope","$location",function(e,t){e.$on("$routeChangeError",function(e,r,n,s){"not authorized"===s&&t.path("/")})}]),angular.module("stage").factory("stAuthSvc",["$http","$q","stIdentitySvc","stUserSvc",function(e,t,r,n){return{authenticateUser:function(s,o){var a=t.defer();return e.post("/login",{username:s,password:o}).then(function(e){if(e.data.success){var t=new n;delete e.data.user.hashed_pwd,delete e.data.user.salt,angular.extend(t,e.data.user),r.currentUser=t,a.resolve(!0)}else a.resolve(!1)}),a.promise},createUser:function(e){var r=new n(e),s=t.defer();return r.$save().then(function(){s.resolve()},function(e){s.reject(e.data.reason)}),s.promise},logoutUser:function(){var n=t.defer();return e.post("/logout",{logout:!0}).then(function(){r.currentUser=void 0,n.resolve()}),n.promise},purgeUsers:function(){var r=t.defer();return e({method:"PURGE",url:"/api/users"}).then(function(){console.log("User database has been purged"),r.resolve()}),r.promise},syncUsers:function(r){var n=t.defer();return e({method:"COPY",url:"/api/db",headers:{"Content-Type":"application/json"},data:{collection:"users",direction:r}}).then(function(){console.log("User database has been synced"),n.resolve()}),n.promise},updateCurrentUser:function(e){var n=t.defer(),s=angular.copy(r.currentUser);return angular.extend(s,e),s.$update().then(function(){r.currentUser=s,n.resolve()},function(e){n.reject(e.data.reason)}),n.promise},authorizeAuthenticatedUserForRoute:function(){return r.isAuthenticated()?!0:t.reject("not authorized")},authorizeCurrentUserForRoute:function(e){return r.isAuthorized(e)?!0:t.reject("not authorized")},unauthenticatedUser:function(){return r.isAuthenticated()?t.reject("user signed in"):!0}}}]),angular.module("stage").factory("stIdentitySvc",["$window","stUserSvc",function(e,t){var r;return e.stageUser&&(r=new t,delete e.stageUser.hashed_pwd,delete e.stageUser.salt,angular.extend(r,e.stageUser)),{currentUser:r,isAuthenticated:function(){return!!this.currentUser},isAuthorized:function(e){return!!this.currentUser&&this.currentUser.roles.indexOf(e)>-1}}}]),angular.module("stage").controller("stLoginCtrl",["$scope","$location","stAuthSvc","stIdentitySvc","stTickerSvc",function(e,t,r,n,s){e.identity=n,e.signin=function(o,a){return!o||!a||o.$invalid||a.$invalid?(o&&!o.$invalid||$(loginWidget.username).addClass("invalid"),a&&!a.$invalid||$(loginWidget.password).addClass("invalid"),s.error("Please enter a valid email address and password."),!1):void r.authenticateUser(o,a).then(function(r){if(r){o="",a="",e.username="",e.password="";var u=n.isAuthorized("admin")?"/admin":"/";s.notify("You have been successfully authenticated."),t.path("login")&&t.path(u),n.isAuthorized("admin")&&t.path(u)}else s.error("Invalid email address or password was given.")})},e.signout=function(){r.logoutUser().then(function(){e.username="",e.password="",s.notify("You have been signed out."),t.path("/")})}}]),angular.module("stage").directive("stLoginWidget",function(){return{restrict:"E",replace:!0,templateUrl:"/partials/account/views/login-widget"}}),angular.module("stage").controller("stProfileCtrl",["$scope","stAuthSvc","stIdentitySvc","stTickerSvc",function(e,t,r,n){e.email=r.currentUser.userName,e.firstName=r.currentUser.firstName,e.lastName=r.currentUser.lastName,e.update=function(){var r={userName:e.email,firstName:e.firstName,lastName:e.lastName};e.password&&e.password.length>0&&(r.password=e.password),t.updateCurrentUser(r).then(function(){n.notify("Your profile has been updated.")},function(e){n.error(e)})}}]),angular.module("stage").factory("stUserSvc",["$resource",function(e){var t=e("/api/users/:id",{_id:"@id"},{update:{method:"PUT",isArray:!1},purge:{method:"PURGE",isArray:!1}});return t.prototype.isAdmin=function(){return this.roles&&this.roles.indexOf("admin")>-1},t}]),angular.module("stage").controller("stAdminCtrl",["$scope","$timeout","stAdminSvc","stAdminUserSvc","stAuthSvc","stTickerSvc",function(e,t,r,n,s,o){e.env=r.whatEnv(),e.users=n.populateUsers(),e.userRes=e.users,e.userField="userName",e.userReverse=!1,e.userCurrentPage=0,e.userShowOnPage="10",e.userSyncEnabled="development"==e.env,e.userSyncDir="toloc",e.filterUsers=function(){e.userRes=[];var t=n.searchUsers(e.users,e.userSearch);e.userRes=t,e.userCurrentPage=0},e.sortUsers=function(t,r){e.userReverse=e.userField===t?!e.userReverse:!1,r&&(e.userReverse=e.userField===t?e.userReverse:!0),e.userField=t},e.createUser=function(){var t={userName:e.email,password:e.password,firstName:e.firstName,lastName:e.lastName};s.createUser(t).then(function(){o.notify("Created user account "+t.userName+"."),r.adminRedirect("/admin")},function(e){o.error(e)})},e.purgeUsers=function(){r.adminRedirect("/admin"),r.updateRoot("userPurgeInProgress",!0),t(function(){s.purgeUsers().then(function(){r.adminRedirect("/"),s.logoutUser().then(function(){t(e.purgeDone,5e3)},function(e){o.error(e),r.updateRoot("userPurgeInProgress",!1)})},function(r){o.error(r),t(e.purgeDone,5e3)})},5e3)},e.syncDb=function(n,a){"users"==n&&(r.adminRedirect("/admin"),r.updateRoot("userSyncInProgress",!0),s.syncUsers(a).then(function(){"toloc"==a?(r.adminRedirect("/"),s.logoutUser().then(function(){t(e.syncDone,5e3)},function(e){o.error(e),r.updateRoot("userSyncInProgress",!0)})):t(e.syncDone,5e3)},function(r){o.error(r),t(e.syncDone,5e3)}))},e.pageUsers=function(){return Math.ceil(e.userRes.length/e.userShowOnPage)},e.purgeDone=function(){o.notify("User database has been purged."),r.updateRoot("userPurgeInProgress",!1)},e.syncDone=function(){o.notify("User database has been synced."),r.updateRoot("userSyncInProgress",!0)}}]),angular.module("stage").factory("stAdminSvc",["$location","$parse","$rootScope","$window",function(e,t,r,n){return{adminRedirect:function(t){e.path(t)},updateRoot:function(e,r){var n=t("$rootScope."+e);n=r},whatEnv:function(){return n.env}}}]),angular.module("stage").factory("stAdminUserSvc",["$filter","stUserSvc",function(e,t){return{actionDone:function(e){switch(e){case"purge":var t="purged";$rootScope.userPurgeInProgress=!1;break;case"sync":var t="synced";$rootScope.userSyncInProgress=!1}t&&stTickerSvc.notify("User database has been "+t+".")},populateUsers:function(){return t.query()},searchUsers:function(t,r){return e("userfind")(t,r)}}}]),angular.module("stage").factory("stDevDbAzureSvc",function(){return{view:"azureStream",viewType:"view",status:!1,streamWell:"",endPoint:"/api/devdash/azureStream/",heartBeat:null}}),angular.module("stage").controller("stDevDbCtrl",["$scope","$http","$interval","$timeout","stDevDbSvc",function(e,t,r,n,s){e.currentSvc={view:null,type:null,streamWell:""},e.svcStatus={heartBeat:r(function(){var t=["devMongo","cloudMongo","azureStream"];t.forEach(function(t){"error"!==e.svcStatus[t]&&s.checkStatus(t).then(function(r){r.code?(e.svcStatus[t]="error",console.log("A fatal connection error to "+t+" has disrupted heartbeat services")):e.svcStatus[t]=r},function(e){console.log(e)})})},500)},e.changeView=function(t){"overview"==t?(e.currentSvc.view=null,e.currentSvc.type=null):(e.currentSvc.view=t,e.currentSvc.type=s.getConsoleType(t),e.currentSvc.streamWell="Connecting...",e.svcStatus[t]||s.connectService(t))},e.ddbCommand=function(){var r=e.currentSvc.view;if(console.log(r),"cmd"!==e.currentSvc.type)return!1;console.log("Type is cmd"),console.log(e.ddbCmdBar),console.log(e.checkStatus(r));var n=!1;switch(r){case"localMongo":n=e.localMongoStatus;break;case"remoteMongo":n=e.remoteMongoStatus}return n&&e.ddbCmdBar?void t.post("/api/devdash/"+r+"/command",{cmd:e.ddbCmdBar}).then(function(t){e.ddbCmdBar=""}):!1},e.ddbDisconnect=function(t){"localMongo"==t?e.localMongoStatus=!1:"remoteMongo"==t?e.remoteMongoStatus=!1:"azureStream"==t&&(e.azureStreamStatus=!1)},e.checkStatus=function(e){return s.checkStatus(e)},e.ddbStream=function(t){if("undefined"!=typeof EventSource){var r=new EventSource("/api/devdash/"+t+"/stream");r.addEventListener("message",function(t){e.$apply(function(){var r=JSON.parse(t.data);r=r.replace(/\[0m/g,""),r=r.replace(/\[36m/g,""),r=unescape(encodeURIComponent(r)),console.log(r),e.currentSvc.streamWell+=r.trim()+"\n",n(function(){var e=document.getElementById("streamWell");e.scrollTop=e.scrollHeight},50)})},!1),r.addEventListener("error",function(n){e.$apply(function(){e.ddbDisconnect(t),e.currentSvc.streamWell+="The stream for "+t+" has been unexpectedly closed.\n"}),r.close()},!1)}else e.currentSvc.streamWell="This browser does not support streaming.\n"}}]),angular.module("stage").factory("stDevDbMongoSvc",function(){return{cloud:{view:"cloudMongo",status:!1,streamWell:"",endPoint:"/api/devdash/remoteMongo/",viewType:"cmd"},dev:{view:"devMongo",status:!1,streamWell:"",endPoint:"/api/devdash/localMongo/",viewType:"cmd"}}}),angular.module("stage").factory("stDevDbSvc",["$http","$interval","$q","stDevDbAzureSvc","stDevDbMongoSvc",function(e,t,r,n,s){return{currentSvc:null,svcList:{cloudMongo:s.cloud,devMongo:s.dev,azureStream:n},sendRequest:function(t,r,n,s,o,a){return o=o?this.svcList[o]:!1,a=a?a:{},e({method:t,url:(o?o.endPoint:currentSvc.endPoint)+r,data:a}).then(n,s)},checkStatus:function(e){return e||null!=this.currentSvc?this.sendRequest("GET","status",function(e){return"Connected"==e.data.response&&200==e.status?!0:200!==e.status?{error:e.status}:!1},function(e){return{error:e.status}},e?e:!1).then(function(t){return t.error?(e||(this.currentSvc.status=!1),{code:t.error,msg:"Failed to connect to service: Unexpected response"}):t?(e||(this.currentSvc.status=!0),!0):(e||(this.currentSvc.status=!1),!1)},function(t){return e||(this.currentSvc.status=!1),{code:t.error,msg:"Failed to connect to service: Unexpected response"}}):!1},connectService:function(e){this.currentSvc=this.svcList[e];var t=this.sendRequest("GET","connect",function(e){return"Connected"==e.data.response&&200==e.status},function(e){return{error:e.status}},e);if(t.error)throw this.currentSvc.status=!1,{code:t.status,msg:"Failed to connect to service: Unexpected response"};this.currentSvc.status=!0},getConsoleType:function(e){return this.svcList[e].viewType},updateStreamWell:function(e){}}}]),angular.module("stage").filter("userStartPage",function(){return function(e,t){return t=+t,e.slice(t)}}),angular.module("stage").filter("userfind",function(){return function(e,t){var r=[];return angular.forEach(e,function(e){try{var n=new RegExp(t,"gi")}catch(s){return[]}(e.userName.match(n)||e.firstName.match(n)||e.lastName.match(n)||""==t)&&r.push({_id:e._id,userName:e.userName,firstName:e.firstName,lastName:e.lastName,roles:e.roles})}),r}}),angular.module("stage").controller("stTickerCtrl",["$scope","stTickerSvc",function(e,t){e.custom=t.custom(),e.reset=t.reset(),e.showAll=function(){$(".ticker-container").toggleClass("expanded")}}]),angular.module("stage").factory("stTickerSvc",function(){function e(e,r,o){e=r?" "+e:e;var a=$("<span></span>").addClass("ticker-msg").html(e);o&&(o=$("<span></span>").addClass("iconic iconic-sm "+o),a.prepend(o)),r&&a.addClass(r),$("#ticker").addClass("on").prepend(a),setTimeout(function(){$("#ticker").removeClass("on")},300),n?(clearTimeout(s),s=setTimeout(function(){t(),n=!1},8e3)):(n=!0,s=setTimeout(function(){t(),n=!1},8e3))}function t(){$("#ticker #ftrmsg").remove();var e=$("<span></span>").html(r).attr("id","ftrmsg");$("#ticker").addClass("on").prepend(e),setTimeout(function(){$("#ticker").removeClass("on")},300)}var r="//tardigrade/node | Tardigrade Digital &copy; 2016",n=!1,s=null;return{custom:function(t,r,n){return t?void e(t,r,"iconic-"+n):!1},notify:function(t){return t?void e(t,"success","iconic-circle-check"):!1},error:function(t){return t?void e(t,"error","iconic-circle-x"):!1},info:function(t){return t?void e(t,null,"iconic-info"):!1},reset:function(){t()}}}),angular.module("stage").controller("stMainCtrl",["$scope",function(e){}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInN0YWdlLmpzIiwiYWNjb3VudC9zdEF1dGhTdmMuanMiLCJhY2NvdW50L3N0SWRlbnRpdHlTdmMuanMiLCJhY2NvdW50L3N0TG9naW5DdHJsLmpzIiwiYWNjb3VudC9zdExvZ2luV2lkZ2V0LmpzIiwiYWNjb3VudC9zdFByb2ZpbGVDdHJsLmpzIiwiYWNjb3VudC9zdFVzZXJTdmMuanMiLCJhZG1pbi9zdEFkbWluQ3RybC5qcyIsImFkbWluL3N0QWRtaW5TdmMuanMiLCJhZG1pbi9zdEFkbWluVXNlclN2Yy5qcyIsImFkbWluL3N0RGV2RGJBenVyZVN2Yy5qcyIsImFkbWluL3N0RGV2RGJDdHJsLmpzIiwiYWRtaW4vc3REZXZEYk1vbmdvU3ZjLmpzIiwiYWRtaW4vc3REZXZEYlN2Yy5qcyIsImFkbWluL3N0UGFnZUZpbHRlci5qcyIsImFkbWluL3N0VXNlckZpbHRlci5qcyIsInRpY2tlci9zdFRpY2tlckN0cmwuanMiLCJ0aWNrZXIvc3RUaWNrZXJTdmMuanMiLCJtYWluL3N0TWFpbkN0cmwuanMiXSwibmFtZXMiOlsiYW5ndWxhciIsIm1vZHVsZSIsImNvbmZpZyIsIiRyb3V0ZVByb3ZpZGVyIiwiJGxvY2F0aW9uUHJvdmlkZXIiLCJyb3V0ZVJvbGVDaGVja3MiLCJhZG1pbiIsImF1dGgiLCJzdEF1dGhTdmMiLCJhdXRob3JpemVDdXJyZW50VXNlckZvclJvdXRlIiwidXNlciIsImF1dGhvcml6ZUF1dGhlbnRpY2F0ZWRVc2VyRm9yUm91dGUiLCJndWVzdCIsInVuYXV0aGVudGljYXRlZFVzZXIiLCJodG1sNU1vZGUiLCJ3aGVuIiwidGVtcGxhdGVVcmwiLCJjb250cm9sbGVyIiwicmVzb2x2ZSIsIm90aGVyd2lzZSIsInJlZGlyZWN0VG8iLCJydW4iLCIkcm9vdFNjb3BlIiwiJGxvY2F0aW9uIiwiJG9uIiwiZXZ0IiwiY3VycmVudCIsInByZXZpb3VzIiwicmVqZWN0aW9uIiwicGF0aCIsImZhY3RvcnkiLCIkaHR0cCIsIiRxIiwic3RJZGVudGl0eVN2YyIsInN0VXNlclN2YyIsImF1dGhlbnRpY2F0ZVVzZXIiLCJ1c2VybmFtZSIsInBhc3N3b3JkIiwiZGZkIiwiZGVmZXIiLCJwb3N0IiwidGhlbiIsInJlc3BvbnNlIiwiZGF0YSIsInN1Y2Nlc3MiLCJleHRlbmQiLCJjdXJyZW50VXNlciIsInByb21pc2UiLCJjcmVhdGVVc2VyIiwibmV3VXNlckRhdGEiLCJuZXdVc2VyIiwiJHNhdmUiLCJyZWplY3QiLCJyZWFzb24iLCJsb2dvdXRVc2VyIiwibG9nb3V0IiwidW5kZWZpbmVkIiwicHVyZ2VVc2VycyIsIm1ldGhvZCIsInVybCIsImNvbnNvbGUiLCJsb2ciLCJzeW5jVXNlcnMiLCJkaXJlY3Rpb24iLCJoZWFkZXJzIiwiQ29udGVudC1UeXBlIiwiY29sbGVjdGlvbiIsInVwZGF0ZUN1cnJlbnRVc2VyIiwiY2xvbmUiLCJjb3B5IiwiJHVwZGF0ZSIsImlzQXV0aGVudGljYXRlZCIsInJvbGUiLCJpc0F1dGhvcml6ZWQiLCIkd2luZG93Iiwic3RhZ2VVc2VyIiwidGhpcyIsInJvbGVzIiwiaW5kZXhPZiIsIiRzY29wZSIsInN0VGlja2VyU3ZjIiwiaWRlbnRpdHkiLCJzaWduaW4iLCIkaW52YWxpZCIsIiQiLCJsb2dpbldpZGdldCIsImFkZENsYXNzIiwiZXJyb3IiLCJub3RpZnkiLCJzaWdub3V0IiwiZGlyZWN0aXZlIiwicmVzdHJpY3QiLCJyZXBsYWNlIiwiZW1haWwiLCJ1c2VyTmFtZSIsImZpcnN0TmFtZSIsImxhc3ROYW1lIiwidXBkYXRlIiwibGVuZ3RoIiwiJHJlc291cmNlIiwiVXNlclJlc291cmNlIiwiX2lkIiwiaXNBcnJheSIsInB1cmdlIiwicHJvdG90eXBlIiwiaXNBZG1pbiIsIiR0aW1lb3V0Iiwic3RBZG1pblN2YyIsInN0QWRtaW5Vc2VyU3ZjIiwiZW52Iiwid2hhdEVudiIsInVzZXJzIiwicG9wdWxhdGVVc2VycyIsInVzZXJSZXMiLCJ1c2VyRmllbGQiLCJ1c2VyUmV2ZXJzZSIsInVzZXJDdXJyZW50UGFnZSIsInVzZXJTaG93T25QYWdlIiwidXNlclN5bmNFbmFibGVkIiwidXNlclN5bmNEaXIiLCJmaWx0ZXJVc2VycyIsInJlcyIsInNlYXJjaFVzZXJzIiwidXNlclNlYXJjaCIsInNvcnRVc2VycyIsImZpZWxkIiwiaW52ZXJ0IiwiYWRtaW5SZWRpcmVjdCIsInVwZGF0ZVJvb3QiLCJwdXJnZURvbmUiLCJzeW5jRGIiLCJzeW5jRGlyIiwic3luY0RvbmUiLCJwYWdlVXNlcnMiLCJNYXRoIiwiY2VpbCIsIiRwYXJzZSIsIm9iaiIsInZhbCIsInJvb3RPYmoiLCIkZmlsdGVyIiwiYWN0aW9uRG9uZSIsImFjdCIsImFjdFZlcmIiLCJ1c2VyUHVyZ2VJblByb2dyZXNzIiwidXNlclN5bmNJblByb2dyZXNzIiwicXVlcnkiLCJ2aWV3Iiwidmlld1R5cGUiLCJzdGF0dXMiLCJzdHJlYW1XZWxsIiwiZW5kUG9pbnQiLCJoZWFydEJlYXQiLCIkaW50ZXJ2YWwiLCJzdERldkRiU3ZjIiwiY3VycmVudFN2YyIsInR5cGUiLCJzdmNTdGF0dXMiLCJzdmNzIiwiZm9yRWFjaCIsInN2YyIsImNoZWNrU3RhdHVzIiwic3RhdCIsImNvZGUiLCJjaGFuZ2VWaWV3IiwiZ2V0Q29uc29sZVR5cGUiLCJjb25uZWN0U2VydmljZSIsImRkYkNvbW1hbmQiLCJkZGJDbWRCYXIiLCJzdmNTdGF0IiwibG9jYWxNb25nb1N0YXR1cyIsInJlbW90ZU1vbmdvU3RhdHVzIiwiY21kIiwiZGRiRGlzY29ubmVjdCIsImF6dXJlU3RyZWFtU3RhdHVzIiwiZGRiU3RyZWFtIiwic3RybVNvdXJjZSIsIkV2ZW50U291cmNlIiwiYWRkRXZlbnRMaXN0ZW5lciIsImV2ZW50IiwiJGFwcGx5IiwibXNnIiwiSlNPTiIsInBhcnNlIiwidW5lc2NhcGUiLCJlbmNvZGVVUklDb21wb25lbnQiLCJ0cmltIiwic3ciLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwic2Nyb2xsVG9wIiwic2Nyb2xsSGVpZ2h0IiwiZXJyIiwiY2xvc2UiLCJjbG91ZCIsImRldiIsInN0RGV2RGJBenVyZVN2YyIsInN0RGV2RGJNb25nb1N2YyIsInN2Y0xpc3QiLCJjbG91ZE1vbmdvIiwiZGV2TW9uZ28iLCJhenVyZVN0cmVhbSIsInNlbmRSZXF1ZXN0Iiwic3VjY2Vzc0NhbGxiYWNrIiwiZXJyb3JDYWxsYmFjayIsInVwZGF0ZVN0cmVhbVdlbGwiLCJmaWx0ZXIiLCJpbnB1dCIsInN0YXJ0Iiwic2xpY2UiLCJxIiwibWF0Y2hlZCIsInUiLCJleHAiLCJSZWdFeHAiLCJlIiwibWF0Y2giLCJwdXNoIiwiY3VzdG9tIiwicmVzZXQiLCJzaG93QWxsIiwidG9nZ2xlQ2xhc3MiLCJhZGRUaWNrZXIiLCJsdmwiLCJpYyIsIm1zZ29iaiIsImh0bWwiLCJwcmVwZW5kIiwic2V0VGltZW91dCIsInJlbW92ZUNsYXNzIiwidG9zZXQiLCJjbGVhclRpbWVvdXQiLCJ0byIsInJlc2V0VGlja2VyIiwicmVtb3ZlIiwiZnRyIiwiYXR0ciIsImluZm8iXSwibWFwcGluZ3MiOiJBQUFBQSxRQUFBQyxPQUFBLFNBQUEsYUFBQSxVQUFBLGNBQUEsY0FFQUQsUUFBQUMsT0FBQSxTQUFBQyxRQUFBLGlCQUFBLG9CQUFBLFNBQUFDLEVBQUFDLEdBQ0EsR0FBQUMsSUFDQUMsT0FBQUMsTUFBQSxZQUFBLFNBQUFDLEdBQUEsTUFBQUEsR0FBQUMsNkJBQUEsWUFDQUMsTUFBQUgsTUFBQSxZQUFBLFNBQUFDLEdBQUEsTUFBQUEsR0FBQUcsd0NBQ0FDLE9BQUFMLE1BQUEsWUFBQSxTQUFBQyxHQUFBLE1BQUFBLEdBQUFLLHlCQUdBVCxHQUFBVSxXQUFBLEdBQ0FYLEVBQ0FZLEtBQUEsS0FDQUMsWUFBQSxzQkFDQUMsV0FBQSxlQUVBRixLQUFBLFVBQ0FDLFlBQUEsOEJBQ0FDLFdBQUEsY0FDQUMsUUFBQWIsRUFBQUMsUUFFQVMsS0FBQSxjQUNBQyxZQUFBLHNDQUNBQyxXQUFBLGNBQ0FDLFFBQUFiLEVBQUFDLFFBRUFTLEtBQUEsb0JBQ0FDLFlBQUEsaUNBQ0FDLFdBQUEsY0FDQUMsUUFBQWIsRUFBQUMsUUFFQVMsS0FBQSx1QkFD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R0FDQTNJLEVBQUEsV0FBQUUsU0FBQSxNQUFBNkksUUFBQUYsR0FDQUcsV0FBQSxXQUFBaEosRUFBQSxXQUFBaUosWUFBQSxPQUFBLEtBQ0FDLEdBRUFDLGFBQUFDLEdBQ0FBLEVBQUFKLFdBQUEsV0FBQUssSUFBQUgsR0FBQSxHQUFBLE9BSEFBLEdBQUEsRUFBQUUsRUFBQUosV0FBQSxXQUFBSyxJQUFBSCxHQUFBLEdBQUEsTUFPQSxRQUFBRyxLQUNBckosRUFBQSxtQkFBQXNKLFFBQ0EsSUFBQVQsR0FBQTdJLEVBQUEsaUJBQUE4SSxLQUFBUyxHQUFBQyxLQUFBLEtBQUEsU0FDQXhKLEdBQUEsV0FBQUUsU0FBQSxNQUFBNkksUUFBQUYsR0FDQUcsV0FBQSxXQUFBaEosRUFBQSxXQUFBaUosWUFBQSxPQUFBLEtBekJBLEdBQUFNLEdBQUEscURBQ0FMLEdBQUEsRUFDQUUsRUFBQSxJQTBCQSxRQUNBZCxPQUFBLFNBQUFyQyxFQUFBMEMsRUFBQUMsR0FBQSxNQUFBM0MsT0FBQXlDLEdBQUF6QyxFQUFBMEMsRUFBQSxVQUFBQyxJQUFBLEdBQ0F4SSxPQUFBLFNBQUE2RixHQUFBLE1BQUFBLE9BQUF5QyxHQUFBekMsRUFBQSxVQUFBLHdCQUFBLEdBQ0E5RixNQUFBLFNBQUE4RixHQUFBLE1BQUFBLE9BQUF5QyxHQUFBekMsRUFBQSxRQUFBLG9CQUFBLEdBQ0F3RCxLQUFBLFNBQUF4RCxHQUFBLE1BQUFBLE9BQUF5QyxHQUFBekMsRUFBQSxLQUFBLGdCQUFBLEdBQ0FzQyxNQUFBLFdBQUFjLFFDbENBek8sUUFBQUMsT0FBQSxTQUFBZ0IsV0FBQSxjQUFBLFNBQUEsU0FBQThEIiwiZmlsZSI6ImFwcC5qcyIsInNvdXJjZXNDb250ZW50IjpbImFuZ3VsYXIubW9kdWxlKCdzdGFnZScsIFsnbmdSZXNvdXJjZScsICduZ1JvdXRlJywgJ3VpLmdyYXZhdGFyJywgJ25nQW5pbWF0ZSddKTtcclxuXHJcbmFuZ3VsYXIubW9kdWxlKCdzdGFnZScpLmNvbmZpZyhmdW5jdGlvbigkcm91dGVQcm92aWRlciwgJGxvY2F0aW9uUHJvdmlkZXIpIHtcclxuICB2YXIgcm91dGVSb2xlQ2hlY2tzID0ge1xyXG4gICAgYWRtaW46IHsgYXV0aDogLypAbmdJbmplY3QqLyBmdW5jdGlvbihzdEF1dGhTdmMpIHsgcmV0dXJuIHN0QXV0aFN2Yy5hdXRob3JpemVDdXJyZW50VXNlckZvclJvdXRlKCdhZG1pbicpOyB9IH0sXHJcbiAgICB1c2VyOiB7IGF1dGg6IC8qQG5nSW5qZWN0Ki8gZnVuY3Rpb24oc3RBdXRoU3ZjKSB7IHJldHVybiBzdEF1dGhTdmMuYXV0aG9yaXplQXV0aGVudGljYXRlZFVzZXJGb3JSb3V0ZSgpOyB9IH0sXHJcbiAgICBndWVzdDogeyBhdXRoOiAvKkBuZ0luamVjdCovIGZ1bmN0aW9uKHN0QXV0aFN2YykgeyByZXR1cm4gc3RBdXRoU3ZjLnVuYXV0aGVudGljYXRlZFVzZXIoKTsgfSB9XHJcbiAgfVxyXG5cclxuICAkbG9jYXRpb25Qcm92aWRlci5odG1sNU1vZGUodHJ1ZSk7XHJcbiAgJHJvdXRlUHJvdmlkZXJcclxuICAgIC53aGVuKCcvJywgeyBcclxuICAgICAgdGVtcGxhdGVVcmw6ICcvcGFydGlhbHMvbWFpbi9tYWluJywgXHJcbiAgICAgIGNvbnRyb2xsZXI6ICdzdE1haW5DdHJsJ1xyXG4gICAgfSlcclxuICAgIC53aGVuKCcvYWRtaW4nLCB7XHJcbiAgICAgIHRlbXBsYXRlVXJsOiAnL3BhcnRpYWxzL2FkbWluL3ZpZXdzL2FkbWluJywgXHJcbiAgICAgIGNvbnRyb2xsZXI6ICdzdEFkbWluQ3RybCcsIFxyXG4gICAgICByZXNvbHZlOiByb3V0ZVJvbGVDaGVja3MuYWRtaW5cclxuICAgIH0pXHJcbiAgICAud2hlbignL2FkbWluL2RkYicsIHtcclxuICAgICAgdGVtcGxhdGVVcmw6ICcvcGFydGlhbHMvYWRtaW4vdmlld3MvZGV2LWRhc2hib2FyZCcsIFxyXG4gICAgICBjb250cm9sbGVyOiAnc3REZXZEYkN0cmwnLCBcclxuICAgICAgcmVzb2x2ZTogcm91dGVSb2xlQ2hlY2tzLmFkbWluXHJcbiAgICB9KVxyXG4gICAgLndoZW4oJy9hZG1pbi91c2Vycy9hZGQnLCB7XHJcbiAgICAgIHRlbXBsYXRlVXJsOiAnL3BhcnRpYWxzL2FkbWluL3ZpZXdzL2FkZC11c2VyJywgXHJcbiAgICAgIGNvbnRyb2xsZXI6ICdzdEFkbWluQ3RybCcsIFxyXG4gICAgICByZXNvbHZlOiByb3V0ZVJvbGVDaGVja3MuYWRtaW5cclxuICAgIH0pXHJcbiAgICAud2hlbignL2FkbWluL3VzZXJzL2RlbGV0ZScsIHtcclxuICAgICAgdGVtcGxhdGVVcmw6ICcvcGFydGlhbHMvYWRtaW4vdmlld3MvZGVsZXRlLXVzZXInLCBcclxuICAgICAgY29udHJvbGxlcjogJ3N0QWRtaW5DdHJsJywgXHJcbiAgICAgIHJlc29sdmU6IHJvdXRlUm9sZUNoZWNrcy5hZG1pblxyXG4gICAgfSlcclxuICAgIC53aGVuKCcvYWRtaW4vdXNlcnMvcHVyZ2UnLCB7XHJcbiAgICAgIHRlbXBsYXRlVXJsOiAnL3BhcnRpYWxzL2FkbWluL3ZpZXdzL3B1cmdlLXVzZXJzJywgXHJcbiAgICAgIGNvbnRyb2xsZXI6ICdzdEFkbWluQ3RybCcsIFxyXG4gICAgICByZXNvbHZlOiByb3V0ZVJvbGVDaGVja3MuYWRtaW5cclxuICAgIH0pXHJcbiAgICAud2hlbignL2FkbWluL3VzZXJzL3N5bmMnLCB7XHJcbiAgICAgIHRlbXBsYXRlVXJsOiAnL3BhcnRpYWxzL2FkbWluL3ZpZXdzL3N5bmMtdXNlcnMnLCBcclxuICAgICAgY29udHJvbGxlcjogJ3N0QWRtaW5DdHJsJywgXHJcbiAgICAgIHJlc29sdmU6IHJvdXRlUm9sZUNoZWNrcy5hZG1pblxyXG4gICAgfSlcclxuICAgIC53aGVuKCcvbG9naW4nLCB7XHJcbiAgICAgIHRlbXBsYXRlVXJsOiAnL3BhcnRpYWxzL2FjY291bnQvdmlld3MvbG9naW4nLCBcclxuICAgICAgY29udHJvbGxlcjogJ3N0TG9naW5DdHJsJyxcclxuICAgICAgcmVzb2x2ZTogcm91dGVSb2xlQ2hlY2tzLmd1ZXN0XHJcbiAgICB9KVxyXG4gICAgLndoZW4oJy9zaWdudXAnLCB7XHJcbiAgICAgIHRlbXBsYXRlVXJsOiAnL3BhcnRpYWxzL2FjY291bnQvdmlld3Mvc2lnbnVwJywgXHJcbiAgICAgIGNvbnRyb2xsZXI6ICdzdFNpZ251cEN0cmwnLFxyXG4gICAgICByZXNvbHZlOiByb3V0ZVJvbGVDaGVja3MuZ3Vlc3RcclxuICAgIH0pXHJcbiAgICAud2hlbignL3NldHRpbmdzJywge1xyXG4gICAgICB0ZW1wbGF0ZVVybDogJy9wYXJ0aWFscy9hY2NvdW50L3ZpZXdzL3NldHRpbmdzJywgXHJcbiAgICAgIGNvbnRyb2xsZXI6ICdzdFByb2ZpbGVDdHJsJyxcclxuICAgICAgcmVzb2x2ZTogcm91dGVSb2xlQ2hlY2tzLnVzZXJcclxuICAgIH0pXHJcbiAgICAub3RoZXJ3aXNlKHtcclxuICAgICAgcmVkaXJlY3RUbzogJy8nXHJcbiAgICB9KTtcclxufSk7XHJcblxyXG5hbmd1bGFyLm1vZHVsZSgnc3RhZ2UnKS5ydW4oZnVuY3Rpb24oJHJvb3RTY29wZSwgJGxvY2F0aW9uKSB7XHJcbiAgJHJvb3RTY29wZS4kb24oJyRyb3V0ZUNoYW5nZUVycm9yJywgZnVuY3Rpb24oZXZ0LCBjdXJyZW50LCBwcmV2aW91cywgcmVqZWN0aW9uKSB7XHJcbiAgICBpZihyZWplY3Rpb24gPT09ICdub3QgYXV0aG9yaXplZCcpIHtcclxuICAgICAgJGxvY2F0aW9uLnBhdGgoJy8nKTtcclxuICAgIH1cclxuICB9KVxyXG59KTsiLCJhbmd1bGFyLm1vZHVsZSgnc3RhZ2UnKS5mYWN0b3J5KCdzdEF1dGhTdmMnLCBmdW5jdGlvbigkaHR0cCwgJHEsIHN0SWRlbnRpdHlTdmMsIHN0VXNlclN2Yykge1xyXG4gIHJldHVybiB7XHJcbiAgICAvLyBhdXRoZW50aWNhdGVVc2VyOiBWZXJpZmllcyBsb2dpbiBjcmVkZW50aWFscyBhbmQgc2lnbnMgaW4gdXNlclxyXG4gICAgYXV0aGVudGljYXRlVXNlcjogZnVuY3Rpb24odXNlcm5hbWUsIHBhc3N3b3JkKSB7XHJcbiAgICAgIHZhciBkZmQgPSAkcS5kZWZlcigpO1xyXG4gICAgICAkaHR0cC5wb3N0KCcvbG9naW4nLCB7dXNlcm5hbWU6dXNlcm5hbWUsIHBhc3N3b3JkOnBhc3N3b3JkfSkudGhlbihmdW5jdGlvbihyZXNwb25zZSkge1xyXG4gICAgICAgIGlmKHJlc3BvbnNlLmRhdGEuc3VjY2Vzcykge1xyXG4gICAgICAgICAgdmFyIHVzZXIgPSBuZXcgc3RVc2VyU3ZjKCk7XHJcbiAgICAgICAgICBkZWxldGUgcmVzcG9uc2UuZGF0YS51c2VyWydoYXNoZWRfcHdkJ107XHJcbiAgICAgICAgICBkZWxldGUgcmVzcG9uc2UuZGF0YS51c2VyWydzYWx0J107XHJcbiAgICAgICAgICBhbmd1bGFyLmV4dGVuZCh1c2VyLCByZXNwb25zZS5kYXRhLnVzZXIpO1xyXG4gICAgICAgICAgc3RJZGVudGl0eVN2Yy5jdXJyZW50VXNlciA9IHVzZXI7XHJcbiAgICAgICAgICBkZmQucmVzb2x2ZSh0cnVlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICBkZmQucmVzb2x2ZShmYWxzZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgICAgcmV0dXJuIGRmZC5wcm9taXNlO1xyXG4gICAgfSxcclxuICAgIFxyXG4gICAgLy8gY3JlYXRlVXNlcjogQ3JlYXRlcyBhIG5ldyB1c2VyXHJcbiAgICBjcmVhdGVVc2VyOiBmdW5jdGlvbihuZXdVc2VyRGF0YSkge1xyXG4gICAgICB2YXIgbmV3VXNlciA9IG5ldyBzdFVzZXJTdmMobmV3VXNlckRhdGEpO1xyXG4gICAgICB2YXIgZGZkID0gJHEuZGVmZXIoKTtcclxuICAgICAgXHJcbiAgICAgIG5ld1VzZXIuJHNhdmUoKS50aGVuKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGRmZC5yZXNvbHZlKCk7XHJcbiAgICAgIH0sIGZ1bmN0aW9uKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgZGZkLnJlamVjdChyZXNwb25zZS5kYXRhLnJlYXNvbik7XHJcbiAgICAgIH0pXHJcbiAgICAgIFxyXG4gICAgICByZXR1cm4gZGZkLnByb21pc2U7XHJcbiAgICB9LFxyXG4gICAgXHJcbiAgICAvLyBsb2dvdXRVc2VyOiBFbmRzIHRoZSBjdXJyZW50IHVzZXIncyBzZXNzaW9uXHJcbiAgICBsb2dvdXRVc2VyOiBmdW5jdGlvbigpIHtcclxuICAgICAgdmFyIGRmZCA9ICRxLmRlZmVyKCk7XHJcbiAgICAgICRodHRwLnBvc3QoJy9sb2dvdXQnLCB7bG9nb3V0OiB0cnVlfSkudGhlbihmdW5jdGlvbigpIHtcclxuICAgICAgICBzdElkZW50aXR5U3ZjLmN1cnJlbnRVc2VyID0gdW5kZWZpbmVkO1xyXG4gICAgICAgIGRmZC5yZXNvbHZlKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgICByZXR1cm4gZGZkLnByb21pc2U7XHJcbiAgICB9LFxyXG4gICAgXHJcbiAgICAvL3B1cmdlVXNlcnM6IFJlbW92ZXMgYWxsIHVzZXJzIGFuZCByZXN0b3JlcyB1c2VyIGRhdGFiYXNlIHRvIGRlZmF1bHRzXHJcbiAgICBwdXJnZVVzZXJzOiBmdW5jdGlvbigpIHtcclxuICAgICAgdmFyIGRmZCA9ICRxLmRlZmVyKCk7XHJcbiAgICAgICRodHRwKHtcclxuICAgICAgICBtZXRob2Q6ICdQVVJHRScsXHJcbiAgICAgICAgdXJsOiAnL2FwaS91c2VycydcclxuICAgICAgfSkudGhlbihmdW5jdGlvbigpIHtcclxuICAgICAgICBjb25zb2xlLmxvZygnVXNlciBkYXRhYmFzZSBoYXMgYmVlbiBwdXJnZWQnKTtcclxuICAgICAgICBkZmQucmVzb2x2ZSgpO1xyXG4gICAgICB9KTtcclxuICAgICAgcmV0dXJuIGRmZC5wcm9taXNlO1xyXG4gICAgfSxcclxuICAgIFxyXG4gICAgLy8gc3luY1VzZXJzOiBTeW5jcyB1c2VyIGRhdGFiYXNlIGNvbGxlY3Rpb25cclxuICAgIHN5bmNVc2VyczogZnVuY3Rpb24oZGlyZWN0aW9uKSB7XHJcbiAgICAgIHZhciBkZmQgPSAkcS5kZWZlcigpO1xyXG4gICAgICAkaHR0cCh7XHJcbiAgICAgICAgbWV0aG9kOiAnQ09QWScsXHJcbiAgICAgICAgdXJsOiAnL2FwaS9kYicsXHJcbiAgICAgICAgaGVhZGVyczogeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nIH0sXHJcbiAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgY29sbGVjdGlvbjogJ3VzZXJzJyxcclxuICAgICAgICAgIGRpcmVjdGlvbjogZGlyZWN0aW9uXHJcbiAgICAgICAgfVxyXG4gICAgICB9KS50aGVuKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdVc2VyIGRhdGFiYXNlIGhhcyBiZWVuIHN5bmNlZCcpO1xyXG4gICAgICAgIGRmZC5yZXNvbHZlKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgICByZXR1cm4gZGZkLnByb21pc2U7XHJcbiAgICB9LFxyXG4gICAgXHJcbiAgICAvLyB1cGRhdGVDdXJyZW50VXNlcjogVXBkYXRlcyBwcm9maWxlIG9mIGN1cnJlbnQgdXNlclxyXG4gICAgdXBkYXRlQ3VycmVudFVzZXI6IGZ1bmN0aW9uKG5ld1VzZXJEYXRhKSB7XHJcbiAgICAgIHZhciBkZmQgPSAkcS5kZWZlcigpO1xyXG4gICAgICBcclxuICAgICAgdmFyIGNsb25lID0gYW5ndWxhci5jb3B5KHN0SWRlbnRpdHlTdmMuY3VycmVudFVzZXIpO1xyXG4gICAgICBhbmd1bGFyLmV4dGVuZChjbG9uZSwgbmV3VXNlckRhdGEpO1xyXG4gICAgICBjbG9uZS4kdXBkYXRlKCkudGhlbihmdW5jdGlvbigpIHtcclxuICAgICAgICBzdElkZW50aXR5U3ZjLmN1cnJlbnRVc2VyID0gY2xvbmU7XHJcbiAgICAgICAgZGZkLnJlc29sdmUoKTtcclxuICAgICAgfSwgZnVuY3Rpb24ocmVzcG9uc2UpIHtcclxuICAgICAgICBkZmQucmVqZWN0KHJlc3BvbnNlLmRhdGEucmVhc29uKTtcclxuICAgICAgfSk7XHJcbiAgICAgIHJldHVybiBkZmQucHJvbWlzZTtcclxuICAgIH0sXHJcbiAgICBcclxuICAgIC8vIGF1dGhvcml6ZUF1dGhlbnRpY2F0ZWRVc2VyRm9yUm91dGU6IENoZWNrcyB3aGV0aGVyIHVzZXIgaXMgc2lnbmVkIGluXHJcbiAgICBhdXRob3JpemVBdXRoZW50aWNhdGVkVXNlckZvclJvdXRlOiBmdW5jdGlvbigpIHtcclxuICAgICAgaWYoc3RJZGVudGl0eVN2Yy5pc0F1dGhlbnRpY2F0ZWQoKSkgeyByZXR1cm4gdHJ1ZTsgfVxyXG4gICAgICBlbHNlIHsgcmV0dXJuICRxLnJlamVjdCgnbm90IGF1dGhvcml6ZWQnKTsgfVxyXG4gICAgfSxcclxuICAgIFxyXG4gICAgLy8gYXV0aG9yaXplQ3VycmVudFVzZXJGb3JSb3V0ZTogQ2hlY2tzIHdoZXRoZXIgY3VyZW50IHVzZXIgaGFzIHJvbGVcclxuICAgIGF1dGhvcml6ZUN1cnJlbnRVc2VyRm9yUm91dGU6IGZ1bmN0aW9uKHJvbGUpIHtcclxuICAgICAgaWYoc3RJZGVudGl0eVN2Yy5pc0F1dGhvcml6ZWQocm9sZSkpIHsgcmV0dXJuIHRydWU7IH1cclxuICAgICAgZWxzZSB7IHJldHVybiAkcS5yZWplY3QoJ25vdCBhdXRob3JpemVkJyk7IH1cclxuICAgIH0sXHJcbiAgICBcclxuICAgIC8vIHVuYXV0aGVudGljYXRlZFVzZXI6IENoZWNrcyB3aGV0aGVyIHVzZXIgaXMgbm90IHNpZ25lZCBpblxyXG4gICAgdW5hdXRoZW50aWNhdGVkVXNlcjogZnVuY3Rpb24oKSB7XHJcbiAgICAgIGlmKCFzdElkZW50aXR5U3ZjLmlzQXV0aGVudGljYXRlZCgpKSB7IHJldHVybiB0cnVlOyB9XHJcbiAgICAgIGVsc2UgeyByZXR1cm4gJHEucmVqZWN0KCd1c2VyIHNpZ25lZCBpbicpOyB9XHJcbiAgICB9XHJcbiAgfVxyXG59KTsiLCJhbmd1bGFyLm1vZHVsZSgnc3RhZ2UnKS5mYWN0b3J5KCdzdElkZW50aXR5U3ZjJywgZnVuY3Rpb24oJHdpbmRvdywgc3RVc2VyU3ZjKSB7XHJcbiAgdmFyIGN1cnJlbnRVc2VyO1xyXG4gIGlmKCR3aW5kb3cuc3RhZ2VVc2VyKSB7IFxyXG4gICAgY3VycmVudFVzZXIgPSBuZXcgc3RVc2VyU3ZjKCk7XHJcbiAgICBkZWxldGUgJHdpbmRvdy5zdGFnZVVzZXJbJ2hhc2hlZF9wd2QnXTtcclxuICAgIGRlbGV0ZSAkd2luZG93LnN0YWdlVXNlclsnc2FsdCddO1xyXG4gICAgYW5ndWxhci5leHRlbmQoY3VycmVudFVzZXIsICR3aW5kb3cuc3RhZ2VVc2VyKTtcclxuICB9XHJcbiAgcmV0dXJuIHtcclxuICAgIGN1cnJlbnRVc2VyOiBjdXJyZW50VXNlcixcclxuICAgIGlzQXV0aGVudGljYXRlZDogZnVuY3Rpb24oKSB7IHJldHVybiAhIXRoaXMuY3VycmVudFVzZXI7IH0sXHJcbiAgICBpc0F1dGhvcml6ZWQ6IGZ1bmN0aW9uKHJvbGUpIHsgcmV0dXJuICEhdGhpcy5jdXJyZW50VXNlciAmJiB0aGlzLmN1cnJlbnRVc2VyLnJvbGVzLmluZGV4T2Yocm9sZSkgPiAtMTsgfVxyXG4gIH1cclxufSk7IiwiYW5ndWxhci5tb2R1bGUoJ3N0YWdlJykuY29udHJvbGxlcignc3RMb2dpbkN0cmwnLCBmdW5jdGlvbigkc2NvcGUsICRsb2NhdGlvbiwgc3RBdXRoU3ZjLCBzdElkZW50aXR5U3ZjLCBzdFRpY2tlclN2Yykge1xyXG4gICRzY29wZS5pZGVudGl0eSA9IHN0SWRlbnRpdHlTdmM7XHJcbiAgJHNjb3BlLnNpZ25pbiA9IGZ1bmN0aW9uKHVzZXJuYW1lLCBwYXNzd29yZCkge1xyXG4gICAgaWYoIXVzZXJuYW1lIHx8ICFwYXNzd29yZCB8fCB1c2VybmFtZS4kaW52YWxpZCB8fCBwYXNzd29yZC4kaW52YWxpZCkge1xyXG4gICAgICBpZighdXNlcm5hbWUgfHwgdXNlcm5hbWUuJGludmFsaWQpIHsgJChsb2dpbldpZGdldC51c2VybmFtZSkuYWRkQ2xhc3MoJ2ludmFsaWQnKTsgfVxyXG4gICAgICBpZighcGFzc3dvcmQgfHwgcGFzc3dvcmQuJGludmFsaWQpIHsgJChsb2dpbldpZGdldC5wYXNzd29yZCkuYWRkQ2xhc3MoJ2ludmFsaWQnKTsgfVxyXG4gICAgICBzdFRpY2tlclN2Yy5lcnJvcignUGxlYXNlIGVudGVyIGEgdmFsaWQgZW1haWwgYWRkcmVzcyBhbmQgcGFzc3dvcmQuJyk7XHJcbiAgICAgIHJldHVybiBmYWxzZTsgIFxyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgIHN0QXV0aFN2Yy5hdXRoZW50aWNhdGVVc2VyKHVzZXJuYW1lLCBwYXNzd29yZCkudGhlbihmdW5jdGlvbihzdWNjZXNzKSB7XHJcbiAgICAgICAgaWYoc3VjY2Vzcykge1xyXG4gICAgICAgICAgdXNlcm5hbWUgPSAnJztcclxuICAgICAgICAgIHBhc3N3b3JkID0gJyc7XHJcbiAgICAgICAgICAkc2NvcGUudXNlcm5hbWUgPSAnJztcclxuICAgICAgICAgICRzY29wZS5wYXNzd29yZCA9ICcnO1xyXG4gICAgICAgICAgdmFyIHBhdGggPSBzdElkZW50aXR5U3ZjLmlzQXV0aG9yaXplZCgnYWRtaW4nKSA/ICcvYWRtaW4nIDogJy8nO1xyXG4gICAgICAgICAgc3RUaWNrZXJTdmMubm90aWZ5KCdZb3UgaGF2ZSBiZWVuIHN1Y2Nlc3NmdWxseSBhdXRoZW50aWNhdGVkLicpO1xyXG4gICAgICAgICAgaWYoJGxvY2F0aW9uLnBhdGgoJ2xvZ2luJykpIHsgJGxvY2F0aW9uLnBhdGgocGF0aCk7IH1cclxuICAgICAgICAgIGlmKHN0SWRlbnRpdHlTdmMuaXNBdXRob3JpemVkKCdhZG1pbicpKSB7ICRsb2NhdGlvbi5wYXRoKHBhdGgpOyB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgeyBzdFRpY2tlclN2Yy5lcnJvcignSW52YWxpZCBlbWFpbCBhZGRyZXNzIG9yIHBhc3N3b3JkIHdhcyBnaXZlbi4nKSB9XHJcbiAgICAgIH0pOyAgICAgIFxyXG4gICAgfVxyXG4gIH1cclxuICBcclxuICAkc2NvcGUuc2lnbm91dCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgc3RBdXRoU3ZjLmxvZ291dFVzZXIoKS50aGVuKGZ1bmN0aW9uKCkge1xyXG4gICAgICAkc2NvcGUudXNlcm5hbWUgPSBcIlwiO1xyXG4gICAgICAkc2NvcGUucGFzc3dvcmQgPSBcIlwiO1xyXG4gICAgICBzdFRpY2tlclN2Yy5ub3RpZnkoJ1lvdSBoYXZlIGJlZW4gc2lnbmVkIG91dC4nKTtcclxuICAgICAgJGxvY2F0aW9uLnBhdGgoJy8nKTtcclxuICAgIH0pXHJcbiAgfVxyXG59KTsiLCJhbmd1bGFyLm1vZHVsZSgnc3RhZ2UnKS5kaXJlY3RpdmUoJ3N0TG9naW5XaWRnZXQnLCBmdW5jdGlvbigpIHtcclxuICByZXR1cm4ge1xyXG4gICAgcmVzdHJpY3Q6ICdFJyxcclxuICAgIHJlcGxhY2U6IHRydWUsXHJcbiAgICB0ZW1wbGF0ZVVybDogJy9wYXJ0aWFscy9hY2NvdW50L3ZpZXdzL2xvZ2luLXdpZGdldCdcclxuICB9O1xyXG59KTsiLCJhbmd1bGFyLm1vZHVsZSgnc3RhZ2UnKS5jb250cm9sbGVyKCdzdFByb2ZpbGVDdHJsJywgZnVuY3Rpb24oJHNjb3BlLCBzdEF1dGhTdmMsIHN0SWRlbnRpdHlTdmMsIHN0VGlja2VyU3ZjKSB7XHJcbiAgJHNjb3BlLmVtYWlsID0gc3RJZGVudGl0eVN2Yy5jdXJyZW50VXNlci51c2VyTmFtZTtcclxuICAkc2NvcGUuZmlyc3ROYW1lID0gc3RJZGVudGl0eVN2Yy5jdXJyZW50VXNlci5maXJzdE5hbWU7XHJcbiAgJHNjb3BlLmxhc3ROYW1lID0gc3RJZGVudGl0eVN2Yy5jdXJyZW50VXNlci5sYXN0TmFtZTtcclxuICBcclxuICAkc2NvcGUudXBkYXRlID0gZnVuY3Rpb24oKSB7XHJcbiAgICB2YXIgbmV3VXNlckRhdGEgPSB7XHJcbiAgICAgIHVzZXJOYW1lOiAkc2NvcGUuZW1haWwsXHJcbiAgICAgIGZpcnN0TmFtZTogJHNjb3BlLmZpcnN0TmFtZSxcclxuICAgICAgbGFzdE5hbWU6ICRzY29wZS5sYXN0TmFtZVxyXG4gICAgfVxyXG5cclxuICAgIGlmKCRzY29wZS5wYXNzd29yZCAmJiAkc2NvcGUucGFzc3dvcmQubGVuZ3RoID4gMCkgeyBuZXdVc2VyRGF0YS5wYXNzd29yZCA9ICRzY29wZS5wYXNzd29yZDsgfVxyXG5cclxuICAgIHN0QXV0aFN2Yy51cGRhdGVDdXJyZW50VXNlcihuZXdVc2VyRGF0YSkudGhlbihcclxuICAgICAgZnVuY3Rpb24oKSB7IHN0VGlja2VyU3ZjLm5vdGlmeSgnWW91ciBwcm9maWxlIGhhcyBiZWVuIHVwZGF0ZWQuJykgfSwgXHJcbiAgICAgIGZ1bmN0aW9uKHJlYXNvbikgeyBzdFRpY2tlclN2Yy5lcnJvcihyZWFzb24pOyB9XHJcbiAgICApO1xyXG4gIH1cclxufSk7IiwiYW5ndWxhci5tb2R1bGUoJ3N0YWdlJykuZmFjdG9yeSgnc3RVc2VyU3ZjJywgZnVuY3Rpb24oJHJlc291cmNlKSB7XHJcbiAgdmFyIFVzZXJSZXNvdXJjZSA9ICRyZXNvdXJjZSgnL2FwaS91c2Vycy86aWQnLCB7X2lkOiBcIkBpZFwifSwge1xyXG4gICAgdXBkYXRlOiB7bWV0aG9kOiAnUFVUJywgaXNBcnJheTogZmFsc2V9LFxyXG4gICAgcHVyZ2U6IHttZXRob2Q6ICdQVVJHRScsIGlzQXJyYXk6IGZhbHNlfVxyXG4gIH0pO1xyXG4gIFxyXG4gIFVzZXJSZXNvdXJjZS5wcm90b3R5cGUuaXNBZG1pbiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgcmV0dXJuIHRoaXMucm9sZXMgJiYgdGhpcy5yb2xlcy5pbmRleE9mKCdhZG1pbicpID4gLTE7XHJcbiAgfVxyXG4gIFxyXG4gIHJldHVybiBVc2VyUmVzb3VyY2U7XHJcbn0pIiwiYW5ndWxhci5tb2R1bGUoJ3N0YWdlJykuY29udHJvbGxlcignc3RBZG1pbkN0cmwnLCBmdW5jdGlvbigkc2NvcGUsICR0aW1lb3V0LCBzdEFkbWluU3ZjLCBzdEFkbWluVXNlclN2Yywgc3RBdXRoU3ZjLCBzdFRpY2tlclN2Yykge1xyXG4gICRzY29wZS5lbnYgPSBzdEFkbWluU3ZjLndoYXRFbnYoKTtcclxuICAkc2NvcGUudXNlcnMgPSBzdEFkbWluVXNlclN2Yy5wb3B1bGF0ZVVzZXJzKCk7XHJcbiAgJHNjb3BlLnVzZXJSZXMgPSAkc2NvcGUudXNlcnM7XHJcbiAgJHNjb3BlLnVzZXJGaWVsZCA9ICd1c2VyTmFtZSc7XHJcbiAgJHNjb3BlLnVzZXJSZXZlcnNlID0gZmFsc2U7XHJcbiAgJHNjb3BlLnVzZXJDdXJyZW50UGFnZSA9IDA7XHJcbiAgJHNjb3BlLnVzZXJTaG93T25QYWdlID0gJzEwJztcclxuICAkc2NvcGUudXNlclN5bmNFbmFibGVkID0gJHNjb3BlLmVudiA9PSAnZGV2ZWxvcG1lbnQnID8gdHJ1ZSA6IGZhbHNlO1xyXG4gICRzY29wZS51c2VyU3luY0RpciA9ICd0b2xvYyc7XHJcblxyXG4gICRzY29wZS5maWx0ZXJVc2VycyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgJHNjb3BlLnVzZXJSZXMgPSBbXTtcclxuICAgIHZhciByZXMgPSBzdEFkbWluVXNlclN2Yy5zZWFyY2hVc2Vycygkc2NvcGUudXNlcnMsICRzY29wZS51c2VyU2VhcmNoKTtcclxuICAgICRzY29wZS51c2VyUmVzID0gcmVzO1xyXG4gICAgJHNjb3BlLnVzZXJDdXJyZW50UGFnZSA9IDA7XHJcbiAgfVxyXG5cclxuICAkc2NvcGUuc29ydFVzZXJzID0gZnVuY3Rpb24oZmllbGQsIGludmVydCkge1xyXG4gICAgJHNjb3BlLnVzZXJSZXZlcnNlID0gKCRzY29wZS51c2VyRmllbGQgPT09IGZpZWxkID8gISRzY29wZS51c2VyUmV2ZXJzZSA6IGZhbHNlKTtcclxuICAgIGlmKGludmVydCkgeyAkc2NvcGUudXNlclJldmVyc2UgPSAoJHNjb3BlLnVzZXJGaWVsZCA9PT0gZmllbGQgPyAkc2NvcGUudXNlclJldmVyc2UgOiB0cnVlKTsgfVxyXG4gICAgJHNjb3BlLnVzZXJGaWVsZCA9IGZpZWxkO1xyXG4gIH1cclxuICBcclxuICAkc2NvcGUuY3JlYXRlVXNlciA9IGZ1bmN0aW9uKCkge1xyXG4gICAgdmFyIG5ld1VzZXJEYXRhID0ge1xyXG4gICAgICB1c2VyTmFtZTogJHNjb3BlLmVtYWlsLFxyXG4gICAgICBwYXNzd29yZDogJHNjb3BlLnBhc3N3b3JkLFxyXG4gICAgICBmaXJzdE5hbWU6ICRzY29wZS5maXJzdE5hbWUsXHJcbiAgICAgIGxhc3ROYW1lOiAkc2NvcGUubGFzdE5hbWVcclxuICAgIH07XHJcbiAgICBcclxuICAgIHN0QXV0aFN2Yy5jcmVhdGVVc2VyKG5ld1VzZXJEYXRhKS50aGVuKFxyXG4gICAgICBmdW5jdGlvbigpIHsgc3RUaWNrZXJTdmMubm90aWZ5KCdDcmVhdGVkIHVzZXIgYWNjb3VudCAnICsgbmV3VXNlckRhdGEudXNlck5hbWUgKyAgJy4nKTsgc3RBZG1pblN2Yy5hZG1pblJlZGlyZWN0KCcvYWRtaW4nKTsgfSwgXHJcbiAgICAgIGZ1bmN0aW9uKHJlYXNvbikgeyBzdFRpY2tlclN2Yy5lcnJvcihyZWFzb24pOyB9XHJcbiAgICApO1xyXG4gIH1cclxuICBcclxuICAkc2NvcGUucHVyZ2VVc2VycyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgc3RBZG1pblN2Yy5hZG1pblJlZGlyZWN0KCcvYWRtaW4nKTtcclxuICAgIHN0QWRtaW5TdmMudXBkYXRlUm9vdCgndXNlclB1cmdlSW5Qcm9ncmVzcycsIHRydWUpO1xyXG4gICAgJHRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcbiAgICAgIHN0QXV0aFN2Yy5wdXJnZVVzZXJzKCkudGhlbihcclxuICAgICAgICBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgc3RBZG1pblN2Yy5hZG1pblJlZGlyZWN0KCcvJyk7XHJcbiAgICAgICAgICAgIHN0QXV0aFN2Yy5sb2dvdXRVc2VyKCkudGhlbihcclxuICAgICAgICAgICAgZnVuY3Rpb24oKSB7ICR0aW1lb3V0KCRzY29wZS5wdXJnZURvbmUsIDUwMDApOyB9LFxyXG4gICAgICAgICAgICBmdW5jdGlvbihyZWFzb24pIHsgXHJcbiAgICAgICAgICAgICAgc3RUaWNrZXJTdmMuZXJyb3IocmVhc29uKTtcclxuICAgICAgICAgICAgICBzdEFkbWluU3ZjLnVwZGF0ZVJvb3QoJ3VzZXJQdXJnZUluUHJvZ3Jlc3MnLCBmYWxzZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICk7XHJcbiAgICAgICAgfSwgXHJcbiAgICAgICAgZnVuY3Rpb24ocmVhc29uKSB7IHN0VGlja2VyU3ZjLmVycm9yKHJlYXNvbik7ICR0aW1lb3V0KCRzY29wZS5wdXJnZURvbmUsIDUwMDApOyB9XHJcbiAgICAgICk7XHJcbiAgICB9LCA1MDAwKTtcclxuICB9XHJcbiAgXHJcbiAgJHNjb3BlLnN5bmNEYiA9IGZ1bmN0aW9uKGNvbGxlY3Rpb24sIHN5bmNEaXIpIHtcclxuICAgIGlmKGNvbGxlY3Rpb24gPT0gJ3VzZXJzJykge1xyXG4gICAgICBzdEFkbWluU3ZjLmFkbWluUmVkaXJlY3QoJy9hZG1pbicpO1xyXG4gICAgICBzdEFkbWluU3ZjLnVwZGF0ZVJvb3QoJ3VzZXJTeW5jSW5Qcm9ncmVzcycsIHRydWUpO1xyXG4gICAgICBzdEF1dGhTdmMuc3luY1VzZXJzKHN5bmNEaXIpLnRoZW4oXHJcbiAgICAgICAgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICBpZihzeW5jRGlyID09ICd0b2xvYycpIHtcclxuICAgICAgICAgICAgc3RBZG1pblN2Yy5hZG1pblJlZGlyZWN0KCcvJyk7XHJcbiAgICAgICAgICAgIHN0QXV0aFN2Yy5sb2dvdXRVc2VyKCkudGhlbihcclxuICAgICAgICAgICAgICBmdW5jdGlvbigpIHsgJHRpbWVvdXQoJHNjb3BlLnN5bmNEb25lLCA1MDAwKTsgfSxcclxuICAgICAgICAgICAgICBmdW5jdGlvbihyZWFzb24pIHtcclxuICAgICAgICAgICAgICAgIHN0VGlja2VyU3ZjLmVycm9yKHJlYXNvbik7XHJcbiAgICAgICAgICAgICAgICBzdEFkbWluU3ZjLnVwZGF0ZVJvb3QoJ3VzZXJTeW5jSW5Qcm9ncmVzcycsIHRydWUpO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGVsc2UgeyAkdGltZW91dCgkc2NvcGUuc3luY0RvbmUsIDUwMDApOyB9XHJcbiAgICAgICB9LFxyXG4gICAgICAgIGZ1bmN0aW9uKHJlYXNvbikgeyBzdFRpY2tlclN2Yy5lcnJvcihyZWFzb24pOyAkdGltZW91dCgkc2NvcGUuc3luY0RvbmUsIDUwMDApOyB9XHJcbiAgICAgICk7XHJcbiAgICB9XHJcbiAgfVxyXG4gIFxyXG4gICRzY29wZS5wYWdlVXNlcnMgPSBmdW5jdGlvbigpIHtcclxuICAgIHJldHVybiBNYXRoLmNlaWwoJHNjb3BlLnVzZXJSZXMubGVuZ3RoLyRzY29wZS51c2VyU2hvd09uUGFnZSk7XHJcbiAgfVxyXG4gIFxyXG4gICRzY29wZS5wdXJnZURvbmUgPSBmdW5jdGlvbigpIHtcclxuICAgIHN0VGlja2VyU3ZjLm5vdGlmeSgnVXNlciBkYXRhYmFzZSBoYXMgYmVlbiBwdXJnZWQuJyk7IFxyXG4gICAgc3RBZG1pblN2Yy51cGRhdGVSb290KCd1c2VyUHVyZ2VJblByb2dyZXNzJywgZmFsc2UpO1xyXG4gIH1cclxuICBcclxuICAkc2NvcGUuc3luY0RvbmUgPSBmdW5jdGlvbigpIHtcclxuICAgIHN0VGlja2VyU3ZjLm5vdGlmeSgnVXNlciBkYXRhYmFzZSBoYXMgYmVlbiBzeW5jZWQuJyk7IFxyXG4gICAgc3RBZG1pblN2Yy51cGRhdGVSb290KCd1c2VyU3luY0luUHJvZ3Jlc3MnLCB0cnVlKTtcclxuICB9XHJcbn0pOyIsImFuZ3VsYXIubW9kdWxlKCdzdGFnZScpLmZhY3RvcnkoJ3N0QWRtaW5TdmMnLCBmdW5jdGlvbigkbG9jYXRpb24sICRwYXJzZSwgJHJvb3RTY29wZSwgJHdpbmRvdykge1xyXG4gIHJldHVybiB7XHJcbiAgICBhZG1pblJlZGlyZWN0OiBmdW5jdGlvbihwYXRoKSB7XHJcbiAgICAgICRsb2NhdGlvbi5wYXRoKHBhdGgpO1xyXG4gICAgfSxcclxuICAgIHVwZGF0ZVJvb3Q6IGZ1bmN0aW9uKG9iaiwgdmFsKSB7XHJcbiAgICAgIHZhciByb290T2JqID0gJHBhcnNlKCckcm9vdFNjb3BlLicgKyBvYmopO1xyXG4gICAgICByb290T2JqID0gdmFsO1xyXG4gICAgfSxcclxuICAgIHdoYXRFbnY6IGZ1bmN0aW9uKCkge1xyXG4gICAgICByZXR1cm4gJHdpbmRvdy5lbnY7XHJcbiAgICB9XHJcbiAgfTtcclxufSk7IiwiYW5ndWxhci5tb2R1bGUoJ3N0YWdlJykuZmFjdG9yeSgnc3RBZG1pblVzZXJTdmMnLCBmdW5jdGlvbigkZmlsdGVyLCBzdFVzZXJTdmMpIHtcclxuICByZXR1cm4ge1xyXG4gICAgYWN0aW9uRG9uZTogZnVuY3Rpb24oYWN0KSB7XHJcbiAgICAgIHN3aXRjaChhY3QpIHtcclxuICAgICAgICBjYXNlICdwdXJnZSc6XHJcbiAgICAgICAgICB2YXIgYWN0VmVyYiA9ICdwdXJnZWQnXHJcbiAgICAgICAgICAkcm9vdFNjb3BlLnVzZXJQdXJnZUluUHJvZ3Jlc3MgPSBmYWxzZTtcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgJ3N5bmMnOlxyXG4gICAgICAgICAgdmFyIGFjdFZlcmIgPSAnc3luY2VkJ1xyXG4gICAgICAgICAgJHJvb3RTY29wZS51c2VyU3luY0luUHJvZ3Jlc3MgPSBmYWxzZTtcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcbiAgICAgIGlmKGFjdFZlcmIpIHtzdFRpY2tlclN2Yy5ub3RpZnkoJ1VzZXIgZGF0YWJhc2UgaGFzIGJlZW4gJyArIGFjdFZlcmIgKyAnLicpOyB9XHJcbiAgICB9LFxyXG4gICAgcG9wdWxhdGVVc2VyczogZnVuY3Rpb24oKSB7XHJcbiAgICAgIHJldHVybiBzdFVzZXJTdmMucXVlcnkoKTtcclxuICAgIH0sXHJcbiAgICBzZWFyY2hVc2VyczogZnVuY3Rpb24odXNlcnMsIHF1ZXJ5KSB7XHJcbiAgICAgIHJldHVybiAkZmlsdGVyKCd1c2VyZmluZCcpKHVzZXJzLCBxdWVyeSk7XHJcbiAgICB9XHJcbiAgfTtcclxufSk7IiwiYW5ndWxhci5tb2R1bGUoJ3N0YWdlJykuZmFjdG9yeSgnc3REZXZEYkF6dXJlU3ZjJywgZnVuY3Rpb24oKSB7XHJcbiAgcmV0dXJuIHtcclxuICAgICAgdmlldzogJ2F6dXJlU3RyZWFtJyxcclxuICAgICAgdmlld1R5cGU6ICd2aWV3JyxcclxuICAgICAgc3RhdHVzOiBmYWxzZSxcclxuICAgICAgc3RyZWFtV2VsbDogJycsXHJcbiAgICAgIGVuZFBvaW50OiAnL2FwaS9kZXZkYXNoL2F6dXJlU3RyZWFtLycsXHJcbiAgICAgIGhlYXJ0QmVhdDogbnVsbFxyXG4gIH07XHJcbn0pOyIsImFuZ3VsYXIubW9kdWxlKCdzdGFnZScpLmNvbnRyb2xsZXIoJ3N0RGV2RGJDdHJsJywgZnVuY3Rpb24oJHNjb3BlLCAkaHR0cCwgJGludGVydmFsLCAkdGltZW91dCwgc3REZXZEYlN2Yykge1xyXG4gICRzY29wZS5jdXJyZW50U3ZjID0ge1xyXG4gICAgdmlldzogbnVsbCxcclxuICAgIHR5cGU6IG51bGwsXHJcbiAgICBzdHJlYW1XZWxsOiAnJyBcclxuICB9XHJcblxyXG4gICRzY29wZS5zdmNTdGF0dXMgPSB7XHJcbiAgICBoZWFydEJlYXQ6ICRpbnRlcnZhbChmdW5jdGlvbigpIHtcclxuICAgICAgdmFyIHN2Y3MgPSBbJ2Rldk1vbmdvJywgJ2Nsb3VkTW9uZ28nLCAnYXp1cmVTdHJlYW0nXTtcclxuICAgICAgc3Zjcy5mb3JFYWNoKGZ1bmN0aW9uKHN2Yykge1xyXG4gICAgICAgIGlmKCRzY29wZS5zdmNTdGF0dXNbc3ZjXSAhPT0gJ2Vycm9yJykge1xyXG4gICAgICAgICAgc3REZXZEYlN2Yy5jaGVja1N0YXR1cyhzdmMpLnRoZW4oXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uKHN0YXQpIHtcclxuICAgICAgICAgICAgICBpZihzdGF0LmNvZGUpIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS5zdmNTdGF0dXNbc3ZjXSA9ICdlcnJvcic7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnQSBmYXRhbCBjb25uZWN0aW9uIGVycm9yIHRvICcgKyBzdmMgKyAnIGhhcyBkaXNydXB0ZWQgaGVhcnRiZWF0IHNlcnZpY2VzJyk7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIGVsc2UgJHNjb3BlLnN2Y1N0YXR1c1tzdmNdID0gc3RhdDtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgZnVuY3Rpb24oZXJyb3IpIHsgY29uc29sZS5sb2coZXJyb3IpOyB9XHJcbiAgICAgICAgICApO1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICB9LCA1MDApXHJcbiAgfVxyXG5cclxuICAkc2NvcGUuY2hhbmdlVmlldyA9IGZ1bmN0aW9uKHN2Yykge1xyXG4gICAgaWYoc3ZjID09ICdvdmVydmlldycpIHtcclxuICAgICAgJHNjb3BlLmN1cnJlbnRTdmMudmlldyA9IG51bGw7XHJcbiAgICAgICRzY29wZS5jdXJyZW50U3ZjLnR5cGUgPSBudWxsO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICRzY29wZS5jdXJyZW50U3ZjLnZpZXcgPSBzdmM7XHJcbiAgICAgICRzY29wZS5jdXJyZW50U3ZjLnR5cGUgPSBzdERldkRiU3ZjLmdldENvbnNvbGVUeXBlKHN2Yyk7XHJcbiAgICAgICRzY29wZS5jdXJyZW50U3ZjLnN0cmVhbVdlbGwgPSAnQ29ubmVjdGluZy4uLic7XHJcbiAgICAgIGlmKCEkc2NvcGUuc3ZjU3RhdHVzW3N2Y10pIHN0RGV2RGJTdmMuY29ubmVjdFNlcnZpY2Uoc3ZjKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gICRzY29wZS5kZGJDb21tYW5kID0gZnVuY3Rpb24oKSB7XHJcbiAgICB2YXIgc3ZjID0gJHNjb3BlLmN1cnJlbnRTdmMudmlldztcclxuICAgIGNvbnNvbGUubG9nKHN2Yyk7XHJcbiAgICBpZigkc2NvcGUuY3VycmVudFN2Yy50eXBlICE9PSAnY21kJykgcmV0dXJuIGZhbHNlO1xyXG4gICAgZWxzZSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKCdUeXBlIGlzIGNtZCcpO1xyXG4gICAgICBjb25zb2xlLmxvZygkc2NvcGUuZGRiQ21kQmFyKTtcclxuICAgICAgY29uc29sZS5sb2coJHNjb3BlLmNoZWNrU3RhdHVzKHN2YykpO1xyXG4gICAgICB2YXIgc3ZjU3RhdCA9IGZhbHNlXHJcbiAgICAgIHN3aXRjaChzdmMpIHtcclxuICAgICAgICBjYXNlICdsb2NhbE1vbmdvJzpcclxuICAgICAgICAgIHN2Y1N0YXQgPSAkc2NvcGUubG9jYWxNb25nb1N0YXR1cztcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgJ3JlbW90ZU1vbmdvJzpcclxuICAgICAgICAgIHN2Y1N0YXQgPSAkc2NvcGUucmVtb3RlTW9uZ29TdGF0dXM7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgfVxyXG4gICAgICBpZihzdmNTdGF0ICYmICRzY29wZS5kZGJDbWRCYXIpIHtcclxuICAgICAgICAkaHR0cC5wb3N0KCcvYXBpL2RldmRhc2gvJyArIHN2YyArICcvY29tbWFuZCcsIHtjbWQ6ICRzY29wZS5kZGJDbWRCYXJ9KS50aGVuKGZ1bmN0aW9uKHJlcykge1xyXG4gICAgICAgICAgJHNjb3BlLmRkYkNtZEJhciA9ICcnO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2UgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gJHNjb3BlLmRkYkNvbm5lY3QgPSBmdW5jdGlvbihzdmMpIHtcclxuICAvLyAgICRodHRwLmdldCgnL2FwaS9kZXZkYXNoLycgKyBzdmMgKyAnL2Nvbm5lY3QnLCB7Y2hlY2s6IHRydWV9KS50aGVuKGZ1bmN0aW9uKCkge1xyXG4gIC8vICAgICBpZihzdmMgPT0gJ2xvY2FsTW9uZ28nKSB7XHJcbiAgLy8gICAgICAgJHNjb3BlLmN1cnJlbnRTdmMuc3RyZWFtV2VsbCArPSAnZG9uZSFcXG4nO1xyXG4gIC8vICAgICAgICRzY29wZS5sb2NhbE1vbmdvU3RhdHVzID0gdHJ1ZTtcclxuICAvLyAgICAgICAkdGltZW91dChmdW5jdGlvbigpIHskc2NvcGUuZGRiU3RyZWFtKHN2Yyk7fSwgNTAwKTtcclxuICAvLyAgICAgfVxyXG4gIC8vICAgICBlbHNlIGlmKHN2YyA9PSAncmVtb3RlTW9uZ28nKSB7XHJcbiAgLy8gICAgICAgJHNjb3BlLmN1cnJlbnRTdmMuc3RyZWFtV2VsbCArPSAnZG9uZSFcXG4nO1xyXG4gIC8vICAgICAgICRzY29wZS5yZW1vdGVNb25nb1N0YXR1cyA9IHRydWU7XHJcbiAgLy8gICAgICAgJHRpbWVvdXQoZnVuY3Rpb24oKSB7JHNjb3BlLmRkYlN0cmVhbShzdmMpO30sIDUwMCk7XHJcbiAgLy8gICAgIH1cclxuICAvLyAgICAgZWxzZSBpZihzdmMgPT0gJ2F6dXJlU3RyZWFtJykge1xyXG4gIC8vICAgICAgICRzY29wZS5jdXJyZW50U3ZjLnN0cmVhbVdlbGwgKz0gJ2RvbmUhXFxuJztcclxuICAvLyAgICAgICAkc2NvcGUuYXp1cmVTdHJlYW1TdGF0dXMgPSB0cnVlO1xyXG4gIC8vICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uKCkgeyRzY29wZS5kZGJTdHJlYW0oc3ZjKTt9LCA1MDApO1xyXG4gIC8vICAgICB9XHJcbiAgLy8gICB9KTtcclxuICAvLyB9XHJcblxyXG4gICRzY29wZS5kZGJEaXNjb25uZWN0ID0gZnVuY3Rpb24oc3ZjKSB7XHJcbiAgICAvLyAkaHR0cC5nZXQoJy9hcGkvZGV2ZGFzaC8nICsgc3ZjICsgJy9kaXNjb25uZWN0Jywge2NoZWNrOiB0cnVlfSkudGhlbihmdW5jdGlvbigpIHtcclxuICAgICAgaWYoc3ZjID09ICdsb2NhbE1vbmdvJykgJHNjb3BlLmxvY2FsTW9uZ29TdGF0dXMgPSBmYWxzZTtcclxuICAgICAgZWxzZSBpZihzdmMgPT0gJ3JlbW90ZU1vbmdvJykgJHNjb3BlLnJlbW90ZU1vbmdvU3RhdHVzID0gZmFsc2U7XHJcbiAgICAgIGVsc2UgaWYoc3ZjID09ICdhenVyZVN0cmVhbScpICRzY29wZS5henVyZVN0cmVhbVN0YXR1cyA9IGZhbHNlO1xyXG4gICAgLy8gfSk7XHJcbiAgfVxyXG5cclxuICAkc2NvcGUuY2hlY2tTdGF0dXMgPSBmdW5jdGlvbihzdmMpIHsgcmV0dXJuIHN0RGV2RGJTdmMuY2hlY2tTdGF0dXMoc3ZjKTsgfVxyXG5cclxuICAkc2NvcGUuZGRiU3RyZWFtID0gZnVuY3Rpb24oc3ZjKSB7XHJcbiAgICBpZih0eXBlb2YoRXZlbnRTb3VyY2UpICE9PSAndW5kZWZpbmVkJykge1xyXG4gICAgICB2YXIgc3RybVNvdXJjZSA9IG5ldyBFdmVudFNvdXJjZSgnL2FwaS9kZXZkYXNoLycgKyBzdmMgKyAnL3N0cmVhbScpO1xyXG4gICAgICBzdHJtU291cmNlLmFkZEV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCBmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgICRzY29wZS4kYXBwbHkoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICB2YXIgbXNnID0gSlNPTi5wYXJzZShldmVudC5kYXRhKTtcclxuICAgICAgICAgIC8vIFJlcGxhY2Ugc3BlY2lhbCBjaGFyYWN0ZXJzXHJcbiAgICAgICAgICBtc2cgPSBtc2cucmVwbGFjZSgvXFxbMG0vZywgJycpO1xyXG4gICAgICAgICAgbXNnID0gbXNnLnJlcGxhY2UoL1xcWzM2bS9nLCAnJyk7XHJcbiAgICAgICAgICAvLyBTdHJpcCBvdXQgVW5pY29kZSBjaGFyYWN0ZXJzIFxyXG4gICAgICAgICAgbXNnID0gdW5lc2NhcGUoZW5jb2RlVVJJQ29tcG9uZW50KG1zZykpO1xyXG4gICAgICAgICAgY29uc29sZS5sb2cobXNnKTtcclxuICAgICAgICAgICRzY29wZS5jdXJyZW50U3ZjLnN0cmVhbVdlbGwgKz0gbXNnLnRyaW0oKSArICdcXG4nO1xyXG4gICAgICAgICAgJHRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciBzdyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzdHJlYW1XZWxsJyk7XHJcbiAgICAgICAgICAgIHN3LnNjcm9sbFRvcCA9IHN3LnNjcm9sbEhlaWdodDtcclxuICAgICAgICAgIH0sIDUwKTtcclxuICAgICAgICB9KTtcclxuICAgICAgfSwgZmFsc2UpO1xyXG4gICAgICBzdHJtU291cmNlLmFkZEV2ZW50TGlzdGVuZXIoJ2Vycm9yJywgZnVuY3Rpb24oZXJyKSB7XHJcbiAgICAgICAgJHNjb3BlLiRhcHBseShmdW5jdGlvbigpIHtcclxuICAgICAgICAgICRzY29wZS5kZGJEaXNjb25uZWN0KHN2Yyk7XHJcbiAgICAgICAgICAkc2NvcGUuY3VycmVudFN2Yy5zdHJlYW1XZWxsICs9ICdUaGUgc3RyZWFtIGZvciAnICsgc3ZjICsgJyBoYXMgYmVlbiB1bmV4cGVjdGVkbHkgY2xvc2VkLlxcbic7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgc3RybVNvdXJjZS5jbG9zZSgpO1xyXG4gICAgICB9LCBmYWxzZSk7XHJcbiAgICB9XHJcbiAgICBlbHNlICRzY29wZS5jdXJyZW50U3ZjLnN0cmVhbVdlbGwgPSAnVGhpcyBicm93c2VyIGRvZXMgbm90IHN1cHBvcnQgc3RyZWFtaW5nLlxcbic7XHJcbiAgfVxyXG59KTsiLCJhbmd1bGFyLm1vZHVsZSgnc3RhZ2UnKS5mYWN0b3J5KCdzdERldkRiTW9uZ29TdmMnLCBmdW5jdGlvbigpIHtcclxuICByZXR1cm4ge1xyXG4gICAgY2xvdWQ6IHtcclxuICAgICAgdmlldzogJ2Nsb3VkTW9uZ28nLFxyXG4gICAgICBzdGF0dXM6IGZhbHNlLFxyXG4gICAgICBzdHJlYW1XZWxsOiAnJyxcclxuICAgICAgZW5kUG9pbnQ6ICcvYXBpL2RldmRhc2gvcmVtb3RlTW9uZ28vJyxcclxuICAgICAgdmlld1R5cGU6ICdjbWQnXHJcbiAgICB9LFxyXG4gICAgZGV2OiB7XHJcbiAgICAgIHZpZXc6ICdkZXZNb25nbycsXHJcbiAgICAgIHN0YXR1czogZmFsc2UsXHJcbiAgICAgIHN0cmVhbVdlbGw6ICcnLFxyXG4gICAgICBlbmRQb2ludDogJy9hcGkvZGV2ZGFzaC9sb2NhbE1vbmdvLycsXHJcbiAgICAgIHZpZXdUeXBlOiAnY21kJ1xyXG4gICAgfSxcclxuICB9O1xyXG59KTsiLCJhbmd1bGFyLm1vZHVsZSgnc3RhZ2UnKS5mYWN0b3J5KCdzdERldkRiU3ZjJywgZnVuY3Rpb24oJGh0dHAsICRpbnRlcnZhbCwgJHEsIHN0RGV2RGJBenVyZVN2Yywgc3REZXZEYk1vbmdvU3ZjKSB7XHJcbiAgcmV0dXJuIHtcclxuICAgIGN1cnJlbnRTdmM6IG51bGwsXHJcbiAgICBzdmNMaXN0OiB7IFxyXG4gICAgICBjbG91ZE1vbmdvOiBzdERldkRiTW9uZ29TdmMuY2xvdWQsXHJcbiAgICAgIGRldk1vbmdvOiBzdERldkRiTW9uZ29TdmMuZGV2LFxyXG4gICAgICBhenVyZVN0cmVhbTogc3REZXZEYkF6dXJlU3ZjXHJcbiAgICB9LFxyXG5cclxuICAgIHNlbmRSZXF1ZXN0OiBmdW5jdGlvbihtZXRob2QsIHVybCwgc3VjY2Vzc0NhbGxiYWNrLCBlcnJvckNhbGxiYWNrLCBzdmMsIGRhdGEpIHtcclxuICAgICAgc3ZjID0gc3ZjID8gdGhpcy5zdmNMaXN0W3N2Y10gOiBmYWxzZVxyXG4gICAgICBkYXRhID0gZGF0YSA/IGRhdGEgOiB7fVxyXG4gICAgICByZXR1cm4gJGh0dHAoe1xyXG4gICAgICAgIG1ldGhvZDogbWV0aG9kLFxyXG4gICAgICAgIHVybDogKHN2YyA/IHN2Yy5lbmRQb2ludCA6IGN1cnJlbnRTdmMuZW5kUG9pbnQpICsgdXJsLFxyXG4gICAgICAgIGRhdGE6IGRhdGFcclxuICAgICAgfSkudGhlbihzdWNjZXNzQ2FsbGJhY2ssIGVycm9yQ2FsbGJhY2spO1xyXG4gICAgfSxcclxuXHJcbiAgICBjaGVja1N0YXR1czogZnVuY3Rpb24oc3ZjKSB7XHJcbiAgICAgIGlmKCFzdmMgJiYgdGhpcy5jdXJyZW50U3ZjID09IG51bGwpIHJldHVybiBmYWxzZTtcclxuICAgICAgcmV0dXJuIHRoaXMuc2VuZFJlcXVlc3QoJ0dFVCcsICdzdGF0dXMnLCBcclxuICAgICAgICAvLyBTdWNjZXNzIGNhbGxiYWNrXHJcbiAgICAgICAgZnVuY3Rpb24ocmVzcG9uc2UpIHtcclxuICAgICAgICAgIGlmKHJlc3BvbnNlLmRhdGEucmVzcG9uc2UgPT0gJ0Nvbm5lY3RlZCcgJiYgcmVzcG9uc2Uuc3RhdHVzID09IDIwMCkgeyByZXR1cm4gdHJ1ZTsgfVxyXG4gICAgICAgICAgZWxzZSBpZihyZXNwb25zZS5zdGF0dXMgIT09IDIwMCkgcmV0dXJuIHsgZXJyb3I6IHJlc3BvbnNlLnN0YXR1cyB9O1xyXG4gICAgICAgICAgZWxzZSB7IHJldHVybiBmYWxzZTsgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgLy8gRXJyb3IgY2FsbGJhY2tcclxuICAgICAgICBmdW5jdGlvbihyZXNwb25zZSkgeyByZXR1cm4geyBlcnJvcjogcmVzcG9uc2Uuc3RhdHVzIH07IH0sXHJcbiAgICAgICAgLy8gUGFzcyBzcGVjaWZpYyBzZXJ2aWNlIGlmIG5lZWRlZFxyXG4gICAgICAgIChzdmMgPyBzdmMgOiBmYWxzZSlcclxuICAgICAgKS50aGVuKFxyXG4gICAgICAgIC8vIFN1Y2Nlc3MgY2FsbGJhY2tcclxuICAgICAgICBmdW5jdGlvbihyZXNwb25zZSkge1xyXG4gICAgICAgICAgaWYoIXJlc3BvbnNlWydlcnJvciddKSB7XHJcbiAgICAgICAgICAgIGlmKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgICAgaWYoIXN2YykgdGhpcy5jdXJyZW50U3ZjLnN0YXR1cyA9IHRydWU7XHJcbiAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgaWYoIXN2YykgdGhpcy5jdXJyZW50U3ZjLnN0YXR1cyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGlmKCFzdmMpIHRoaXMuY3VycmVudFN2Yy5zdGF0dXMgPSBmYWxzZTtcclxuICAgICAgICAgICAgcmV0dXJuIHsgY29kZTogcmVzcG9uc2UuZXJyb3IsIG1zZzogJ0ZhaWxlZCB0byBjb25uZWN0IHRvIHNlcnZpY2U6IFVuZXhwZWN0ZWQgcmVzcG9uc2UnIH07XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICAvLyBFcnJvciBjYWxsYmFja1xyXG4gICAgICAgIGZ1bmN0aW9uKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgICBpZighc3ZjKSB0aGlzLmN1cnJlbnRTdmMuc3RhdHVzID0gZmFsc2U7XHJcbiAgICAgICAgICByZXR1cm4geyBjb2RlOiByZXNwb25zZS5lcnJvciwgbXNnOiAnRmFpbGVkIHRvIGNvbm5lY3QgdG8gc2VydmljZTogVW5leHBlY3RlZCByZXNwb25zZScgfTtcclxuICAgICAgICB9XHJcbiAgICAgICk7XHJcbiAgICB9LFxyXG5cclxuICAgIGNvbm5lY3RTZXJ2aWNlOiBmdW5jdGlvbihzdmMpIHtcclxuICAgICAgdGhpcy5jdXJyZW50U3ZjID0gdGhpcy5zdmNMaXN0W3N2Y107XHJcbiAgICAgIHZhciByZXNwb25zZSA9IHRoaXMuc2VuZFJlcXVlc3QoJ0dFVCcsICdjb25uZWN0JyxcclxuICAgICAgICAvLyBTdWNjZXNzIGNhbGxiYWNrXHJcbiAgICAgICAgZnVuY3Rpb24ocmVzcG9uc2UpIHtcclxuICAgICAgICAgIGlmKHJlc3BvbnNlLmRhdGEucmVzcG9uc2UgPT0gJ0Nvbm5lY3RlZCcgJiYgcmVzcG9uc2Uuc3RhdHVzID09IDIwMCkgeyByZXR1cm4gdHJ1ZTsgfVxyXG4gICAgICAgICAgZWxzZSB7IHJldHVybiBmYWxzZTsgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgLy8gRXJyb3IgY2FsbGJhY2tcclxuICAgICAgICBmdW5jdGlvbihyZXNwb25zZSkgeyByZXR1cm4ge2Vycm9yOiByZXNwb25zZS5zdGF0dXN9OyB9LFxyXG4gICAgICAgIC8vIFBhc3Mgc2VydmljZVxyXG4gICAgICAgIHN2Y1xyXG4gICAgICApO1xyXG5cclxuICAgICAgaWYoIXJlc3BvbnNlWydlcnJvciddKSB7IHRoaXMuY3VycmVudFN2Yy5zdGF0dXMgPSB0cnVlOyB9XHJcbiAgICAgIGVsc2Uge1xyXG4gICAgICAgIHRoaXMuY3VycmVudFN2Yy5zdGF0dXMgPSBmYWxzZTtcclxuICAgICAgICB0aHJvdyB7IGNvZGU6IHJlc3BvbnNlLnN0YXR1cywgbXNnOiAnRmFpbGVkIHRvIGNvbm5lY3QgdG8gc2VydmljZTogVW5leHBlY3RlZCByZXNwb25zZScgfTtcclxuICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICBnZXRDb25zb2xlVHlwZTogZnVuY3Rpb24oc3ZjKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLnN2Y0xpc3Rbc3ZjXS52aWV3VHlwZTtcclxuICAgIH0sXHJcblxyXG4gICAgdXBkYXRlU3RyZWFtV2VsbDogZnVuY3Rpb24obXNnKSB7XHJcblxyXG4gICAgfVxyXG4gIH07XHJcbn0pO1xyXG5cclxuXHJcblxyXG4iLCJhbmd1bGFyLm1vZHVsZSgnc3RhZ2UnKS5maWx0ZXIoJ3VzZXJTdGFydFBhZ2UnLCBmdW5jdGlvbigpIHtcclxuICAgIHJldHVybiBmdW5jdGlvbihpbnB1dCwgc3RhcnQpIHtcclxuICAgICAgICBzdGFydCA9ICtzdGFydDtcclxuICAgICAgICByZXR1cm4gaW5wdXQuc2xpY2Uoc3RhcnQpO1xyXG4gICAgfVxyXG59KTsiLCJhbmd1bGFyLm1vZHVsZSgnc3RhZ2UnKS5maWx0ZXIoJ3VzZXJmaW5kJywgZnVuY3Rpb24oKSB7XHJcbiAgcmV0dXJuIGZ1bmN0aW9uKHVzZXJzLCBxKSB7XHJcbiAgICB2YXIgbWF0Y2hlZCA9IFtdO1xyXG4gICAgYW5ndWxhci5mb3JFYWNoKHVzZXJzLCBmdW5jdGlvbih1KSB7XHJcbiAgICAgIHRyeSB7IHZhciBleHAgPSBuZXcgUmVnRXhwKHEsICdnaScpOyB9IGNhdGNoKGUpIHsgcmV0dXJuIFtdOyB9XHJcbiAgICAgIGlmKHUudXNlck5hbWUubWF0Y2goZXhwKSB8fCB1LmZpcnN0TmFtZS5tYXRjaChleHApIHx8IHUubGFzdE5hbWUubWF0Y2goZXhwKSB8fCBxID09ICcnKSB7XHJcbiAgICAgICAgbWF0Y2hlZC5wdXNoKHtcclxuICAgICAgICAgIF9pZDogdS5faWQsIFxyXG4gICAgICAgICAgdXNlck5hbWU6IHUudXNlck5hbWUsIFxyXG4gICAgICAgICAgZmlyc3ROYW1lOiB1LmZpcnN0TmFtZSwgXHJcbiAgICAgICAgICBsYXN0TmFtZTogdS5sYXN0TmFtZSxcclxuICAgICAgICAgIHJvbGVzOiB1LnJvbGVzXHJcbiAgICAgICAgfSlcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gbWF0Y2hlZDtcclxuICB9XHJcbn0pOyIsImFuZ3VsYXIubW9kdWxlKCdzdGFnZScpLmNvbnRyb2xsZXIoJ3N0VGlja2VyQ3RybCcsIFsnJHNjb3BlJywgJ3N0VGlja2VyU3ZjJywgZnVuY3Rpb24oJHNjb3BlLCBzdFRpY2tlclN2Yykge1xyXG4gICRzY29wZS5jdXN0b20gPSBzdFRpY2tlclN2Yy5jdXN0b20oKTtcclxuICAkc2NvcGUucmVzZXQgPSBzdFRpY2tlclN2Yy5yZXNldCgpO1xyXG4gICRzY29wZS5zaG93QWxsID0gZnVuY3Rpb24oKSB7ICQoJy50aWNrZXItY29udGFpbmVyJykudG9nZ2xlQ2xhc3MoJ2V4cGFuZGVkJyk7IH1cclxufV0pOyIsImFuZ3VsYXIubW9kdWxlKCdzdGFnZScpLmZhY3RvcnkoJ3N0VGlja2VyU3ZjJywgZnVuY3Rpb24oKSB7XHJcbiAgdmFyIGZ0ciA9ICcvL3RhcmRpZ3JhZGUvbm9kZSB8IFRhcmRpZ3JhZGUgRGlnaXRhbCAmY29weTsgMjAxNic7XHJcbiAgdmFyIHRvc2V0ID0gZmFsc2U7XHJcbiAgdmFyIHRvID0gbnVsbDtcclxuICBcclxuICBmdW5jdGlvbiBhZGRUaWNrZXIobXNnLCBsdmwsIGljKSB7XHJcbiAgICBtc2cgPSBsdmwgPyAoJyAnICsgbXNnKSA6IG1zZztcclxuICAgIHZhciBtc2dvYmogPSAkKCc8c3Bhbj48L3NwYW4+JykuYWRkQ2xhc3MoJ3RpY2tlci1tc2cnKS5odG1sKG1zZyk7XHJcbiAgICBpZihpYykgeyBcclxuICAgICAgaWMgPSAkKCc8c3Bhbj48L3NwYW4+JykuYWRkQ2xhc3MoJ2ljb25pYyBpY29uaWMtc20gJyArIGljKTsgXHJcbiAgICAgIG1zZ29iai5wcmVwZW5kKGljKTsgXHJcbiAgICB9XHJcbiAgICBpZihsdmwpIHsgbXNnb2JqLmFkZENsYXNzKGx2bCk7IH1cclxuICAgICQoJyN0aWNrZXInKS5hZGRDbGFzcygnb24nKS5wcmVwZW5kKG1zZ29iaik7XHJcbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkgeyQoJyN0aWNrZXInKS5yZW1vdmVDbGFzcygnb24nKTt9LCAzMDApO1xyXG4gICAgaWYoIXRvc2V0KSB7IHRvc2V0ID0gdHJ1ZTsgdG8gPSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkgeyByZXNldFRpY2tlcigpOyB0b3NldCA9IGZhbHNlOyB9LCA4MDAwKTsgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgIGNsZWFyVGltZW91dCh0byk7XHJcbiAgICAgIHRvID0gc2V0VGltZW91dChmdW5jdGlvbigpIHsgcmVzZXRUaWNrZXIoKTsgdG9zZXQgPSBmYWxzZTsgfSwgODAwMCk7XHJcbiAgICB9XHJcbiAgfVxyXG4gIFxyXG4gIGZ1bmN0aW9uIHJlc2V0VGlja2VyKCkge1xyXG4gICAgJCgnI3RpY2tlciAjZnRybXNnJykucmVtb3ZlKCk7XHJcbiAgICB2YXIgbXNnb2JqID0gJCgnPHNwYW4+PC9zcGFuPicpLmh0bWwoZnRyKS5hdHRyKCdpZCcsICdmdHJtc2cnKTtcclxuICAgICQoJyN0aWNrZXInKS5hZGRDbGFzcygnb24nKS5wcmVwZW5kKG1zZ29iaik7XHJcbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkgeyQoJyN0aWNrZXInKS5yZW1vdmVDbGFzcygnb24nKTt9LCAzMDApO1xyXG4gIH1cclxuICBcclxuICByZXR1cm4ge1xyXG4gICAgY3VzdG9tOiBmdW5jdGlvbihtc2csIGx2bCwgaWMpIHsgaWYoIW1zZykgeyByZXR1cm4gZmFsc2U7IH07IGFkZFRpY2tlcihtc2csIGx2bCwgKCdpY29uaWMtJyArIGljKSk7IH0sXHJcbiAgICBub3RpZnk6IGZ1bmN0aW9uKG1zZykgeyBpZighbXNnKSB7IHJldHVybiBmYWxzZTsgfTsgYWRkVGlja2VyKG1zZywgJ3N1Y2Nlc3MnLCAnaWNvbmljLWNpcmNsZS1jaGVjaycpOyB9LFxyXG4gICAgZXJyb3I6IGZ1bmN0aW9uKG1zZykgeyBpZighbXNnKSB7IHJldHVybiBmYWxzZTsgfTsgYWRkVGlja2VyKG1zZywgJ2Vycm9yJywgJ2ljb25pYy1jaXJjbGUteCcpOyB9LFxyXG4gICAgaW5mbzogZnVuY3Rpb24obXNnKSB7IGlmKCFtc2cpIHsgcmV0dXJuIGZhbHNlOyB9OyBhZGRUaWNrZXIobXNnLCBudWxsLCAnaWNvbmljLWluZm8nKTsgfSxcclxuICAgIHJlc2V0OiBmdW5jdGlvbigpIHsgcmVzZXRUaWNrZXIoKTsgfVxyXG4gIH1cclxufSk7IiwiYW5ndWxhci5tb2R1bGUoJ3N0YWdlJykuY29udHJvbGxlcignc3RNYWluQ3RybCcsIGZ1bmN0aW9uKCRzY29wZSkge1xyXG5cclxufSk7Il0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
