angular.module("stage",["ngResource","ngRoute","ui.gravatar","ngAnimate"]),angular.module("stage").config(["$routeProvider","$locationProvider",function(e,t){var r={admin:{auth:["stAuthSvc",function(e){return e.authorizeCurrentUserForRoute("admin")}]},user:{auth:["stAuthSvc",function(e){return e.authorizeAuthenticatedUserForRoute()}]},guest:{auth:["stAuthSvc",function(e){return e.unauthenticatedUser()}]}};t.html5Mode(!0),e.when("/",{templateUrl:"/partials/main/main",controller:"stMainCtrl"}).when("/admin",{templateUrl:"/partials/admin/views/admin",controller:"stAdminCtrl",resolve:r.admin}).when("/admin/ddb",{templateUrl:"/partials/admin/views/dev-dashboard",controller:"stDevDbCtrl",resolve:r.admin}).when("/admin/users/add",{templateUrl:"/partials/admin/views/add-user",controller:"stAdminCtrl",resolve:r.admin}).when("/admin/users/delete",{templateUrl:"/partials/admin/views/delete-user",controller:"stAdminCtrl",resolve:r.admin}).when("/admin/users/purge",{templateUrl:"/partials/admin/views/purge-users",controller:"stAdminCtrl",resolve:r.admin}).when("/admin/users/sync",{templateUrl:"/partials/admin/views/sync-users",controller:"stAdminCtrl",resolve:r.admin}).when("/login",{templateUrl:"/partials/account/views/login",controller:"stLoginCtrl",resolve:r.guest}).when("/signup",{templateUrl:"/partials/account/views/signup",controller:"stSignupCtrl",resolve:r.guest}).when("/settings",{templateUrl:"/partials/account/views/settings",controller:"stProfileCtrl",resolve:r.user}).otherwise({redirectTo:"/"})}]),angular.module("stage").run(["$rootScope","$location",function(e,t){e.$on("$routeChangeError",function(e,r,n,s){"not authorized"===s&&t.path("/")})}]),angular.module("stage").factory("stAuthSvc",["$http","$q","stIdentitySvc","stUserSvc",function(e,t,r,n){return{authenticateUser:function(s,o){var a=t.defer();return e.post("/login",{username:s,password:o}).then(function(e){if(e.data.success){var t=new n;delete e.data.user.hashed_pwd,delete e.data.user.salt,angular.extend(t,e.data.user),r.currentUser=t,a.resolve(!0)}else a.resolve(!1)}),a.promise},createUser:function(e){var r=new n(e),s=t.defer();return r.$save().then(function(){s.resolve()},function(e){s.reject(e.data.reason)}),s.promise},logoutUser:function(){var n=t.defer();return e.post("/logout",{logout:!0}).then(function(){r.currentUser=void 0,n.resolve()}),n.promise},purgeUsers:function(){var r=t.defer();return e({method:"PURGE",url:"/api/users"}).then(function(){console.log("User database has been purged"),r.resolve()}),r.promise},syncUsers:function(r){var n=t.defer();return e({method:"COPY",url:"/api/db",headers:{"Content-Type":"application/json"},data:{collection:"users",direction:r}}).then(function(){console.log("User database has been synced"),n.resolve()}),n.promise},updateCurrentUser:function(e){var n=t.defer(),s=angular.copy(r.currentUser);return angular.extend(s,e),s.$update().then(function(){r.currentUser=s,n.resolve()},function(e){n.reject(e.data.reason)}),n.promise},authorizeAuthenticatedUserForRoute:function(){return r.isAuthenticated()?!0:t.reject("not authorized")},authorizeCurrentUserForRoute:function(e){return r.isAuthorized(e)?!0:t.reject("not authorized")},unauthenticatedUser:function(){return r.isAuthenticated()?t.reject("user signed in"):!0}}}]),angular.module("stage").factory("stIdentitySvc",["$window","stUserSvc",function(e,t){var r;return e.stageUser&&(r=new t,delete e.stageUser.hashed_pwd,delete e.stageUser.salt,angular.extend(r,e.stageUser)),{currentUser:r,isAuthenticated:function(){return!!this.currentUser},isAuthorized:function(e){return!!this.currentUser&&this.currentUser.roles.indexOf(e)>-1}}}]),angular.module("stage").controller("stLoginCtrl",["$scope","$location","stAuthSvc","stIdentitySvc","stTickerSvc",function(e,t,r,n,s){e.identity=n,e.signin=function(o,a){return!o||!a||o.$invalid||a.$invalid?(o&&!o.$invalid||$(loginWidget.username).addClass("invalid"),a&&!a.$invalid||$(loginWidget.password).addClass("invalid"),s.error("Please enter a valid email address and password."),!1):void r.authenticateUser(o,a).then(function(r){if(r){o="",a="",e.username="",e.password="";var u=n.isAuthorized("admin")?"/admin":"/";s.notify("You have been successfully authenticated."),t.path("login")&&t.path(u),n.isAuthorized("admin")&&t.path(u)}else s.error("Invalid email address or password was given.")})},e.signout=function(){r.logoutUser().then(function(){e.username="",e.password="",s.notify("You have been signed out."),t.path("/")})}}]),angular.module("stage").directive("stLoginWidget",function(){return{restrict:"E",replace:!0,templateUrl:"/partials/account/views/login-widget"}}),angular.module("stage").controller("stProfileCtrl",["$scope","stAuthSvc","stIdentitySvc","stTickerSvc",function(e,t,r,n){e.email=r.currentUser.userName,e.firstName=r.currentUser.firstName,e.lastName=r.currentUser.lastName,e.update=function(){var r={userName:e.email,firstName:e.firstName,lastName:e.lastName};e.password&&e.password.length>0&&(r.password=e.password),t.updateCurrentUser(r).then(function(){n.notify("Your profile has been updated.")},function(e){n.error(e)})}}]),angular.module("stage").factory("stUserSvc",["$resource",function(e){var t=e("/api/users/:id",{_id:"@id"},{update:{method:"PUT",isArray:!1},purge:{method:"PURGE",isArray:!1}});return t.prototype.isAdmin=function(){return this.roles&&this.roles.indexOf("admin")>-1},t}]),angular.module("stage").controller("stAdminCtrl",["$scope","$timeout","stAdminSvc","stAdminUserSvc","stAuthSvc","stTickerSvc",function(e,t,r,n,s,o){e.env=r.whatEnv(),e.users=n.populateUsers(),e.userRes=e.users,e.userField="userName",e.userReverse=!1,e.userCurrentPage=0,e.userShowOnPage="10",e.userSyncEnabled="development"==e.env,e.userSyncDir="toloc",e.filterUsers=function(){e.userRes=[];var t=n.searchUsers(e.users,e.userSearch);e.userRes=t,e.userCurrentPage=0},e.sortUsers=function(t,r){e.userReverse=e.userField===t?!e.userReverse:!1,r&&(e.userReverse=e.userField===t?e.userReverse:!0),e.userField=t},e.createUser=function(){var t={userName:e.email,password:e.password,firstName:e.firstName,lastName:e.lastName};s.createUser(t).then(function(){o.notify("Created user account "+t.userName+"."),r.adminRedirect("/admin")},function(e){o.error(e)})},e.purgeUsers=function(){r.adminRedirect("/admin"),r.updateRoot("userPurgeInProgress",!0),t(function(){s.purgeUsers().then(function(){r.adminRedirect("/"),s.logoutUser().then(function(){t(e.purgeDone,5e3)},function(e){o.error(e),r.updateRoot("userPurgeInProgress",!1)})},function(r){o.error(r),t(e.purgeDone,5e3)})},5e3)},e.syncDb=function(n,a){"users"==n&&(r.adminRedirect("/admin"),r.updateRoot("userSyncInProgress",!0),s.syncUsers(a).then(function(){"toloc"==a?(r.adminRedirect("/"),s.logoutUser().then(function(){t(e.syncDone,5e3)},function(e){o.error(e),r.updateRoot("userSyncInProgress",!0)})):t(e.syncDone,5e3)},function(r){o.error(r),t(e.syncDone,5e3)}))},e.pageUsers=function(){return Math.ceil(e.userRes.length/e.userShowOnPage)},e.purgeDone=function(){o.notify("User database has been purged."),r.updateRoot("userPurgeInProgress",!1)},e.syncDone=function(){o.notify("User database has been synced."),r.updateRoot("userSyncInProgress",!0)}}]),angular.module("stage").factory("stAdminSvc",["$location","$parse","$rootScope","$window",function(e,t,r,n){return{adminRedirect:function(t){e.path(t)},updateRoot:function(e,r){var n=t("$rootScope."+e);n=r},whatEnv:function(){return n.env}}}]),angular.module("stage").factory("stAdminUserSvc",["$filter","stUserSvc",function(e,t){return{actionDone:function(e){switch(e){case"purge":var t="purged";$rootScope.userPurgeInProgress=!1;break;case"sync":var t="synced";$rootScope.userSyncInProgress=!1}t&&stTickerSvc.notify("User database has been "+t+".")},populateUsers:function(){return t.query()},searchUsers:function(t,r){return e("userfind")(t,r)}}}]),angular.module("stage").factory("stDevDbAzureSvc",function(){return{view:"azureStream",viewType:"view",status:!1,streamWell:"",endPoint:"/api/devdash/azureStream/",eventSource:!1,getStream:function(){return this.streamWell}}}),angular.module("stage").controller("stDevDbCtrl",["$scope","$http","$interval","$timeout","stDevDbSvc",function(e,t,r,n,s){e.currentSvc={view:null,type:null,streamWell:""},e.svcStatus={heartBeat:r(function(){var t=["devMongo","cloudMongo","azureStream"];t.forEach(function(t){"error"!==e.svcStatus[t]&&s.checkStatus(t).then(function(r){r.code?(e.svcStatus[t]="error",console.log("A fatal connection error to "+t+" has disrupted heartbeat services")):e.svcStatus[t]=r},function(e){console.log(e)})})},500)},e.changeView=function(t){"overview"==t?(e.currentSvc.view=null,e.currentSvc.type=null):(e.currentSvc.view=t,e.currentSvc.type=s.getConsoleType(t),e.currentSvc.streamWell=s.getStreamWell(t),e.svcStatus[t]||e.connectService(t))},e.connectService=function(t){console.log("Connecting service "+t),s.connectService(t).then(function(){"undefined"!=typeof EventSource?(e.currentSvc.streamWell=s.currentSvc.getStream(),s.currentSvc.eventSource=new EventSource(s.currentSvc.endPoint+"stream"),s.currentSvc.eventSource.addEventListener("message",function(t){e.$apply(function(){e.currentSvc.streamWell=s.updateStreamWell(t.data),n(function(){var e=document.getElementById("streamWell");e.scrollTop=e.scrollHeight},50)})},!1),s.currentSvc.eventSource.addEventListener("error",function(r){e.$apply(function(){e.ddbDisconnect(t),e.currentSvc.streamWell+="The stream for "+t+" has been unexpectedly closed.\n"}),s.currentSvc.eventSource.close()},!1)):e.currentSvc.streamWell="This browser does not support streaming.\n"})},e.ddbCommand=function(){var r=e.currentSvc.view;if(console.log(r),"cmd"!==e.currentSvc.type)return!1;console.log("Type is cmd"),console.log(e.ddbCmdBar),console.log(e.checkStatus(r));var n=!1;switch(r){case"localMongo":n=e.localMongoStatus;break;case"remoteMongo":n=e.remoteMongoStatus}return n&&e.ddbCmdBar?void t.post("/api/devdash/"+r+"/command",{cmd:e.ddbCmdBar}).then(function(t){e.ddbCmdBar=""}):!1},e.ddbDisconnect=function(t){"localMongo"==t?e.localMongoStatus=!1:"remoteMongo"==t?e.remoteMongoStatus=!1:"azureStream"==t&&(e.azureStreamStatus=!1)},e.checkStatus=function(e){return s.checkStatus(e)},e.ddbStream=function(t){if("undefined"!=typeof EventSource){var r=new EventSource("/api/devdash/"+t+"/stream");r.addEventListener("message",function(t){e.$apply(function(){var r=JSON.parse(t.data);r=r.replace(/\[0m/g,""),r=r.replace(/\[36m/g,""),r=unescape(encodeURIComponent(r)),console.log(r),e.currentSvc.streamWell+=r.trim()+"\n",n(function(){var e=document.getElementById("streamWell");e.scrollTop=e.scrollHeight},50)})},!1),r.addEventListener("error",function(n){e.$apply(function(){e.ddbDisconnect(t),e.currentSvc.streamWell+="The stream for "+t+" has been unexpectedly closed.\n"}),r.close()},!1)}else e.currentSvc.streamWell="This browser does not support streaming.\n"}}]),angular.module("stage").factory("stDevDbMongoSvc",function(){return{cloud:{view:"cloudMongo",status:!1,streamWell:"",endPoint:"/api/devdash/remoteMongo/",viewType:"cmd",eventSource:!1,getStream:function(){return this.streamWell}},dev:{view:"devMongo",status:!1,streamWell:"",endPoint:"/api/devdash/localMongo/",viewType:"cmd",eventSource:!1,getStream:function(){return this.streamWell}}}}),angular.module("stage").factory("stDevDbSvc",["$http","$interval","$q","stDevDbAzureSvc","stDevDbMongoSvc",function(e,t,r,n,s){return{currentSvc:null,svcList:{cloudMongo:s.cloud,devMongo:s.dev,azureStream:n},sendRequest:function(t,r,n,s,o,a){return o=o?this.svcList[o]:!1,a=a?a:{},e({method:t,url:(o?o.endPoint:currentSvc.endPoint)+r,data:a}).then(n,s)},checkStatus:function(e){return e||null!=this.currentSvc?this.sendRequest("GET","status",function(e){return"Connected"==e.data.response&&200==e.status?!0:200!==e.status?{error:e.status}:!1},function(e){return{error:e.status}},e?e:!1).then(function(t){return t.error?(e||(this.currentSvc.status=!1),{code:t.error,msg:"Failed to connect to service: Unexpected response"}):t?(e||(this.currentSvc.status=!0),!0):(e||(this.currentSvc.status=!1),!1)},function(t){return e||(this.currentSvc.status=!1),{code:t.error,msg:"Failed to connect to service: Unexpected response"}}):!1},connectService:function(e){return this.currentSvc=this.svcList[e],currentSvc=this.currentSvc,this.sendRequest("GET","connect",function(e){return"Connected"==e.data.response&&200==e.status},function(e){return{error:e.status}},e).then(function(e){if(e.error)throw this.currentSvc.status=!1,{code:e.status,msg:"Failed to connect to service: Unexpected response"};this.currentSvc.status=!0},function(e){throw this.currentSvc.status=!1,{code:e.status,msg:"Failed to connect to service: Unexpected response"}})},getConsoleType:function(e){return this.svcList[e].viewType},getStreamWell:function(e){return this.svcList[e].streamWell},updateStreamWell:function(e){var t=JSON.parse(e);return t=t.replace(/\[0m/g,""),t=t.replace(/\[36m/g,""),t=unescape(encodeURIComponent(t)),this.currentSvc.streamWell+=t.trim()+"\n",console.log("DBG: "+this.currentSvc.streamWell),this.currentSvc.streamWell}}}]),angular.module("stage").filter("userStartPage",function(){return function(e,t){return t=+t,e.slice(t)}}),angular.module("stage").filter("userfind",function(){return function(e,t){var r=[];return angular.forEach(e,function(e){try{var n=new RegExp(t,"gi")}catch(s){return[]}(e.userName.match(n)||e.firstName.match(n)||e.lastName.match(n)||""==t)&&r.push({_id:e._id,userName:e.userName,firstName:e.firstName,lastName:e.lastName,roles:e.roles})}),r}}),angular.module("stage").controller("stMainCtrl",["$scope",function(e){}]),angular.module("stage").controller("stTickerCtrl",["$scope","stTickerSvc",function(e,t){e.custom=t.custom(),e.reset=t.reset(),e.showAll=function(){$(".ticker-container").toggleClass("expanded")}}]),angular.module("stage").factory("stTickerSvc",function(){function e(e,r,o){e=r?" "+e:e;var a=$("<span></span>").addClass("ticker-msg").html(e);o&&(o=$("<span></span>").addClass("iconic iconic-sm "+o),a.prepend(o)),r&&a.addClass(r),$("#ticker").addClass("on").prepend(a),setTimeout(function(){$("#ticker").removeClass("on")},300),n?(clearTimeout(s),s=setTimeout(function(){t(),n=!1},8e3)):(n=!0,s=setTimeout(function(){t(),n=!1},8e3))}function t(){$("#ticker #ftrmsg").remove();var e=$("<span></span>").html(r).attr("id","ftrmsg");$("#ticker").addClass("on").prepend(e),setTimeout(function(){$("#ticker").removeClass("on")},300)}var r="//tardigrade/node | Tardigrade Digital &copy; 2016",n=!1,s=null;return{custom:function(t,r,n){return t?void e(t,r,"iconic-"+n):!1},notify:function(t){return t?void e(t,"success","iconic-circle-check"):!1},error:function(t){return t?void e(t,"error","iconic-circle-x"):!1},info:function(t){return t?void e(t,null,"iconic-info"):!1},reset:function(){t()}}});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInN0YWdlLmpzIiwiYWNjb3VudC9zdEF1dGhTdmMuanMiLCJhY2NvdW50L3N0SWRlbnRpdHlTdmMuanMiLCJhY2NvdW50L3N0TG9naW5DdHJsLmpzIiwiYWNjb3VudC9zdExvZ2luV2lkZ2V0LmpzIiwiYWNjb3VudC9zdFByb2ZpbGVDdHJsLmpzIiwiYWNjb3VudC9zdFVzZXJTdmMuanMiLCJhZG1pbi9zdEFkbWluQ3RybC5qcyIsImFkbWluL3N0QWRtaW5TdmMuanMiLCJhZG1pbi9zdEFkbWluVXNlclN2Yy5qcyIsImFkbWluL3N0RGV2RGJBenVyZVN2Yy5qcyIsImFkbWluL3N0RGV2RGJDdHJsLmpzIiwiYWRtaW4vc3REZXZEYk1vbmdvU3ZjLmpzIiwiYWRtaW4vc3REZXZEYlN2Yy5qcyIsImFkbWluL3N0UGFnZUZpbHRlci5qcyIsImFkbWluL3N0VXNlckZpbHRlci5qcyIsIm1haW4vc3RNYWluQ3RybC5qcyIsInRpY2tlci9zdFRpY2tlckN0cmwuanMiLCJ0aWNrZXIvc3RUaWNrZXJTdmMuanMiXSwibmFtZXMiOlsiYW5ndWxhciIsIm1vZHVsZSIsImNvbmZpZyIsIiRyb3V0ZVByb3ZpZGVyIiwiJGxvY2F0aW9uUHJvdmlkZXIiLCJyb3V0ZVJvbGVDaGVja3MiLCJhZG1pbiIsImF1dGgiLCJzdEF1dGhTdmMiLCJhdXRob3JpemVDdXJyZW50VXNlckZvclJvdXRlIiwidXNlciIsImF1dGhvcml6ZUF1dGhlbnRpY2F0ZWRVc2VyRm9yUm91dGUiLCJndWVzdCIsInVuYXV0aGVudGljYXRlZFVzZXIiLCJodG1sNU1vZGUiLCJ3aGVuIiwidGVtcGxhdGVVcmwiLCJjb250cm9sbGVyIiwicmVzb2x2ZSIsIm90aGVyd2lzZSIsInJlZGlyZWN0VG8iLCJydW4iLCIkcm9vdFNjb3BlIiwiJGxvY2F0aW9uIiwiJG9uIiwiZXZ0IiwiY3VycmVudCIsInByZXZpb3VzIiwicmVqZWN0aW9uIiwicGF0aCIsImZhY3RvcnkiLCIkaHR0cCIsIiRxIiwic3RJZGVudGl0eVN2YyIsInN0VXNlclN2YyIsImF1dGhlbnRpY2F0ZVVzZXIiLCJ1c2VybmFtZSIsInBhc3N3b3JkIiwiZGZkIiwiZGVmZXIiLCJwb3N0IiwidGhlbiIsInJlc3BvbnNlIiwiZGF0YSIsInN1Y2Nlc3MiLCJleHRlbmQiLCJjdXJyZW50VXNlciIsInByb21pc2UiLCJjcmVhdGVVc2VyIiwibmV3VXNlckRhdGEiLCJuZXdVc2VyIiwiJHNhdmUiLCJyZWplY3QiLCJyZWFzb24iLCJsb2dvdXRVc2VyIiwibG9nb3V0IiwidW5kZWZpbmVkIiwicHVyZ2VVc2VycyIsIm1ldGhvZCIsInVybCIsImNvbnNvbGUiLCJsb2ciLCJzeW5jVXNlcnMiLCJkaXJlY3Rpb24iLCJoZWFkZXJzIiwiQ29udGVudC1UeXBlIiwiY29sbGVjdGlvbiIsInVwZGF0ZUN1cnJlbnRVc2VyIiwiY2xvbmUiLCJjb3B5IiwiJHVwZGF0ZSIsImlzQXV0aGVudGljYXRlZCIsInJvbGUiLCJpc0F1dGhvcml6ZWQiLCIkd2luZG93Iiwic3RhZ2VVc2VyIiwidGhpcyIsInJvbGVzIiwiaW5kZXhPZiIsIiRzY29wZSIsInN0VGlja2VyU3ZjIiwiaWRlbnRpdHkiLCJzaWduaW4iLCIkaW52YWxpZCIsIiQiLCJsb2dpbldpZGdldCIsImFkZENsYXNzIiwiZXJyb3IiLCJub3RpZnkiLCJzaWdub3V0IiwiZGlyZWN0aXZlIiwicmVzdHJpY3QiLCJyZXBsYWNlIiwiZW1haWwiLCJ1c2VyTmFtZSIsImZpcnN0TmFtZSIsImxhc3ROYW1lIiwidXBkYXRlIiwibGVuZ3RoIiwiJHJlc291cmNlIiwiVXNlclJlc291cmNlIiwiX2lkIiwiaXNBcnJheSIsInB1cmdlIiwicHJvdG90eXBlIiwiaXNBZG1pbiIsIiR0aW1lb3V0Iiwic3RBZG1pblN2YyIsInN0QWRtaW5Vc2VyU3ZjIiwiZW52Iiwid2hhdEVudiIsInVzZXJzIiwicG9wdWxhdGVVc2VycyIsInVzZXJSZXMiLCJ1c2VyRmllbGQiLCJ1c2VyUmV2ZXJzZSIsInVzZXJDdXJyZW50UGFnZSIsInVzZXJTaG93T25QYWdlIiwidXNlclN5bmNFbmFibGVkIiwidXNlclN5bmNEaXIiLCJmaWx0ZXJVc2VycyIsInJlcyIsInNlYXJjaFVzZXJzIiwidXNlclNlYXJjaCIsInNvcnRVc2VycyIsImZpZWxkIiwiaW52ZXJ0IiwiYWRtaW5SZWRpcmVjdCIsInVwZGF0ZVJvb3QiLCJwdXJnZURvbmUiLCJzeW5jRGIiLCJzeW5jRGlyIiwic3luY0RvbmUiLCJwYWdlVXNlcnMiLCJNYXRoIiwiY2VpbCIsIiRwYXJzZSIsIm9iaiIsInZhbCIsInJvb3RPYmoiLCIkZmlsdGVyIiwiYWN0aW9uRG9uZSIsImFjdCIsImFjdFZlcmIiLCJ1c2VyUHVyZ2VJblByb2dyZXNzIiwidXNlclN5bmNJblByb2dyZXNzIiwicXVlcnkiLCJ2aWV3Iiwidmlld1R5cGUiLCJzdGF0dXMiLCJzdHJlYW1XZWxsIiwiZW5kUG9pbnQiLCJldmVudFNvdXJjZSIsImdldFN0cmVhbSIsIiRpbnRlcnZhbCIsInN0RGV2RGJTdmMiLCJjdXJyZW50U3ZjIiwidHlwZSIsInN2Y1N0YXR1cyIsImhlYXJ0QmVhdCIsInN2Y3MiLCJmb3JFYWNoIiwic3ZjIiwiY2hlY2tTdGF0dXMiLCJzdGF0IiwiY29kZSIsImNoYW5nZVZpZXciLCJnZXRDb25zb2xlVHlwZSIsImdldFN0cmVhbVdlbGwiLCJjb25uZWN0U2VydmljZSIsIkV2ZW50U291cmNlIiwiYWRkRXZlbnRMaXN0ZW5lciIsImV2ZW50IiwiJGFwcGx5IiwidXBkYXRlU3RyZWFtV2VsbCIsInN3IiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsInNjcm9sbFRvcCIsInNjcm9sbEhlaWdodCIsImVyciIsImRkYkRpc2Nvbm5lY3QiLCJjbG9zZSIsImRkYkNvbW1hbmQiLCJkZGJDbWRCYXIiLCJzdmNTdGF0IiwibG9jYWxNb25nb1N0YXR1cyIsInJlbW90ZU1vbmdvU3RhdHVzIiwiY21kIiwiYXp1cmVTdHJlYW1TdGF0dXMiLCJkZGJTdHJlYW0iLCJzdHJtU291cmNlIiwibXNnIiwiSlNPTiIsInBhcnNlIiwidW5lc2NhcGUiLCJlbmNvZGVVUklDb21wb25lbnQiLCJ0cmltIiwiY2xvdWQiLCJkZXYiLCJzdERldkRiQXp1cmVTdmMiLCJzdERldkRiTW9uZ29TdmMiLCJzdmNMaXN0IiwiY2xvdWRNb25nbyIsImRldk1vbmdvIiwiYXp1cmVTdHJlYW0iLCJzZW5kUmVxdWVzdCIsInN1Y2Nlc3NDYWxsYmFjayIsImVycm9yQ2FsbGJhY2siLCJyYXdtc2ciLCJmaWx0ZXIiLCJpbnB1dCIsInN0YXJ0Iiwic2xpY2UiLCJxIiwibWF0Y2hlZCIsInUiLCJleHAiLCJSZWdFeHAiLCJlIiwibWF0Y2giLCJwdXNoIiwiY3VzdG9tIiwicmVzZXQiLCJzaG93QWxsIiwidG9nZ2xlQ2xhc3MiLCJhZGRUaWNrZXIiLCJsdmwiLCJpYyIsIm1zZ29iaiIsImh0bWwiLCJwcmVwZW5kIiwic2V0VGltZW91dCIsInJlbW92ZUNsYXNzIiwidG9zZXQiLCJjbGVhclRpbWVvdXQiLCJ0byIsInJlc2V0VGlja2VyIiwicmVtb3ZlIiwiZnRyIiwiYXR0ciIsImluZm8iXSwibWFwcGluZ3MiOiJBQUFBQSxRQUFBQyxPQUFBLFNBQUEsYUFBQSxVQUFBLGNBQUEsY0FFQUQsUUFBQUMsT0FBQSxTQUFBQyxRQUFBLGlCQUFBLG9CQUFBLFNBQUFDLEVBQUFDLEdBQ0EsR0FBQUMsSUFDQUMsT0FBQUMsTUFBQSxZQUFBLFNBQUFDLEdBQUEsTUFBQUEsR0FBQUMsNkJBQUEsWUFDQUMsTUFBQUgsTUFBQSxZQUFBLFNBQUFDLEdBQUEsTUFBQUEsR0FBQUcsd0NBQ0FDLE9BQUFMLE1BQUEsWUFBQSxTQUFBQyxHQUFBLE1BQUFBLEdBQUFLLHlCQUdBVCxHQUFBVSxXQUFBLEdBQ0FYLEVBQ0FZLEtBQUEsS0FDQUMsWUFBQSxzQkFDQUMsV0FBQSxlQUVBRixLQUFBLFVBQ0FDLFlBQUEsOEJBQ0FDLFdBQUEsY0FDQUMsUUFBQWIsRUFBQUMsUUFFQVMsS0FBQSxjQUNBQyxZQUFBLHNDQUNBQyxXQUFBLGNBQ0FDLFFBQUFiLEVBQUFDLFFBRUFTLEtBQUEsb0JBQ0FD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QSxnQkFBQSxHQUNBK0IsTUFBQSxXQUFBYyIsImZpbGUiOiJhcHAuanMiLCJzb3VyY2VzQ29udGVudCI6WyJhbmd1bGFyLm1vZHVsZSgnc3RhZ2UnLCBbJ25nUmVzb3VyY2UnLCAnbmdSb3V0ZScsICd1aS5ncmF2YXRhcicsICduZ0FuaW1hdGUnXSk7XHJcblxyXG5hbmd1bGFyLm1vZHVsZSgnc3RhZ2UnKS5jb25maWcoZnVuY3Rpb24oJHJvdXRlUHJvdmlkZXIsICRsb2NhdGlvblByb3ZpZGVyKSB7XHJcbiAgdmFyIHJvdXRlUm9sZUNoZWNrcyA9IHtcclxuICAgIGFkbWluOiB7IGF1dGg6IC8qQG5nSW5qZWN0Ki8gZnVuY3Rpb24oc3RBdXRoU3ZjKSB7IHJldHVybiBzdEF1dGhTdmMuYXV0aG9yaXplQ3VycmVudFVzZXJGb3JSb3V0ZSgnYWRtaW4nKTsgfSB9LFxyXG4gICAgdXNlcjogeyBhdXRoOiAvKkBuZ0luamVjdCovIGZ1bmN0aW9uKHN0QXV0aFN2YykgeyByZXR1cm4gc3RBdXRoU3ZjLmF1dGhvcml6ZUF1dGhlbnRpY2F0ZWRVc2VyRm9yUm91dGUoKTsgfSB9LFxyXG4gICAgZ3Vlc3Q6IHsgYXV0aDogLypAbmdJbmplY3QqLyBmdW5jdGlvbihzdEF1dGhTdmMpIHsgcmV0dXJuIHN0QXV0aFN2Yy51bmF1dGhlbnRpY2F0ZWRVc2VyKCk7IH0gfVxyXG4gIH1cclxuXHJcbiAgJGxvY2F0aW9uUHJvdmlkZXIuaHRtbDVNb2RlKHRydWUpO1xyXG4gICRyb3V0ZVByb3ZpZGVyXHJcbiAgICAud2hlbignLycsIHsgXHJcbiAgICAgIHRlbXBsYXRlVXJsOiAnL3BhcnRpYWxzL21haW4vbWFpbicsIFxyXG4gICAgICBjb250cm9sbGVyOiAnc3RNYWluQ3RybCdcclxuICAgIH0pXHJcbiAgICAud2hlbignL2FkbWluJywge1xyXG4gICAgICB0ZW1wbGF0ZVVybDogJy9wYXJ0aWFscy9hZG1pbi92aWV3cy9hZG1pbicsIFxyXG4gICAgICBjb250cm9sbGVyOiAnc3RBZG1pbkN0cmwnLCBcclxuICAgICAgcmVzb2x2ZTogcm91dGVSb2xlQ2hlY2tzLmFkbWluXHJcbiAgICB9KVxyXG4gICAgLndoZW4oJy9hZG1pbi9kZGInLCB7XHJcbiAgICAgIHRlbXBsYXRlVXJsOiAnL3BhcnRpYWxzL2FkbWluL3ZpZXdzL2Rldi1kYXNoYm9hcmQnLCBcclxuICAgICAgY29udHJvbGxlcjogJ3N0RGV2RGJDdHJsJywgXHJcbiAgICAgIHJlc29sdmU6IHJvdXRlUm9sZUNoZWNrcy5hZG1pblxyXG4gICAgfSlcclxuICAgIC53aGVuKCcvYWRtaW4vdXNlcnMvYWRkJywge1xyXG4gICAgICB0ZW1wbGF0ZVVybDogJy9wYXJ0aWFscy9hZG1pbi92aWV3cy9hZGQtdXNlcicsIFxyXG4gICAgICBjb250cm9sbGVyOiAnc3RBZG1pbkN0cmwnLCBcclxuICAgICAgcmVzb2x2ZTogcm91dGVSb2xlQ2hlY2tzLmFkbWluXHJcbiAgICB9KVxyXG4gICAgLndoZW4oJy9hZG1pbi91c2Vycy9kZWxldGUnLCB7XHJcbiAgICAgIHRlbXBsYXRlVXJsOiAnL3BhcnRpYWxzL2FkbWluL3ZpZXdzL2RlbGV0ZS11c2VyJywgXHJcbiAgICAgIGNvbnRyb2xsZXI6ICdzdEFkbWluQ3RybCcsIFxyXG4gICAgICByZXNvbHZlOiByb3V0ZVJvbGVDaGVja3MuYWRtaW5cclxuICAgIH0pXHJcbiAgICAud2hlbignL2FkbWluL3VzZXJzL3B1cmdlJywge1xyXG4gICAgICB0ZW1wbGF0ZVVybDogJy9wYXJ0aWFscy9hZG1pbi92aWV3cy9wdXJnZS11c2VycycsIFxyXG4gICAgICBjb250cm9sbGVyOiAnc3RBZG1pbkN0cmwnLCBcclxuICAgICAgcmVzb2x2ZTogcm91dGVSb2xlQ2hlY2tzLmFkbWluXHJcbiAgICB9KVxyXG4gICAgLndoZW4oJy9hZG1pbi91c2Vycy9zeW5jJywge1xyXG4gICAgICB0ZW1wbGF0ZVVybDogJy9wYXJ0aWFscy9hZG1pbi92aWV3cy9zeW5jLXVzZXJzJywgXHJcbiAgICAgIGNvbnRyb2xsZXI6ICdzdEFkbWluQ3RybCcsIFxyXG4gICAgICByZXNvbHZlOiByb3V0ZVJvbGVDaGVja3MuYWRtaW5cclxuICAgIH0pXHJcbiAgICAud2hlbignL2xvZ2luJywge1xyXG4gICAgICB0ZW1wbGF0ZVVybDogJy9wYXJ0aWFscy9hY2NvdW50L3ZpZXdzL2xvZ2luJywgXHJcbiAgICAgIGNvbnRyb2xsZXI6ICdzdExvZ2luQ3RybCcsXHJcbiAgICAgIHJlc29sdmU6IHJvdXRlUm9sZUNoZWNrcy5ndWVzdFxyXG4gICAgfSlcclxuICAgIC53aGVuKCcvc2lnbnVwJywge1xyXG4gICAgICB0ZW1wbGF0ZVVybDogJy9wYXJ0aWFscy9hY2NvdW50L3ZpZXdzL3NpZ251cCcsIFxyXG4gICAgICBjb250cm9sbGVyOiAnc3RTaWdudXBDdHJsJyxcclxuICAgICAgcmVzb2x2ZTogcm91dGVSb2xlQ2hlY2tzLmd1ZXN0XHJcbiAgICB9KVxyXG4gICAgLndoZW4oJy9zZXR0aW5ncycsIHtcclxuICAgICAgdGVtcGxhdGVVcmw6ICcvcGFydGlhbHMvYWNjb3VudC92aWV3cy9zZXR0aW5ncycsIFxyXG4gICAgICBjb250cm9sbGVyOiAnc3RQcm9maWxlQ3RybCcsXHJcbiAgICAgIHJlc29sdmU6IHJvdXRlUm9sZUNoZWNrcy51c2VyXHJcbiAgICB9KVxyXG4gICAgLm90aGVyd2lzZSh7XHJcbiAgICAgIHJlZGlyZWN0VG86ICcvJ1xyXG4gICAgfSk7XHJcbn0pO1xyXG5cclxuYW5ndWxhci5tb2R1bGUoJ3N0YWdlJykucnVuKGZ1bmN0aW9uKCRyb290U2NvcGUsICRsb2NhdGlvbikge1xyXG4gICRyb290U2NvcGUuJG9uKCckcm91dGVDaGFuZ2VFcnJvcicsIGZ1bmN0aW9uKGV2dCwgY3VycmVudCwgcHJldmlvdXMsIHJlamVjdGlvbikge1xyXG4gICAgaWYocmVqZWN0aW9uID09PSAnbm90IGF1dGhvcml6ZWQnKSB7XHJcbiAgICAgICRsb2NhdGlvbi5wYXRoKCcvJyk7XHJcbiAgICB9XHJcbiAgfSlcclxufSk7IiwiYW5ndWxhci5tb2R1bGUoJ3N0YWdlJykuZmFjdG9yeSgnc3RBdXRoU3ZjJywgZnVuY3Rpb24oJGh0dHAsICRxLCBzdElkZW50aXR5U3ZjLCBzdFVzZXJTdmMpIHtcclxuICByZXR1cm4ge1xyXG4gICAgLy8gYXV0aGVudGljYXRlVXNlcjogVmVyaWZpZXMgbG9naW4gY3JlZGVudGlhbHMgYW5kIHNpZ25zIGluIHVzZXJcclxuICAgIGF1dGhlbnRpY2F0ZVVzZXI6IGZ1bmN0aW9uKHVzZXJuYW1lLCBwYXNzd29yZCkge1xyXG4gICAgICB2YXIgZGZkID0gJHEuZGVmZXIoKTtcclxuICAgICAgJGh0dHAucG9zdCgnL2xvZ2luJywge3VzZXJuYW1lOnVzZXJuYW1lLCBwYXNzd29yZDpwYXNzd29yZH0pLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2UpIHtcclxuICAgICAgICBpZihyZXNwb25zZS5kYXRhLnN1Y2Nlc3MpIHtcclxuICAgICAgICAgIHZhciB1c2VyID0gbmV3IHN0VXNlclN2YygpO1xyXG4gICAgICAgICAgZGVsZXRlIHJlc3BvbnNlLmRhdGEudXNlclsnaGFzaGVkX3B3ZCddO1xyXG4gICAgICAgICAgZGVsZXRlIHJlc3BvbnNlLmRhdGEudXNlclsnc2FsdCddO1xyXG4gICAgICAgICAgYW5ndWxhci5leHRlbmQodXNlciwgcmVzcG9uc2UuZGF0YS51c2VyKTtcclxuICAgICAgICAgIHN0SWRlbnRpdHlTdmMuY3VycmVudFVzZXIgPSB1c2VyO1xyXG4gICAgICAgICAgZGZkLnJlc29sdmUodHJ1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgZGZkLnJlc29sdmUoZmFsc2UpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICAgIHJldHVybiBkZmQucHJvbWlzZTtcclxuICAgIH0sXHJcbiAgICBcclxuICAgIC8vIGNyZWF0ZVVzZXI6IENyZWF0ZXMgYSBuZXcgdXNlclxyXG4gICAgY3JlYXRlVXNlcjogZnVuY3Rpb24obmV3VXNlckRhdGEpIHtcclxuICAgICAgdmFyIG5ld1VzZXIgPSBuZXcgc3RVc2VyU3ZjKG5ld1VzZXJEYXRhKTtcclxuICAgICAgdmFyIGRmZCA9ICRxLmRlZmVyKCk7XHJcbiAgICAgIFxyXG4gICAgICBuZXdVc2VyLiRzYXZlKCkudGhlbihmdW5jdGlvbigpIHtcclxuICAgICAgICBkZmQucmVzb2x2ZSgpO1xyXG4gICAgICB9LCBmdW5jdGlvbihyZXNwb25zZSkge1xyXG4gICAgICAgIGRmZC5yZWplY3QocmVzcG9uc2UuZGF0YS5yZWFzb24pO1xyXG4gICAgICB9KVxyXG4gICAgICBcclxuICAgICAgcmV0dXJuIGRmZC5wcm9taXNlO1xyXG4gICAgfSxcclxuICAgIFxyXG4gICAgLy8gbG9nb3V0VXNlcjogRW5kcyB0aGUgY3VycmVudCB1c2VyJ3Mgc2Vzc2lvblxyXG4gICAgbG9nb3V0VXNlcjogZnVuY3Rpb24oKSB7XHJcbiAgICAgIHZhciBkZmQgPSAkcS5kZWZlcigpO1xyXG4gICAgICAkaHR0cC5wb3N0KCcvbG9nb3V0Jywge2xvZ291dDogdHJ1ZX0pLnRoZW4oZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgc3RJZGVudGl0eVN2Yy5jdXJyZW50VXNlciA9IHVuZGVmaW5lZDtcclxuICAgICAgICBkZmQucmVzb2x2ZSgpO1xyXG4gICAgICB9KTtcclxuICAgICAgcmV0dXJuIGRmZC5wcm9taXNlO1xyXG4gICAgfSxcclxuICAgIFxyXG4gICAgLy9wdXJnZVVzZXJzOiBSZW1vdmVzIGFsbCB1c2VycyBhbmQgcmVzdG9yZXMgdXNlciBkYXRhYmFzZSB0byBkZWZhdWx0c1xyXG4gICAgcHVyZ2VVc2VyczogZnVuY3Rpb24oKSB7XHJcbiAgICAgIHZhciBkZmQgPSAkcS5kZWZlcigpO1xyXG4gICAgICAkaHR0cCh7XHJcbiAgICAgICAgbWV0aG9kOiAnUFVSR0UnLFxyXG4gICAgICAgIHVybDogJy9hcGkvdXNlcnMnXHJcbiAgICAgIH0pLnRoZW4oZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coJ1VzZXIgZGF0YWJhc2UgaGFzIGJlZW4gcHVyZ2VkJyk7XHJcbiAgICAgICAgZGZkLnJlc29sdmUoKTtcclxuICAgICAgfSk7XHJcbiAgICAgIHJldHVybiBkZmQucHJvbWlzZTtcclxuICAgIH0sXHJcbiAgICBcclxuICAgIC8vIHN5bmNVc2VyczogU3luY3MgdXNlciBkYXRhYmFzZSBjb2xsZWN0aW9uXHJcbiAgICBzeW5jVXNlcnM6IGZ1bmN0aW9uKGRpcmVjdGlvbikge1xyXG4gICAgICB2YXIgZGZkID0gJHEuZGVmZXIoKTtcclxuICAgICAgJGh0dHAoe1xyXG4gICAgICAgIG1ldGhvZDogJ0NPUFknLFxyXG4gICAgICAgIHVybDogJy9hcGkvZGInLFxyXG4gICAgICAgIGhlYWRlcnM6IHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyB9LFxyXG4gICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgIGNvbGxlY3Rpb246ICd1c2VycycsXHJcbiAgICAgICAgICBkaXJlY3Rpb246IGRpcmVjdGlvblxyXG4gICAgICAgIH1cclxuICAgICAgfSkudGhlbihmdW5jdGlvbigpIHtcclxuICAgICAgICBjb25zb2xlLmxvZygnVXNlciBkYXRhYmFzZSBoYXMgYmVlbiBzeW5jZWQnKTtcclxuICAgICAgICBkZmQucmVzb2x2ZSgpO1xyXG4gICAgICB9KTtcclxuICAgICAgcmV0dXJuIGRmZC5wcm9taXNlO1xyXG4gICAgfSxcclxuICAgIFxyXG4gICAgLy8gdXBkYXRlQ3VycmVudFVzZXI6IFVwZGF0ZXMgcHJvZmlsZSBvZiBjdXJyZW50IHVzZXJcclxuICAgIHVwZGF0ZUN1cnJlbnRVc2VyOiBmdW5jdGlvbihuZXdVc2VyRGF0YSkge1xyXG4gICAgICB2YXIgZGZkID0gJHEuZGVmZXIoKTtcclxuICAgICAgXHJcbiAgICAgIHZhciBjbG9uZSA9IGFuZ3VsYXIuY29weShzdElkZW50aXR5U3ZjLmN1cnJlbnRVc2VyKTtcclxuICAgICAgYW5ndWxhci5leHRlbmQoY2xvbmUsIG5ld1VzZXJEYXRhKTtcclxuICAgICAgY2xvbmUuJHVwZGF0ZSgpLnRoZW4oZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgc3RJZGVudGl0eVN2Yy5jdXJyZW50VXNlciA9IGNsb25lO1xyXG4gICAgICAgIGRmZC5yZXNvbHZlKCk7XHJcbiAgICAgIH0sIGZ1bmN0aW9uKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgZGZkLnJlamVjdChyZXNwb25zZS5kYXRhLnJlYXNvbik7XHJcbiAgICAgIH0pO1xyXG4gICAgICByZXR1cm4gZGZkLnByb21pc2U7XHJcbiAgICB9LFxyXG4gICAgXHJcbiAgICAvLyBhdXRob3JpemVBdXRoZW50aWNhdGVkVXNlckZvclJvdXRlOiBDaGVja3Mgd2hldGhlciB1c2VyIGlzIHNpZ25lZCBpblxyXG4gICAgYXV0aG9yaXplQXV0aGVudGljYXRlZFVzZXJGb3JSb3V0ZTogZnVuY3Rpb24oKSB7XHJcbiAgICAgIGlmKHN0SWRlbnRpdHlTdmMuaXNBdXRoZW50aWNhdGVkKCkpIHsgcmV0dXJuIHRydWU7IH1cclxuICAgICAgZWxzZSB7IHJldHVybiAkcS5yZWplY3QoJ25vdCBhdXRob3JpemVkJyk7IH1cclxuICAgIH0sXHJcbiAgICBcclxuICAgIC8vIGF1dGhvcml6ZUN1cnJlbnRVc2VyRm9yUm91dGU6IENoZWNrcyB3aGV0aGVyIGN1cmVudCB1c2VyIGhhcyByb2xlXHJcbiAgICBhdXRob3JpemVDdXJyZW50VXNlckZvclJvdXRlOiBmdW5jdGlvbihyb2xlKSB7XHJcbiAgICAgIGlmKHN0SWRlbnRpdHlTdmMuaXNBdXRob3JpemVkKHJvbGUpKSB7IHJldHVybiB0cnVlOyB9XHJcbiAgICAgIGVsc2UgeyByZXR1cm4gJHEucmVqZWN0KCdub3QgYXV0aG9yaXplZCcpOyB9XHJcbiAgICB9LFxyXG4gICAgXHJcbiAgICAvLyB1bmF1dGhlbnRpY2F0ZWRVc2VyOiBDaGVja3Mgd2hldGhlciB1c2VyIGlzIG5vdCBzaWduZWQgaW5cclxuICAgIHVuYXV0aGVudGljYXRlZFVzZXI6IGZ1bmN0aW9uKCkge1xyXG4gICAgICBpZighc3RJZGVudGl0eVN2Yy5pc0F1dGhlbnRpY2F0ZWQoKSkgeyByZXR1cm4gdHJ1ZTsgfVxyXG4gICAgICBlbHNlIHsgcmV0dXJuICRxLnJlamVjdCgndXNlciBzaWduZWQgaW4nKTsgfVxyXG4gICAgfVxyXG4gIH1cclxufSk7IiwiYW5ndWxhci5tb2R1bGUoJ3N0YWdlJykuZmFjdG9yeSgnc3RJZGVudGl0eVN2YycsIGZ1bmN0aW9uKCR3aW5kb3csIHN0VXNlclN2Yykge1xyXG4gIHZhciBjdXJyZW50VXNlcjtcclxuICBpZigkd2luZG93LnN0YWdlVXNlcikgeyBcclxuICAgIGN1cnJlbnRVc2VyID0gbmV3IHN0VXNlclN2YygpO1xyXG4gICAgZGVsZXRlICR3aW5kb3cuc3RhZ2VVc2VyWydoYXNoZWRfcHdkJ107XHJcbiAgICBkZWxldGUgJHdpbmRvdy5zdGFnZVVzZXJbJ3NhbHQnXTtcclxuICAgIGFuZ3VsYXIuZXh0ZW5kKGN1cnJlbnRVc2VyLCAkd2luZG93LnN0YWdlVXNlcik7XHJcbiAgfVxyXG4gIHJldHVybiB7XHJcbiAgICBjdXJyZW50VXNlcjogY3VycmVudFVzZXIsXHJcbiAgICBpc0F1dGhlbnRpY2F0ZWQ6IGZ1bmN0aW9uKCkgeyByZXR1cm4gISF0aGlzLmN1cnJlbnRVc2VyOyB9LFxyXG4gICAgaXNBdXRob3JpemVkOiBmdW5jdGlvbihyb2xlKSB7IHJldHVybiAhIXRoaXMuY3VycmVudFVzZXIgJiYgdGhpcy5jdXJyZW50VXNlci5yb2xlcy5pbmRleE9mKHJvbGUpID4gLTE7IH1cclxuICB9XHJcbn0pOyIsImFuZ3VsYXIubW9kdWxlKCdzdGFnZScpLmNvbnRyb2xsZXIoJ3N0TG9naW5DdHJsJywgZnVuY3Rpb24oJHNjb3BlLCAkbG9jYXRpb24sIHN0QXV0aFN2Yywgc3RJZGVudGl0eVN2Yywgc3RUaWNrZXJTdmMpIHtcclxuICAkc2NvcGUuaWRlbnRpdHkgPSBzdElkZW50aXR5U3ZjO1xyXG4gICRzY29wZS5zaWduaW4gPSBmdW5jdGlvbih1c2VybmFtZSwgcGFzc3dvcmQpIHtcclxuICAgIGlmKCF1c2VybmFtZSB8fCAhcGFzc3dvcmQgfHwgdXNlcm5hbWUuJGludmFsaWQgfHwgcGFzc3dvcmQuJGludmFsaWQpIHtcclxuICAgICAgaWYoIXVzZXJuYW1lIHx8IHVzZXJuYW1lLiRpbnZhbGlkKSB7ICQobG9naW5XaWRnZXQudXNlcm5hbWUpLmFkZENsYXNzKCdpbnZhbGlkJyk7IH1cclxuICAgICAgaWYoIXBhc3N3b3JkIHx8IHBhc3N3b3JkLiRpbnZhbGlkKSB7ICQobG9naW5XaWRnZXQucGFzc3dvcmQpLmFkZENsYXNzKCdpbnZhbGlkJyk7IH1cclxuICAgICAgc3RUaWNrZXJTdmMuZXJyb3IoJ1BsZWFzZSBlbnRlciBhIHZhbGlkIGVtYWlsIGFkZHJlc3MgYW5kIHBhc3N3b3JkLicpO1xyXG4gICAgICByZXR1cm4gZmFsc2U7ICBcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICBzdEF1dGhTdmMuYXV0aGVudGljYXRlVXNlcih1c2VybmFtZSwgcGFzc3dvcmQpLnRoZW4oZnVuY3Rpb24oc3VjY2Vzcykge1xyXG4gICAgICAgIGlmKHN1Y2Nlc3MpIHtcclxuICAgICAgICAgIHVzZXJuYW1lID0gJyc7XHJcbiAgICAgICAgICBwYXNzd29yZCA9ICcnO1xyXG4gICAgICAgICAgJHNjb3BlLnVzZXJuYW1lID0gJyc7XHJcbiAgICAgICAgICAkc2NvcGUucGFzc3dvcmQgPSAnJztcclxuICAgICAgICAgIHZhciBwYXRoID0gc3RJZGVudGl0eVN2Yy5pc0F1dGhvcml6ZWQoJ2FkbWluJykgPyAnL2FkbWluJyA6ICcvJztcclxuICAgICAgICAgIHN0VGlja2VyU3ZjLm5vdGlmeSgnWW91IGhhdmUgYmVlbiBzdWNjZXNzZnVsbHkgYXV0aGVudGljYXRlZC4nKTtcclxuICAgICAgICAgIGlmKCRsb2NhdGlvbi5wYXRoKCdsb2dpbicpKSB7ICRsb2NhdGlvbi5wYXRoKHBhdGgpOyB9XHJcbiAgICAgICAgICBpZihzdElkZW50aXR5U3ZjLmlzQXV0aG9yaXplZCgnYWRtaW4nKSkgeyAkbG9jYXRpb24ucGF0aChwYXRoKTsgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHsgc3RUaWNrZXJTdmMuZXJyb3IoJ0ludmFsaWQgZW1haWwgYWRkcmVzcyBvciBwYXNzd29yZCB3YXMgZ2l2ZW4uJykgfVxyXG4gICAgICB9KTsgICAgICBcclxuICAgIH1cclxuICB9XHJcbiAgXHJcbiAgJHNjb3BlLnNpZ25vdXQgPSBmdW5jdGlvbigpIHtcclxuICAgIHN0QXV0aFN2Yy5sb2dvdXRVc2VyKCkudGhlbihmdW5jdGlvbigpIHtcclxuICAgICAgJHNjb3BlLnVzZXJuYW1lID0gXCJcIjtcclxuICAgICAgJHNjb3BlLnBhc3N3b3JkID0gXCJcIjtcclxuICAgICAgc3RUaWNrZXJTdmMubm90aWZ5KCdZb3UgaGF2ZSBiZWVuIHNpZ25lZCBvdXQuJyk7XHJcbiAgICAgICRsb2NhdGlvbi5wYXRoKCcvJyk7XHJcbiAgICB9KVxyXG4gIH1cclxufSk7IiwiYW5ndWxhci5tb2R1bGUoJ3N0YWdlJykuZGlyZWN0aXZlKCdzdExvZ2luV2lkZ2V0JywgZnVuY3Rpb24oKSB7XHJcbiAgcmV0dXJuIHtcclxuICAgIHJlc3RyaWN0OiAnRScsXHJcbiAgICByZXBsYWNlOiB0cnVlLFxyXG4gICAgdGVtcGxhdGVVcmw6ICcvcGFydGlhbHMvYWNjb3VudC92aWV3cy9sb2dpbi13aWRnZXQnXHJcbiAgfTtcclxufSk7IiwiYW5ndWxhci5tb2R1bGUoJ3N0YWdlJykuY29udHJvbGxlcignc3RQcm9maWxlQ3RybCcsIGZ1bmN0aW9uKCRzY29wZSwgc3RBdXRoU3ZjLCBzdElkZW50aXR5U3ZjLCBzdFRpY2tlclN2Yykge1xyXG4gICRzY29wZS5lbWFpbCA9IHN0SWRlbnRpdHlTdmMuY3VycmVudFVzZXIudXNlck5hbWU7XHJcbiAgJHNjb3BlLmZpcnN0TmFtZSA9IHN0SWRlbnRpdHlTdmMuY3VycmVudFVzZXIuZmlyc3ROYW1lO1xyXG4gICRzY29wZS5sYXN0TmFtZSA9IHN0SWRlbnRpdHlTdmMuY3VycmVudFVzZXIubGFzdE5hbWU7XHJcbiAgXHJcbiAgJHNjb3BlLnVwZGF0ZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgdmFyIG5ld1VzZXJEYXRhID0ge1xyXG4gICAgICB1c2VyTmFtZTogJHNjb3BlLmVtYWlsLFxyXG4gICAgICBmaXJzdE5hbWU6ICRzY29wZS5maXJzdE5hbWUsXHJcbiAgICAgIGxhc3ROYW1lOiAkc2NvcGUubGFzdE5hbWVcclxuICAgIH1cclxuXHJcbiAgICBpZigkc2NvcGUucGFzc3dvcmQgJiYgJHNjb3BlLnBhc3N3b3JkLmxlbmd0aCA+IDApIHsgbmV3VXNlckRhdGEucGFzc3dvcmQgPSAkc2NvcGUucGFzc3dvcmQ7IH1cclxuXHJcbiAgICBzdEF1dGhTdmMudXBkYXRlQ3VycmVudFVzZXIobmV3VXNlckRhdGEpLnRoZW4oXHJcbiAgICAgIGZ1bmN0aW9uKCkgeyBzdFRpY2tlclN2Yy5ub3RpZnkoJ1lvdXIgcHJvZmlsZSBoYXMgYmVlbiB1cGRhdGVkLicpIH0sIFxyXG4gICAgICBmdW5jdGlvbihyZWFzb24pIHsgc3RUaWNrZXJTdmMuZXJyb3IocmVhc29uKTsgfVxyXG4gICAgKTtcclxuICB9XHJcbn0pOyIsImFuZ3VsYXIubW9kdWxlKCdzdGFnZScpLmZhY3RvcnkoJ3N0VXNlclN2YycsIGZ1bmN0aW9uKCRyZXNvdXJjZSkge1xyXG4gIHZhciBVc2VyUmVzb3VyY2UgPSAkcmVzb3VyY2UoJy9hcGkvdXNlcnMvOmlkJywge19pZDogXCJAaWRcIn0sIHtcclxuICAgIHVwZGF0ZToge21ldGhvZDogJ1BVVCcsIGlzQXJyYXk6IGZhbHNlfSxcclxuICAgIHB1cmdlOiB7bWV0aG9kOiAnUFVSR0UnLCBpc0FycmF5OiBmYWxzZX1cclxuICB9KTtcclxuICBcclxuICBVc2VyUmVzb3VyY2UucHJvdG90eXBlLmlzQWRtaW4gPSBmdW5jdGlvbigpIHtcclxuICAgIHJldHVybiB0aGlzLnJvbGVzICYmIHRoaXMucm9sZXMuaW5kZXhPZignYWRtaW4nKSA+IC0xO1xyXG4gIH1cclxuICBcclxuICByZXR1cm4gVXNlclJlc291cmNlO1xyXG59KSIsImFuZ3VsYXIubW9kdWxlKCdzdGFnZScpLmNvbnRyb2xsZXIoJ3N0QWRtaW5DdHJsJywgZnVuY3Rpb24oJHNjb3BlLCAkdGltZW91dCwgc3RBZG1pblN2Yywgc3RBZG1pblVzZXJTdmMsIHN0QXV0aFN2Yywgc3RUaWNrZXJTdmMpIHtcclxuICAkc2NvcGUuZW52ID0gc3RBZG1pblN2Yy53aGF0RW52KCk7XHJcbiAgJHNjb3BlLnVzZXJzID0gc3RBZG1pblVzZXJTdmMucG9wdWxhdGVVc2VycygpO1xyXG4gICRzY29wZS51c2VyUmVzID0gJHNjb3BlLnVzZXJzO1xyXG4gICRzY29wZS51c2VyRmllbGQgPSAndXNlck5hbWUnO1xyXG4gICRzY29wZS51c2VyUmV2ZXJzZSA9IGZhbHNlO1xyXG4gICRzY29wZS51c2VyQ3VycmVudFBhZ2UgPSAwO1xyXG4gICRzY29wZS51c2VyU2hvd09uUGFnZSA9ICcxMCc7XHJcbiAgJHNjb3BlLnVzZXJTeW5jRW5hYmxlZCA9ICRzY29wZS5lbnYgPT0gJ2RldmVsb3BtZW50JyA/IHRydWUgOiBmYWxzZTtcclxuICAkc2NvcGUudXNlclN5bmNEaXIgPSAndG9sb2MnO1xyXG5cclxuICAkc2NvcGUuZmlsdGVyVXNlcnMgPSBmdW5jdGlvbigpIHtcclxuICAgICRzY29wZS51c2VyUmVzID0gW107XHJcbiAgICB2YXIgcmVzID0gc3RBZG1pblVzZXJTdmMuc2VhcmNoVXNlcnMoJHNjb3BlLnVzZXJzLCAkc2NvcGUudXNlclNlYXJjaCk7XHJcbiAgICAkc2NvcGUudXNlclJlcyA9IHJlcztcclxuICAgICRzY29wZS51c2VyQ3VycmVudFBhZ2UgPSAwO1xyXG4gIH1cclxuXHJcbiAgJHNjb3BlLnNvcnRVc2VycyA9IGZ1bmN0aW9uKGZpZWxkLCBpbnZlcnQpIHtcclxuICAgICRzY29wZS51c2VyUmV2ZXJzZSA9ICgkc2NvcGUudXNlckZpZWxkID09PSBmaWVsZCA/ICEkc2NvcGUudXNlclJldmVyc2UgOiBmYWxzZSk7XHJcbiAgICBpZihpbnZlcnQpIHsgJHNjb3BlLnVzZXJSZXZlcnNlID0gKCRzY29wZS51c2VyRmllbGQgPT09IGZpZWxkID8gJHNjb3BlLnVzZXJSZXZlcnNlIDogdHJ1ZSk7IH1cclxuICAgICRzY29wZS51c2VyRmllbGQgPSBmaWVsZDtcclxuICB9XHJcbiAgXHJcbiAgJHNjb3BlLmNyZWF0ZVVzZXIgPSBmdW5jdGlvbigpIHtcclxuICAgIHZhciBuZXdVc2VyRGF0YSA9IHtcclxuICAgICAgdXNlck5hbWU6ICRzY29wZS5lbWFpbCxcclxuICAgICAgcGFzc3dvcmQ6ICRzY29wZS5wYXNzd29yZCxcclxuICAgICAgZmlyc3ROYW1lOiAkc2NvcGUuZmlyc3ROYW1lLFxyXG4gICAgICBsYXN0TmFtZTogJHNjb3BlLmxhc3ROYW1lXHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICBzdEF1dGhTdmMuY3JlYXRlVXNlcihuZXdVc2VyRGF0YSkudGhlbihcclxuICAgICAgZnVuY3Rpb24oKSB7IHN0VGlja2VyU3ZjLm5vdGlmeSgnQ3JlYXRlZCB1c2VyIGFjY291bnQgJyArIG5ld1VzZXJEYXRhLnVzZXJOYW1lICsgICcuJyk7IHN0QWRtaW5TdmMuYWRtaW5SZWRpcmVjdCgnL2FkbWluJyk7IH0sIFxyXG4gICAgICBmdW5jdGlvbihyZWFzb24pIHsgc3RUaWNrZXJTdmMuZXJyb3IocmVhc29uKTsgfVxyXG4gICAgKTtcclxuICB9XHJcbiAgXHJcbiAgJHNjb3BlLnB1cmdlVXNlcnMgPSBmdW5jdGlvbigpIHtcclxuICAgIHN0QWRtaW5TdmMuYWRtaW5SZWRpcmVjdCgnL2FkbWluJyk7XHJcbiAgICBzdEFkbWluU3ZjLnVwZGF0ZVJvb3QoJ3VzZXJQdXJnZUluUHJvZ3Jlc3MnLCB0cnVlKTtcclxuICAgICR0aW1lb3V0KGZ1bmN0aW9uKCkge1xyXG4gICAgICBzdEF1dGhTdmMucHVyZ2VVc2VycygpLnRoZW4oXHJcbiAgICAgICAgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHN0QWRtaW5TdmMuYWRtaW5SZWRpcmVjdCgnLycpO1xyXG4gICAgICAgICAgICBzdEF1dGhTdmMubG9nb3V0VXNlcigpLnRoZW4oXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uKCkgeyAkdGltZW91dCgkc2NvcGUucHVyZ2VEb25lLCA1MDAwKTsgfSxcclxuICAgICAgICAgICAgZnVuY3Rpb24ocmVhc29uKSB7IFxyXG4gICAgICAgICAgICAgIHN0VGlja2VyU3ZjLmVycm9yKHJlYXNvbik7XHJcbiAgICAgICAgICAgICAgc3RBZG1pblN2Yy51cGRhdGVSb290KCd1c2VyUHVyZ2VJblByb2dyZXNzJywgZmFsc2UpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICApO1xyXG4gICAgICAgIH0sIFxyXG4gICAgICAgIGZ1bmN0aW9uKHJlYXNvbikgeyBzdFRpY2tlclN2Yy5lcnJvcihyZWFzb24pOyAkdGltZW91dCgkc2NvcGUucHVyZ2VEb25lLCA1MDAwKTsgfVxyXG4gICAgICApO1xyXG4gICAgfSwgNTAwMCk7XHJcbiAgfVxyXG4gIFxyXG4gICRzY29wZS5zeW5jRGIgPSBmdW5jdGlvbihjb2xsZWN0aW9uLCBzeW5jRGlyKSB7XHJcbiAgICBpZihjb2xsZWN0aW9uID09ICd1c2VycycpIHtcclxuICAgICAgc3RBZG1pblN2Yy5hZG1pblJlZGlyZWN0KCcvYWRtaW4nKTtcclxuICAgICAgc3RBZG1pblN2Yy51cGRhdGVSb290KCd1c2VyU3luY0luUHJvZ3Jlc3MnLCB0cnVlKTtcclxuICAgICAgc3RBdXRoU3ZjLnN5bmNVc2VycyhzeW5jRGlyKS50aGVuKFxyXG4gICAgICAgIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgaWYoc3luY0RpciA9PSAndG9sb2MnKSB7XHJcbiAgICAgICAgICAgIHN0QWRtaW5TdmMuYWRtaW5SZWRpcmVjdCgnLycpO1xyXG4gICAgICAgICAgICBzdEF1dGhTdmMubG9nb3V0VXNlcigpLnRoZW4oXHJcbiAgICAgICAgICAgICAgZnVuY3Rpb24oKSB7ICR0aW1lb3V0KCRzY29wZS5zeW5jRG9uZSwgNTAwMCk7IH0sXHJcbiAgICAgICAgICAgICAgZnVuY3Rpb24ocmVhc29uKSB7XHJcbiAgICAgICAgICAgICAgICBzdFRpY2tlclN2Yy5lcnJvcihyZWFzb24pO1xyXG4gICAgICAgICAgICAgICAgc3RBZG1pblN2Yy51cGRhdGVSb290KCd1c2VyU3luY0luUHJvZ3Jlc3MnLCB0cnVlKTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBlbHNlIHsgJHRpbWVvdXQoJHNjb3BlLnN5bmNEb25lLCA1MDAwKTsgfVxyXG4gICAgICAgfSxcclxuICAgICAgICBmdW5jdGlvbihyZWFzb24pIHsgc3RUaWNrZXJTdmMuZXJyb3IocmVhc29uKTsgJHRpbWVvdXQoJHNjb3BlLnN5bmNEb25lLCA1MDAwKTsgfVxyXG4gICAgICApO1xyXG4gICAgfVxyXG4gIH1cclxuICBcclxuICAkc2NvcGUucGFnZVVzZXJzID0gZnVuY3Rpb24oKSB7XHJcbiAgICByZXR1cm4gTWF0aC5jZWlsKCRzY29wZS51c2VyUmVzLmxlbmd0aC8kc2NvcGUudXNlclNob3dPblBhZ2UpO1xyXG4gIH1cclxuICBcclxuICAkc2NvcGUucHVyZ2VEb25lID0gZnVuY3Rpb24oKSB7XHJcbiAgICBzdFRpY2tlclN2Yy5ub3RpZnkoJ1VzZXIgZGF0YWJhc2UgaGFzIGJlZW4gcHVyZ2VkLicpOyBcclxuICAgIHN0QWRtaW5TdmMudXBkYXRlUm9vdCgndXNlclB1cmdlSW5Qcm9ncmVzcycsIGZhbHNlKTtcclxuICB9XHJcbiAgXHJcbiAgJHNjb3BlLnN5bmNEb25lID0gZnVuY3Rpb24oKSB7XHJcbiAgICBzdFRpY2tlclN2Yy5ub3RpZnkoJ1VzZXIgZGF0YWJhc2UgaGFzIGJlZW4gc3luY2VkLicpOyBcclxuICAgIHN0QWRtaW5TdmMudXBkYXRlUm9vdCgndXNlclN5bmNJblByb2dyZXNzJywgdHJ1ZSk7XHJcbiAgfVxyXG59KTsiLCJhbmd1bGFyLm1vZHVsZSgnc3RhZ2UnKS5mYWN0b3J5KCdzdEFkbWluU3ZjJywgZnVuY3Rpb24oJGxvY2F0aW9uLCAkcGFyc2UsICRyb290U2NvcGUsICR3aW5kb3cpIHtcclxuICByZXR1cm4ge1xyXG4gICAgYWRtaW5SZWRpcmVjdDogZnVuY3Rpb24ocGF0aCkge1xyXG4gICAgICAkbG9jYXRpb24ucGF0aChwYXRoKTtcclxuICAgIH0sXHJcbiAgICB1cGRhdGVSb290OiBmdW5jdGlvbihvYmosIHZhbCkge1xyXG4gICAgICB2YXIgcm9vdE9iaiA9ICRwYXJzZSgnJHJvb3RTY29wZS4nICsgb2JqKTtcclxuICAgICAgcm9vdE9iaiA9IHZhbDtcclxuICAgIH0sXHJcbiAgICB3aGF0RW52OiBmdW5jdGlvbigpIHtcclxuICAgICAgcmV0dXJuICR3aW5kb3cuZW52O1xyXG4gICAgfVxyXG4gIH07XHJcbn0pOyIsImFuZ3VsYXIubW9kdWxlKCdzdGFnZScpLmZhY3RvcnkoJ3N0QWRtaW5Vc2VyU3ZjJywgZnVuY3Rpb24oJGZpbHRlciwgc3RVc2VyU3ZjKSB7XHJcbiAgcmV0dXJuIHtcclxuICAgIGFjdGlvbkRvbmU6IGZ1bmN0aW9uKGFjdCkge1xyXG4gICAgICBzd2l0Y2goYWN0KSB7XHJcbiAgICAgICAgY2FzZSAncHVyZ2UnOlxyXG4gICAgICAgICAgdmFyIGFjdFZlcmIgPSAncHVyZ2VkJ1xyXG4gICAgICAgICAgJHJvb3RTY29wZS51c2VyUHVyZ2VJblByb2dyZXNzID0gZmFsc2U7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlICdzeW5jJzpcclxuICAgICAgICAgIHZhciBhY3RWZXJiID0gJ3N5bmNlZCdcclxuICAgICAgICAgICRyb290U2NvcGUudXNlclN5bmNJblByb2dyZXNzID0gZmFsc2U7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgfVxyXG4gICAgICBpZihhY3RWZXJiKSB7c3RUaWNrZXJTdmMubm90aWZ5KCdVc2VyIGRhdGFiYXNlIGhhcyBiZWVuICcgKyBhY3RWZXJiICsgJy4nKTsgfVxyXG4gICAgfSxcclxuICAgIHBvcHVsYXRlVXNlcnM6IGZ1bmN0aW9uKCkge1xyXG4gICAgICByZXR1cm4gc3RVc2VyU3ZjLnF1ZXJ5KCk7XHJcbiAgICB9LFxyXG4gICAgc2VhcmNoVXNlcnM6IGZ1bmN0aW9uKHVzZXJzLCBxdWVyeSkge1xyXG4gICAgICByZXR1cm4gJGZpbHRlcigndXNlcmZpbmQnKSh1c2VycywgcXVlcnkpO1xyXG4gICAgfVxyXG4gIH07XHJcbn0pOyIsImFuZ3VsYXIubW9kdWxlKCdzdGFnZScpLmZhY3RvcnkoJ3N0RGV2RGJBenVyZVN2YycsIGZ1bmN0aW9uKCkge1xyXG4gIHJldHVybiB7XHJcbiAgICAgIHZpZXc6ICdhenVyZVN0cmVhbScsXHJcbiAgICAgIHZpZXdUeXBlOiAndmlldycsXHJcbiAgICAgIHN0YXR1czogZmFsc2UsXHJcbiAgICAgIHN0cmVhbVdlbGw6ICcnLFxyXG4gICAgICBlbmRQb2ludDogJy9hcGkvZGV2ZGFzaC9henVyZVN0cmVhbS8nLFxyXG4gICAgICBldmVudFNvdXJjZTogZmFsc2UsXHJcbiAgICAgIGdldFN0cmVhbTogZnVuY3Rpb24oKSB7IHJldHVybiB0aGlzLnN0cmVhbVdlbGwgfVxyXG4gIH07XHJcbn0pOyIsImFuZ3VsYXIubW9kdWxlKCdzdGFnZScpLmNvbnRyb2xsZXIoJ3N0RGV2RGJDdHJsJywgZnVuY3Rpb24oJHNjb3BlLCAkaHR0cCwgJGludGVydmFsLCAkdGltZW91dCwgc3REZXZEYlN2Yykge1xyXG4gICRzY29wZS5jdXJyZW50U3ZjID0ge1xyXG4gICAgdmlldzogbnVsbCxcclxuICAgIHR5cGU6IG51bGwsXHJcbiAgICBzdHJlYW1XZWxsOiAnJ1xyXG4gIH1cclxuXHJcbiAgLypcclxuICAgIENvbnNpZGVyIHJlbW92aW5nIHRoZSBiZWxvdyBoZWFydGJlYXQgY29kZSBhcyBpdCBmbG9vZHMgdGhlIGRldmVsb3BlciBjb25zb2xlIG5ldHdvcmsgdGFiIGFuZCB0aGUgTm9kZS5KU1xyXG4gICAgbG9nIHdpbmRvdy4gUG9zc2libGUgdG8gdGllIGluIHRoZSBzZXJ2aWNlIHRvIHRoZSBldmVudCBzb3VyY2UgcG9seWZpbGwgdG8gZGV0ZWN0IHdoZW4gYW4gSFRUUCBjb2RlIG90aGVyXHJcbiAgICB0aGFuIDIwMCBoYXMgYmVlbiByZWNlaXZlZC5cclxuICAqL1xyXG5cclxuICAkc2NvcGUuc3ZjU3RhdHVzID0ge1xyXG4gICAgaGVhcnRCZWF0OiAkaW50ZXJ2YWwoZnVuY3Rpb24oKSB7XHJcbiAgICAgIHZhciBzdmNzID0gWydkZXZNb25nbycsICdjbG91ZE1vbmdvJywgJ2F6dXJlU3RyZWFtJ107XHJcbiAgICAgIHN2Y3MuZm9yRWFjaChmdW5jdGlvbihzdmMpIHtcclxuICAgICAgICBpZigkc2NvcGUuc3ZjU3RhdHVzW3N2Y10gIT09ICdlcnJvcicpIHtcclxuICAgICAgICAgIHN0RGV2RGJTdmMuY2hlY2tTdGF0dXMoc3ZjKS50aGVuKFxyXG4gICAgICAgICAgICBmdW5jdGlvbihzdGF0KSB7XHJcbiAgICAgICAgICAgICAgaWYoc3RhdC5jb2RlKSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuc3ZjU3RhdHVzW3N2Y10gPSAnZXJyb3InO1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0EgZmF0YWwgY29ubmVjdGlvbiBlcnJvciB0byAnICsgc3ZjICsgJyBoYXMgZGlzcnVwdGVkIGhlYXJ0YmVhdCBzZXJ2aWNlcycpO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICBlbHNlICRzY29wZS5zdmNTdGF0dXNbc3ZjXSA9IHN0YXQ7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uKGVycm9yKSB7IGNvbnNvbGUubG9nKGVycm9yKTsgfVxyXG4gICAgICAgICAgKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgfSwgNTAwKVxyXG4gIH1cclxuXHJcbiAgJHNjb3BlLmNoYW5nZVZpZXcgPSBmdW5jdGlvbihzdmMpIHtcclxuICAgIGlmKHN2YyA9PSAnb3ZlcnZpZXcnKSB7XHJcbiAgICAgICRzY29wZS5jdXJyZW50U3ZjLnZpZXcgPSBudWxsO1xyXG4gICAgICAkc2NvcGUuY3VycmVudFN2Yy50eXBlID0gbnVsbDtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAkc2NvcGUuY3VycmVudFN2Yy52aWV3ID0gc3ZjO1xyXG4gICAgICAkc2NvcGUuY3VycmVudFN2Yy50eXBlID0gc3REZXZEYlN2Yy5nZXRDb25zb2xlVHlwZShzdmMpO1xyXG4gICAgICAkc2NvcGUuY3VycmVudFN2Yy5zdHJlYW1XZWxsID0gc3REZXZEYlN2Yy5nZXRTdHJlYW1XZWxsKHN2Yyk7XHJcbiAgICAgIGlmKCEkc2NvcGUuc3ZjU3RhdHVzW3N2Y10pICRzY29wZS5jb25uZWN0U2VydmljZShzdmMpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLypcclxuICAgIEN1cnJlbnRseSBpZiBhIHN0cmVhbXdlbGwgaXMgdXBkYXRlZCBpbiB0aGUgYmFja2dyb3VuZCwgaXQgd2lsbCB1cGRhdGUgdGhlIHZpZXcgd2luZG93IHdpdGggdGhlIG5ldyBtZXNzYWdlXHJcbiAgICByZWdhcmRsZXNzIGlmIHRoYXQgdmlldyBpcyBhY3RpdmUgb3Igbm90LiBUaGlzIGlzIGVzcGVjaWFsbHkgc2VlbiB3aXRoIHRoZSBBenVyZSBsb2cgc3RyZWFtIGlmIHRoZSBjbG91ZFxyXG4gICAgc3RhZ2Ugc2l0ZSBpcyBhY2Nlc3NlZCBvciBoYXMgYmVlbiBpbmFjdGl2ZSBmb3IgNjAgc2Vjb25kcyBhbmQgdGhlIGxvZyBzdHJlYW0gc2VydmljZSBsb2dzIGluYWN0aXZpdHkuXHJcbiAgKi9cclxuXHJcbiAgJHNjb3BlLmNvbm5lY3RTZXJ2aWNlID0gZnVuY3Rpb24oc3ZjKSB7XHJcbiAgICBjb25zb2xlLmxvZygnQ29ubmVjdGluZyBzZXJ2aWNlICcgKyBzdmMpO1xyXG4gICAgc3REZXZEYlN2Yy5jb25uZWN0U2VydmljZShzdmMpLnRoZW4oXHJcbiAgICAgIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGlmKHR5cGVvZihFdmVudFNvdXJjZSkgIT09ICd1bmRlZmluZWQnKSB7XHJcbiAgICAgICAgICAkc2NvcGUuY3VycmVudFN2Yy5zdHJlYW1XZWxsID0gc3REZXZEYlN2Yy5jdXJyZW50U3ZjLmdldFN0cmVhbSgpO1xyXG4gICAgICAgICAgc3REZXZEYlN2Yy5jdXJyZW50U3ZjLmV2ZW50U291cmNlID0gbmV3IEV2ZW50U291cmNlKHN0RGV2RGJTdmMuY3VycmVudFN2Yy5lbmRQb2ludCArICdzdHJlYW0nKTtcclxuICAgICAgICAgIHN0RGV2RGJTdmMuY3VycmVudFN2Yy5ldmVudFNvdXJjZS5hZGRFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICAgICAgJHNjb3BlLiRhcHBseShmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAkc2NvcGUuY3VycmVudFN2Yy5zdHJlYW1XZWxsID0gc3REZXZEYlN2Yy51cGRhdGVTdHJlYW1XZWxsKGV2ZW50LmRhdGEpO1xyXG4gICAgICAgICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHN3ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3N0cmVhbVdlbGwnKTtcclxuICAgICAgICAgICAgICAgIHN3LnNjcm9sbFRvcCA9IHN3LnNjcm9sbEhlaWdodDtcclxuXHJcbiAgICAgICAgICAgICAgfSwgNTApO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgIH0sIGZhbHNlKTtcclxuICAgICAgICAgIHN0RGV2RGJTdmMuY3VycmVudFN2Yy5ldmVudFNvdXJjZS5hZGRFdmVudExpc3RlbmVyKCdlcnJvcicsIGZ1bmN0aW9uKGVycikge1xyXG4gICAgICAgICAgICAkc2NvcGUuJGFwcGx5KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICRzY29wZS5kZGJEaXNjb25uZWN0KHN2Yyk7XHJcbiAgICAgICAgICAgICAgJHNjb3BlLmN1cnJlbnRTdmMuc3RyZWFtV2VsbCArPSAnVGhlIHN0cmVhbSBmb3IgJyArIHN2YyArICcgaGFzIGJlZW4gdW5leHBlY3RlZGx5IGNsb3NlZC5cXG4nO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgc3REZXZEYlN2Yy5jdXJyZW50U3ZjLmV2ZW50U291cmNlLmNsb3NlKCk7XHJcbiAgICAgICAgICB9LCBmYWxzZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgJHNjb3BlLmN1cnJlbnRTdmMuc3RyZWFtV2VsbCA9ICdUaGlzIGJyb3dzZXIgZG9lcyBub3Qgc3VwcG9ydCBzdHJlYW1pbmcuXFxuJztcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLy8gUmVzdHJ1Y3R1cmUgbmVlZGVkXHJcbiAgJHNjb3BlLmRkYkNvbW1hbmQgPSBmdW5jdGlvbigpIHtcclxuICAgIHZhciBzdmMgPSAkc2NvcGUuY3VycmVudFN2Yy52aWV3O1xyXG4gICAgY29uc29sZS5sb2coc3ZjKTtcclxuICAgIGlmKCRzY29wZS5jdXJyZW50U3ZjLnR5cGUgIT09ICdjbWQnKSByZXR1cm4gZmFsc2U7XHJcbiAgICBlbHNlIHtcclxuICAgICAgY29uc29sZS5sb2coJ1R5cGUgaXMgY21kJyk7XHJcbiAgICAgIGNvbnNvbGUubG9nKCRzY29wZS5kZGJDbWRCYXIpO1xyXG4gICAgICBjb25zb2xlLmxvZygkc2NvcGUuY2hlY2tTdGF0dXMoc3ZjKSk7XHJcbiAgICAgIHZhciBzdmNTdGF0ID0gZmFsc2VcclxuICAgICAgc3dpdGNoKHN2Yykge1xyXG4gICAgICAgIGNhc2UgJ2xvY2FsTW9uZ28nOlxyXG4gICAgICAgICAgc3ZjU3RhdCA9ICRzY29wZS5sb2NhbE1vbmdvU3RhdHVzO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSAncmVtb3RlTW9uZ28nOlxyXG4gICAgICAgICAgc3ZjU3RhdCA9ICRzY29wZS5yZW1vdGVNb25nb1N0YXR1cztcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcbiAgICAgIGlmKHN2Y1N0YXQgJiYgJHNjb3BlLmRkYkNtZEJhcikge1xyXG4gICAgICAgICRodHRwLnBvc3QoJy9hcGkvZGV2ZGFzaC8nICsgc3ZjICsgJy9jb21tYW5kJywge2NtZDogJHNjb3BlLmRkYkNtZEJhcn0pLnRoZW4oZnVuY3Rpb24ocmVzKSB7XHJcbiAgICAgICAgICAkc2NvcGUuZGRiQ21kQmFyID0gJyc7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLyAkc2NvcGUuZGRiQ29ubmVjdCA9IGZ1bmN0aW9uKHN2Yykge1xyXG4gIC8vICAgJGh0dHAuZ2V0KCcvYXBpL2RldmRhc2gvJyArIHN2YyArICcvY29ubmVjdCcsIHtjaGVjazogdHJ1ZX0pLnRoZW4oZnVuY3Rpb24oKSB7XHJcbiAgLy8gICAgIGlmKHN2YyA9PSAnbG9jYWxNb25nbycpIHtcclxuICAvLyAgICAgICAkc2NvcGUuY3VycmVudFN2Yy5zdHJlYW1XZWxsICs9ICdkb25lIVxcbic7XHJcbiAgLy8gICAgICAgJHNjb3BlLmxvY2FsTW9uZ29TdGF0dXMgPSB0cnVlO1xyXG4gIC8vICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uKCkgeyRzY29wZS5kZGJTdHJlYW0oc3ZjKTt9LCA1MDApO1xyXG4gIC8vICAgICB9XHJcbiAgLy8gICAgIGVsc2UgaWYoc3ZjID09ICdyZW1vdGVNb25nbycpIHtcclxuICAvLyAgICAgICAkc2NvcGUuY3VycmVudFN2Yy5zdHJlYW1XZWxsICs9ICdkb25lIVxcbic7XHJcbiAgLy8gICAgICAgJHNjb3BlLnJlbW90ZU1vbmdvU3RhdHVzID0gdHJ1ZTtcclxuICAvLyAgICAgICAkdGltZW91dChmdW5jdGlvbigpIHskc2NvcGUuZGRiU3RyZWFtKHN2Yyk7fSwgNTAwKTtcclxuICAvLyAgICAgfVxyXG4gIC8vICAgICBlbHNlIGlmKHN2YyA9PSAnYXp1cmVTdHJlYW0nKSB7XHJcbiAgLy8gICAgICAgJHNjb3BlLmN1cnJlbnRTdmMuc3RyZWFtV2VsbCArPSAnZG9uZSFcXG4nO1xyXG4gIC8vICAgICAgICRzY29wZS5henVyZVN0cmVhbVN0YXR1cyA9IHRydWU7XHJcbiAgLy8gICAgICAgJHRpbWVvdXQoZnVuY3Rpb24oKSB7JHNjb3BlLmRkYlN0cmVhbShzdmMpO30sIDUwMCk7XHJcbiAgLy8gICAgIH1cclxuICAvLyAgIH0pO1xyXG4gIC8vIH1cclxuXHJcbiAgLy8gUmVzdHJ1Y3R1cmUgbmVlZGVkXHJcbiAgJHNjb3BlLmRkYkRpc2Nvbm5lY3QgPSBmdW5jdGlvbihzdmMpIHtcclxuICAgIC8vICRodHRwLmdldCgnL2FwaS9kZXZkYXNoLycgKyBzdmMgKyAnL2Rpc2Nvbm5lY3QnLCB7Y2hlY2s6IHRydWV9KS50aGVuKGZ1bmN0aW9uKCkge1xyXG4gICAgICBpZihzdmMgPT0gJ2xvY2FsTW9uZ28nKSAkc2NvcGUubG9jYWxNb25nb1N0YXR1cyA9IGZhbHNlO1xyXG4gICAgICBlbHNlIGlmKHN2YyA9PSAncmVtb3RlTW9uZ28nKSAkc2NvcGUucmVtb3RlTW9uZ29TdGF0dXMgPSBmYWxzZTtcclxuICAgICAgZWxzZSBpZihzdmMgPT0gJ2F6dXJlU3RyZWFtJykgJHNjb3BlLmF6dXJlU3RyZWFtU3RhdHVzID0gZmFsc2U7XHJcbiAgICAvLyB9KTtcclxuICB9XHJcblxyXG4gICRzY29wZS5jaGVja1N0YXR1cyA9IGZ1bmN0aW9uKHN2YykgeyByZXR1cm4gc3REZXZEYlN2Yy5jaGVja1N0YXR1cyhzdmMpOyB9XHJcblxyXG4gIC8vIFJlc3RydWN0dXJlIG5lZWRlZFxyXG4gICRzY29wZS5kZGJTdHJlYW0gPSBmdW5jdGlvbihzdmMpIHtcclxuICAgIGlmKHR5cGVvZihFdmVudFNvdXJjZSkgIT09ICd1bmRlZmluZWQnKSB7XHJcbiAgICAgIHZhciBzdHJtU291cmNlID0gbmV3IEV2ZW50U291cmNlKCcvYXBpL2RldmRhc2gvJyArIHN2YyArICcvc3RyZWFtJyk7XHJcbiAgICAgIHN0cm1Tb3VyY2UuYWRkRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgJHNjb3BlLiRhcHBseShmdW5jdGlvbigpIHtcclxuICAgICAgICAgIHZhciBtc2cgPSBKU09OLnBhcnNlKGV2ZW50LmRhdGEpO1xyXG4gICAgICAgICAgLy8gUmVwbGFjZSBzcGVjaWFsIGNoYXJhY3RlcnNcclxuICAgICAgICAgIG1zZyA9IG1zZy5yZXBsYWNlKC9cXFswbS9nLCAnJyk7XHJcbiAgICAgICAgICBtc2cgPSBtc2cucmVwbGFjZSgvXFxbMzZtL2csICcnKTtcclxuICAgICAgICAgIC8vIFN0cmlwIG91dCBVbmljb2RlIGNoYXJhY3RlcnMgXHJcbiAgICAgICAgICBtc2cgPSB1bmVzY2FwZShlbmNvZGVVUklDb21wb25lbnQobXNnKSk7XHJcbiAgICAgICAgICBjb25zb2xlLmxvZyhtc2cpO1xyXG4gICAgICAgICAgJHNjb3BlLmN1cnJlbnRTdmMuc3RyZWFtV2VsbCArPSBtc2cudHJpbSgpICsgJ1xcbic7XHJcbiAgICAgICAgICAkdGltZW91dChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdmFyIHN3ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3N0cmVhbVdlbGwnKTtcclxuICAgICAgICAgICAgc3cuc2Nyb2xsVG9wID0gc3cuc2Nyb2xsSGVpZ2h0O1xyXG4gICAgICAgICAgfSwgNTApO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9LCBmYWxzZSk7XHJcbiAgICAgIHN0cm1Tb3VyY2UuYWRkRXZlbnRMaXN0ZW5lcignZXJyb3InLCBmdW5jdGlvbihlcnIpIHtcclxuICAgICAgICAkc2NvcGUuJGFwcGx5KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgJHNjb3BlLmRkYkRpc2Nvbm5lY3Qoc3ZjKTtcclxuICAgICAgICAgICRzY29wZS5jdXJyZW50U3ZjLnN0cmVhbVdlbGwgKz0gJ1RoZSBzdHJlYW0gZm9yICcgKyBzdmMgKyAnIGhhcyBiZWVuIHVuZXhwZWN0ZWRseSBjbG9zZWQuXFxuJztcclxuICAgICAgICB9KTtcclxuICAgICAgICBzdHJtU291cmNlLmNsb3NlKCk7XHJcbiAgICAgIH0sIGZhbHNlKTtcclxuICAgIH1cclxuICAgIGVsc2UgJHNjb3BlLmN1cnJlbnRTdmMuc3RyZWFtV2VsbCA9ICdUaGlzIGJyb3dzZXIgZG9lcyBub3Qgc3VwcG9ydCBzdHJlYW1pbmcuXFxuJztcclxuICB9XHJcbn0pOyIsImFuZ3VsYXIubW9kdWxlKCdzdGFnZScpLmZhY3RvcnkoJ3N0RGV2RGJNb25nb1N2YycsIGZ1bmN0aW9uKCkge1xyXG4gIHJldHVybiB7XHJcbiAgICBjbG91ZDoge1xyXG4gICAgICB2aWV3OiAnY2xvdWRNb25nbycsXHJcbiAgICAgIHN0YXR1czogZmFsc2UsXHJcbiAgICAgIHN0cmVhbVdlbGw6ICcnLFxyXG4gICAgICBlbmRQb2ludDogJy9hcGkvZGV2ZGFzaC9yZW1vdGVNb25nby8nLFxyXG4gICAgICB2aWV3VHlwZTogJ2NtZCcsXHJcbiAgICAgIGV2ZW50U291cmNlOiBmYWxzZSxcclxuICAgICAgZ2V0U3RyZWFtOiBmdW5jdGlvbigpIHsgcmV0dXJuIHRoaXMuc3RyZWFtV2VsbCB9XHJcbiAgICB9LFxyXG4gICAgZGV2OiB7XHJcbiAgICAgIHZpZXc6ICdkZXZNb25nbycsXHJcbiAgICAgIHN0YXR1czogZmFsc2UsXHJcbiAgICAgIHN0cmVhbVdlbGw6ICcnLFxyXG4gICAgICBlbmRQb2ludDogJy9hcGkvZGV2ZGFzaC9sb2NhbE1vbmdvLycsXHJcbiAgICAgIHZpZXdUeXBlOiAnY21kJyxcclxuICAgICAgZXZlbnRTb3VyY2U6IGZhbHNlLFxyXG4gICAgICBnZXRTdHJlYW06IGZ1bmN0aW9uKCkgeyByZXR1cm4gdGhpcy5zdHJlYW1XZWxsIH1cclxuICAgIH0sXHJcbiAgfTtcclxufSk7IiwiYW5ndWxhci5tb2R1bGUoJ3N0YWdlJykuZmFjdG9yeSgnc3REZXZEYlN2YycsIGZ1bmN0aW9uKCRodHRwLCAkaW50ZXJ2YWwsICRxLCBzdERldkRiQXp1cmVTdmMsIHN0RGV2RGJNb25nb1N2Yykge1xyXG4gIHJldHVybiB7XHJcbiAgICBjdXJyZW50U3ZjOiBudWxsLFxyXG4gICAgc3ZjTGlzdDogeyBcclxuICAgICAgY2xvdWRNb25nbzogc3REZXZEYk1vbmdvU3ZjLmNsb3VkLFxyXG4gICAgICBkZXZNb25nbzogc3REZXZEYk1vbmdvU3ZjLmRldixcclxuICAgICAgYXp1cmVTdHJlYW06IHN0RGV2RGJBenVyZVN2Y1xyXG4gICAgfSxcclxuXHJcbiAgICBzZW5kUmVxdWVzdDogZnVuY3Rpb24obWV0aG9kLCB1cmwsIHN1Y2Nlc3NDYWxsYmFjaywgZXJyb3JDYWxsYmFjaywgc3ZjLCBkYXRhKSB7XHJcbiAgICAgIHN2YyA9IHN2YyA/IHRoaXMuc3ZjTGlzdFtzdmNdIDogZmFsc2VcclxuICAgICAgZGF0YSA9IGRhdGEgPyBkYXRhIDoge31cclxuICAgICAgcmV0dXJuICRodHRwKHtcclxuICAgICAgICBtZXRob2Q6IG1ldGhvZCxcclxuICAgICAgICB1cmw6IChzdmMgPyBzdmMuZW5kUG9pbnQgOiBjdXJyZW50U3ZjLmVuZFBvaW50KSArIHVybCxcclxuICAgICAgICBkYXRhOiBkYXRhXHJcbiAgICAgIH0pLnRoZW4oc3VjY2Vzc0NhbGxiYWNrLCBlcnJvckNhbGxiYWNrKTtcclxuICAgIH0sXHJcblxyXG4gICAgY2hlY2tTdGF0dXM6IGZ1bmN0aW9uKHN2Yykge1xyXG4gICAgICBpZighc3ZjICYmIHRoaXMuY3VycmVudFN2YyA9PSBudWxsKSByZXR1cm4gZmFsc2U7XHJcbiAgICAgIHJldHVybiB0aGlzLnNlbmRSZXF1ZXN0KCdHRVQnLCAnc3RhdHVzJywgXHJcbiAgICAgICAgLy8gU3VjY2VzcyBjYWxsYmFja1xyXG4gICAgICAgIGZ1bmN0aW9uKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgICBpZihyZXNwb25zZS5kYXRhLnJlc3BvbnNlID09ICdDb25uZWN0ZWQnICYmIHJlc3BvbnNlLnN0YXR1cyA9PSAyMDApIHsgcmV0dXJuIHRydWU7IH1cclxuICAgICAgICAgIGVsc2UgaWYocmVzcG9uc2Uuc3RhdHVzICE9PSAyMDApIHJldHVybiB7IGVycm9yOiByZXNwb25zZS5zdGF0dXMgfTtcclxuICAgICAgICAgIGVsc2UgeyByZXR1cm4gZmFsc2U7IH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIC8vIEVycm9yIGNhbGxiYWNrXHJcbiAgICAgICAgZnVuY3Rpb24ocmVzcG9uc2UpIHsgcmV0dXJuIHsgZXJyb3I6IHJlc3BvbnNlLnN0YXR1cyB9OyB9LFxyXG4gICAgICAgIC8vIFBhc3Mgc3BlY2lmaWMgc2VydmljZSBpZiBuZWVkZWRcclxuICAgICAgICAoc3ZjID8gc3ZjIDogZmFsc2UpXHJcbiAgICAgICkudGhlbihcclxuICAgICAgICAvLyBTdWNjZXNzIGNhbGxiYWNrXHJcbiAgICAgICAgZnVuY3Rpb24ocmVzcG9uc2UpIHtcclxuICAgICAgICAgIGlmKCFyZXNwb25zZVsnZXJyb3InXSkge1xyXG4gICAgICAgICAgICBpZihyZXNwb25zZSkge1xyXG4gICAgICAgICAgICAgIGlmKCFzdmMpIHRoaXMuY3VycmVudFN2Yy5zdGF0dXMgPSB0cnVlO1xyXG4gICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgIGlmKCFzdmMpIHRoaXMuY3VycmVudFN2Yy5zdGF0dXMgPSBmYWxzZTtcclxuICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBpZighc3ZjKSB0aGlzLmN1cnJlbnRTdmMuc3RhdHVzID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHJldHVybiB7IGNvZGU6IHJlc3BvbnNlLmVycm9yLCBtc2c6ICdGYWlsZWQgdG8gY29ubmVjdCB0byBzZXJ2aWNlOiBVbmV4cGVjdGVkIHJlc3BvbnNlJyB9O1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgLy8gRXJyb3IgY2FsbGJhY2tcclxuICAgICAgICBmdW5jdGlvbihyZXNwb25zZSkge1xyXG4gICAgICAgICAgaWYoIXN2YykgdGhpcy5jdXJyZW50U3ZjLnN0YXR1cyA9IGZhbHNlO1xyXG4gICAgICAgICAgcmV0dXJuIHsgY29kZTogcmVzcG9uc2UuZXJyb3IsIG1zZzogJ0ZhaWxlZCB0byBjb25uZWN0IHRvIHNlcnZpY2U6IFVuZXhwZWN0ZWQgcmVzcG9uc2UnIH07XHJcbiAgICAgICAgfVxyXG4gICAgICApO1xyXG4gICAgfSxcclxuXHJcbiAgICBjb25uZWN0U2VydmljZTogZnVuY3Rpb24oc3ZjKSB7XHJcbiAgICAgIHRoaXMuY3VycmVudFN2YyA9IHRoaXMuc3ZjTGlzdFtzdmNdO1xyXG4gICAgICBjdXJyZW50U3ZjID0gdGhpcy5jdXJyZW50U3ZjO1xyXG4gICAgICByZXR1cm4gdGhpcy5zZW5kUmVxdWVzdCgnR0VUJywgJ2Nvbm5lY3QnLFxyXG4gICAgICAgIC8vIFN1Y2Nlc3MgY2FsbGJhY2tcclxuICAgICAgICBmdW5jdGlvbihyZXNwb25zZSkge1xyXG4gICAgICAgICAgaWYocmVzcG9uc2UuZGF0YS5yZXNwb25zZSA9PSAnQ29ubmVjdGVkJyAmJiByZXNwb25zZS5zdGF0dXMgPT0gMjAwKSB7IHJldHVybiB0cnVlOyB9XHJcbiAgICAgICAgICBlbHNlIHsgcmV0dXJuIGZhbHNlOyB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICAvLyBFcnJvciBjYWxsYmFja1xyXG4gICAgICAgIGZ1bmN0aW9uKHJlc3BvbnNlKSB7IHJldHVybiB7ZXJyb3I6IHJlc3BvbnNlLnN0YXR1c307IH0sXHJcbiAgICAgICAgLy8gUGFzcyBzZXJ2aWNlXHJcbiAgICAgICAgc3ZjXHJcbiAgICAgICkudGhlbihcclxuICAgICAgICAvLyBTdWNjZXNzIGNhbGxiYWNrXHJcbiAgICAgICAgZnVuY3Rpb24ocmVzcG9uc2UpIHtcclxuICAgICAgICAgIGlmKCFyZXNwb25zZVsnZXJyb3InXSkgeyB0aGlzLmN1cnJlbnRTdmMuc3RhdHVzID0gdHJ1ZTsgfVxyXG4gICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuY3VycmVudFN2Yy5zdGF0dXMgPSBmYWxzZTtcclxuICAgICAgICAgICAgdGhyb3cgeyBjb2RlOiByZXNwb25zZS5zdGF0dXMsIG1zZzogJ0ZhaWxlZCB0byBjb25uZWN0IHRvIHNlcnZpY2U6IFVuZXhwZWN0ZWQgcmVzcG9uc2UnIH07XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICAvLyBFcnJvciBjYWxsYmFja1xyXG4gICAgICAgIGZ1bmN0aW9uKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgICB0aGlzLmN1cnJlbnRTdmMuc3RhdHVzID0gZmFsc2U7XHJcbiAgICAgICAgICB0aHJvdyB7IGNvZGU6IHJlc3BvbnNlLnN0YXR1cywgbXNnOiAnRmFpbGVkIHRvIGNvbm5lY3QgdG8gc2VydmljZTogVW5leHBlY3RlZCByZXNwb25zZScgfTtcclxuICAgICAgICB9XHJcbiAgICAgICk7XHJcbiAgICB9LFxyXG5cclxuICAgIGdldENvbnNvbGVUeXBlOiBmdW5jdGlvbihzdmMpIHtcclxuICAgICAgcmV0dXJuIHRoaXMuc3ZjTGlzdFtzdmNdLnZpZXdUeXBlO1xyXG4gICAgfSxcclxuXHJcbiAgICBnZXRTdHJlYW1XZWxsOiBmdW5jdGlvbihzdmMpIHtcclxuICAgICAgcmV0dXJuIHRoaXMuc3ZjTGlzdFtzdmNdLnN0cmVhbVdlbGw7XHJcbiAgICB9LFxyXG5cclxuICAgIHVwZGF0ZVN0cmVhbVdlbGw6IGZ1bmN0aW9uKHJhd21zZykge1xyXG4gICAgICB2YXIgbXNnID0gSlNPTi5wYXJzZShyYXdtc2cpO1xyXG4gICAgICAvLyBSZXBsYWNlIHNwZWNpYWwgY2hhcmFjdGVyc1xyXG4gICAgICBtc2cgPSBtc2cucmVwbGFjZSgvXFxbMG0vZywgJycpO1xyXG4gICAgICBtc2cgPSBtc2cucmVwbGFjZSgvXFxbMzZtL2csICcnKTtcclxuICAgICAgLy8gU3RyaXAgb3V0IFVuaWNvZGUgY2hhcmFjdGVycyBcclxuICAgICAgbXNnID0gdW5lc2NhcGUoZW5jb2RlVVJJQ29tcG9uZW50KG1zZykpO1xyXG4gICAgICB0aGlzLmN1cnJlbnRTdmMuc3RyZWFtV2VsbCArPSBtc2cudHJpbSgpICsgJ1xcbic7XHJcbiAgICAgIGNvbnNvbGUubG9nKFwiREJHOiBcIiArIHRoaXMuY3VycmVudFN2Yy5zdHJlYW1XZWxsKTtcclxuICAgICAgcmV0dXJuIHRoaXMuY3VycmVudFN2Yy5zdHJlYW1XZWxsO1xyXG4gICAgfVxyXG4gIH07XHJcbn0pO1xyXG5cclxuXHJcblxyXG4iLCJhbmd1bGFyLm1vZHVsZSgnc3RhZ2UnKS5maWx0ZXIoJ3VzZXJTdGFydFBhZ2UnLCBmdW5jdGlvbigpIHtcclxuICAgIHJldHVybiBmdW5jdGlvbihpbnB1dCwgc3RhcnQpIHtcclxuICAgICAgICBzdGFydCA9ICtzdGFydDtcclxuICAgICAgICByZXR1cm4gaW5wdXQuc2xpY2Uoc3RhcnQpO1xyXG4gICAgfVxyXG59KTsiLCJhbmd1bGFyLm1vZHVsZSgnc3RhZ2UnKS5maWx0ZXIoJ3VzZXJmaW5kJywgZnVuY3Rpb24oKSB7XHJcbiAgcmV0dXJuIGZ1bmN0aW9uKHVzZXJzLCBxKSB7XHJcbiAgICB2YXIgbWF0Y2hlZCA9IFtdO1xyXG4gICAgYW5ndWxhci5mb3JFYWNoKHVzZXJzLCBmdW5jdGlvbih1KSB7XHJcbiAgICAgIHRyeSB7IHZhciBleHAgPSBuZXcgUmVnRXhwKHEsICdnaScpOyB9IGNhdGNoKGUpIHsgcmV0dXJuIFtdOyB9XHJcbiAgICAgIGlmKHUudXNlck5hbWUubWF0Y2goZXhwKSB8fCB1LmZpcnN0TmFtZS5tYXRjaChleHApIHx8IHUubGFzdE5hbWUubWF0Y2goZXhwKSB8fCBxID09ICcnKSB7XHJcbiAgICAgICAgbWF0Y2hlZC5wdXNoKHtcclxuICAgICAgICAgIF9pZDogdS5faWQsIFxyXG4gICAgICAgICAgdXNlck5hbWU6IHUudXNlck5hbWUsIFxyXG4gICAgICAgICAgZmlyc3ROYW1lOiB1LmZpcnN0TmFtZSwgXHJcbiAgICAgICAgICBsYXN0TmFtZTogdS5sYXN0TmFtZSxcclxuICAgICAgICAgIHJvbGVzOiB1LnJvbGVzXHJcbiAgICAgICAgfSlcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gbWF0Y2hlZDtcclxuICB9XHJcbn0pOyIsImFuZ3VsYXIubW9kdWxlKCdzdGFnZScpLmNvbnRyb2xsZXIoJ3N0TWFpbkN0cmwnLCBmdW5jdGlvbigkc2NvcGUpIHtcclxuXHJcbn0pOyIsImFuZ3VsYXIubW9kdWxlKCdzdGFnZScpLmNvbnRyb2xsZXIoJ3N0VGlja2VyQ3RybCcsIFsnJHNjb3BlJywgJ3N0VGlja2VyU3ZjJywgZnVuY3Rpb24oJHNjb3BlLCBzdFRpY2tlclN2Yykge1xyXG4gICRzY29wZS5jdXN0b20gPSBzdFRpY2tlclN2Yy5jdXN0b20oKTtcclxuICAkc2NvcGUucmVzZXQgPSBzdFRpY2tlclN2Yy5yZXNldCgpO1xyXG4gICRzY29wZS5zaG93QWxsID0gZnVuY3Rpb24oKSB7ICQoJy50aWNrZXItY29udGFpbmVyJykudG9nZ2xlQ2xhc3MoJ2V4cGFuZGVkJyk7IH1cclxufV0pOyIsImFuZ3VsYXIubW9kdWxlKCdzdGFnZScpLmZhY3RvcnkoJ3N0VGlja2VyU3ZjJywgZnVuY3Rpb24oKSB7XHJcbiAgdmFyIGZ0ciA9ICcvL3RhcmRpZ3JhZGUvbm9kZSB8IFRhcmRpZ3JhZGUgRGlnaXRhbCAmY29weTsgMjAxNic7XHJcbiAgdmFyIHRvc2V0ID0gZmFsc2U7XHJcbiAgdmFyIHRvID0gbnVsbDtcclxuICBcclxuICBmdW5jdGlvbiBhZGRUaWNrZXIobXNnLCBsdmwsIGljKSB7XHJcbiAgICBtc2cgPSBsdmwgPyAoJyAnICsgbXNnKSA6IG1zZztcclxuICAgIHZhciBtc2dvYmogPSAkKCc8c3Bhbj48L3NwYW4+JykuYWRkQ2xhc3MoJ3RpY2tlci1tc2cnKS5odG1sKG1zZyk7XHJcbiAgICBpZihpYykgeyBcclxuICAgICAgaWMgPSAkKCc8c3Bhbj48L3NwYW4+JykuYWRkQ2xhc3MoJ2ljb25pYyBpY29uaWMtc20gJyArIGljKTsgXHJcbiAgICAgIG1zZ29iai5wcmVwZW5kKGljKTsgXHJcbiAgICB9XHJcbiAgICBpZihsdmwpIHsgbXNnb2JqLmFkZENsYXNzKGx2bCk7IH1cclxuICAgICQoJyN0aWNrZXInKS5hZGRDbGFzcygnb24nKS5wcmVwZW5kKG1zZ29iaik7XHJcbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkgeyQoJyN0aWNrZXInKS5yZW1vdmVDbGFzcygnb24nKTt9LCAzMDApO1xyXG4gICAgaWYoIXRvc2V0KSB7IHRvc2V0ID0gdHJ1ZTsgdG8gPSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkgeyByZXNldFRpY2tlcigpOyB0b3NldCA9IGZhbHNlOyB9LCA4MDAwKTsgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgIGNsZWFyVGltZW91dCh0byk7XHJcbiAgICAgIHRvID0gc2V0VGltZW91dChmdW5jdGlvbigpIHsgcmVzZXRUaWNrZXIoKTsgdG9zZXQgPSBmYWxzZTsgfSwgODAwMCk7XHJcbiAgICB9XHJcbiAgfVxyXG4gIFxyXG4gIGZ1bmN0aW9uIHJlc2V0VGlja2VyKCkge1xyXG4gICAgJCgnI3RpY2tlciAjZnRybXNnJykucmVtb3ZlKCk7XHJcbiAgICB2YXIgbXNnb2JqID0gJCgnPHNwYW4+PC9zcGFuPicpLmh0bWwoZnRyKS5hdHRyKCdpZCcsICdmdHJtc2cnKTtcclxuICAgICQoJyN0aWNrZXInKS5hZGRDbGFzcygnb24nKS5wcmVwZW5kKG1zZ29iaik7XHJcbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkgeyQoJyN0aWNrZXInKS5yZW1vdmVDbGFzcygnb24nKTt9LCAzMDApO1xyXG4gIH1cclxuICBcclxuICByZXR1cm4ge1xyXG4gICAgY3VzdG9tOiBmdW5jdGlvbihtc2csIGx2bCwgaWMpIHsgaWYoIW1zZykgeyByZXR1cm4gZmFsc2U7IH07IGFkZFRpY2tlcihtc2csIGx2bCwgKCdpY29uaWMtJyArIGljKSk7IH0sXHJcbiAgICBub3RpZnk6IGZ1bmN0aW9uKG1zZykgeyBpZighbXNnKSB7IHJldHVybiBmYWxzZTsgfTsgYWRkVGlja2VyKG1zZywgJ3N1Y2Nlc3MnLCAnaWNvbmljLWNpcmNsZS1jaGVjaycpOyB9LFxyXG4gICAgZXJyb3I6IGZ1bmN0aW9uKG1zZykgeyBpZighbXNnKSB7IHJldHVybiBmYWxzZTsgfTsgYWRkVGlja2VyKG1zZywgJ2Vycm9yJywgJ2ljb25pYy1jaXJjbGUteCcpOyB9LFxyXG4gICAgaW5mbzogZnVuY3Rpb24obXNnKSB7IGlmKCFtc2cpIHsgcmV0dXJuIGZhbHNlOyB9OyBhZGRUaWNrZXIobXNnLCBudWxsLCAnaWNvbmljLWluZm8nKTsgfSxcclxuICAgIHJlc2V0OiBmdW5jdGlvbigpIHsgcmVzZXRUaWNrZXIoKTsgfVxyXG4gIH1cclxufSk7Il0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
