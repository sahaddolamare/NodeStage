angular.module("stage",["ngResource","ngRoute","ui.gravatar","ngAnimate"]),angular.module("stage").config(["$routeProvider","$locationProvider",function(e,t){var r={admin:{auth:["stAuthSvc",function(e){return e.authorizeCurrentUserForRoute("admin")}]},user:{auth:["stAuthSvc",function(e){return e.authorizeAuthenticatedUserForRoute()}]},guest:{auth:["stAuthSvc",function(e){return e.unauthenticatedUser()}]}};t.html5Mode(!0),e.when("/",{templateUrl:"/partials/main/main",controller:"stMainCtrl"}).when("/admin",{templateUrl:"/partials/admin/views/admin",controller:"stAdminCtrl",resolve:r.admin}).when("/admin/ddb",{templateUrl:"/partials/admin/views/dev-dashboard",controller:"stDevDbCtrl",resolve:r.admin}).when("/admin/users/add",{templateUrl:"/partials/admin/views/add-user",controller:"stAdminCtrl",resolve:r.admin}).when("/admin/users/delete",{templateUrl:"/partials/admin/views/delete-user",controller:"stAdminCtrl",resolve:r.admin}).when("/admin/users/purge",{templateUrl:"/partials/admin/views/purge-users",controller:"stAdminCtrl",resolve:r.admin}).when("/admin/users/sync",{templateUrl:"/partials/admin/views/sync-users",controller:"stAdminCtrl",resolve:r.admin}).when("/login",{templateUrl:"/partials/account/views/login",controller:"stLoginCtrl",resolve:r.guest}).when("/signup",{templateUrl:"/partials/account/views/signup",controller:"stSignupCtrl",resolve:r.guest}).when("/settings",{templateUrl:"/partials/account/views/settings",controller:"stProfileCtrl",resolve:r.user}).otherwise({redirectTo:"/"})}]),angular.module("stage").run(["$rootScope","$location",function(e,t){e.$on("$routeChangeError",function(e,r,n,o){"not authorized"===o&&t.path("/")})}]),angular.module("stage").factory("stAuthSvc",["$http","$q","stIdentitySvc","stUserSvc",function(e,t,r,n){return{authenticateUser:function(o,s){var a=t.defer();return e.post("/login",{username:o,password:s}).then(function(e){if(e.data.success){var t=new n;delete e.data.user.hashed_pwd,delete e.data.user.salt,angular.extend(t,e.data.user),r.currentUser=t,a.resolve(!0)}else a.resolve(!1)}),a.promise},createUser:function(e){var r=new n(e),o=t.defer();return r.$save().then(function(){o.resolve()},function(e){o.reject(e.data.reason)}),o.promise},logoutUser:function(){var n=t.defer();return e.post("/logout",{logout:!0}).then(function(){r.currentUser=void 0,n.resolve()}),n.promise},purgeUsers:function(){var r=t.defer();return e({method:"PURGE",url:"/api/users"}).then(function(){console.log("User database has been purged"),r.resolve()}),r.promise},syncUsers:function(r){var n=t.defer();return e({method:"COPY",url:"/api/db",headers:{"Content-Type":"application/json"},data:{collection:"users",direction:r}}).then(function(){console.log("User database has been synced"),n.resolve()}),n.promise},updateCurrentUser:function(e){var n=t.defer(),o=angular.copy(r.currentUser);return angular.extend(o,e),o.$update().then(function(){r.currentUser=o,n.resolve()},function(e){n.reject(e.data.reason)}),n.promise},authorizeAuthenticatedUserForRoute:function(){return r.isAuthenticated()?!0:t.reject("not authorized")},authorizeCurrentUserForRoute:function(e){return r.isAuthorized(e)?!0:t.reject("not authorized")},unauthenticatedUser:function(){return r.isAuthenticated()?t.reject("user signed in"):!0}}}]),angular.module("stage").factory("stIdentitySvc",["$window","stUserSvc",function(e,t){var r;return e.stageUser&&(r=new t,delete e.stageUser.hashed_pwd,delete e.stageUser.salt,angular.extend(r,e.stageUser)),{currentUser:r,isAuthenticated:function(){return!!this.currentUser},isAuthorized:function(e){return!!this.currentUser&&this.currentUser.roles.indexOf(e)>-1}}}]),angular.module("stage").controller("stLoginCtrl",["$scope","$location","stAuthSvc","stIdentitySvc","stTickerSvc",function(e,t,r,n,o){e.identity=n,e.signin=function(s,a){return!s||!a||s.$invalid||a.$invalid?(s&&!s.$invalid||$(loginWidget.username).addClass("invalid"),a&&!a.$invalid||$(loginWidget.password).addClass("invalid"),o.error("Please enter a valid email address and password."),!1):void r.authenticateUser(s,a).then(function(r){if(r){s="",a="",e.username="",e.password="";var u=n.isAuthorized("admin")?"/admin":"/";o.notify("You have been successfully authenticated."),t.path("login")&&t.path(u),n.isAuthorized("admin")&&t.path(u)}else o.error("Invalid email address or password was given.")})},e.signout=function(){r.logoutUser().then(function(){e.username="",e.password="",o.notify("You have been signed out."),t.path("/")})}}]),angular.module("stage").directive("stLoginWidget",function(){return{restrict:"E",replace:!0,templateUrl:"/partials/account/views/login-widget"}}),angular.module("stage").controller("stProfileCtrl",["$scope","stAuthSvc","stIdentitySvc","stTickerSvc",function(e,t,r,n){e.email=r.currentUser.userName,e.firstName=r.currentUser.firstName,e.lastName=r.currentUser.lastName,e.update=function(){var r={userName:e.email,firstName:e.firstName,lastName:e.lastName};e.password&&e.password.length>0&&(r.password=e.password),t.updateCurrentUser(r).then(function(){n.notify("Your profile has been updated.")},function(e){n.error(e)})}}]),angular.module("stage").factory("stUserSvc",["$resource",function(e){var t=e("/api/users/:id",{_id:"@id"},{update:{method:"PUT",isArray:!1},purge:{method:"PURGE",isArray:!1}});return t.prototype.isAdmin=function(){return this.roles&&this.roles.indexOf("admin")>-1},t}]),angular.module("stage").controller("stAdminCtrl",["$scope","$timeout","stAdminSvc","stAdminUserSvc","stAuthSvc","stTickerSvc",function(e,t,r,n,o,s){e.env=r.whatEnv(),e.users=n.populateUsers(),e.userRes=e.users,e.userField="userName",e.userReverse=!1,e.userCurrentPage=0,e.userShowOnPage="10",e.userSyncEnabled="development"==e.env,e.userSyncDir="toloc",e.filterUsers=function(){e.userRes=[];var t=n.searchUsers(e.users,e.userSearch);e.userRes=t,e.userCurrentPage=0},e.sortUsers=function(t,r){e.userReverse=e.userField===t?!e.userReverse:!1,r&&(e.userReverse=e.userField===t?e.userReverse:!0),e.userField=t},e.createUser=function(){var t={userName:e.email,password:e.password,firstName:e.firstName,lastName:e.lastName};o.createUser(t).then(function(){s.notify("Created user account "+t.userName+"."),r.adminRedirect("/admin")},function(e){s.error(e)})},e.purgeUsers=function(){r.adminRedirect("/admin"),r.updateRoot("userPurgeInProgress",!0),t(function(){o.purgeUsers().then(function(){r.adminRedirect("/"),o.logoutUser().then(function(){t(e.purgeDone,5e3)},function(e){s.error(e),r.updateRoot("userPurgeInProgress",!1)})},function(r){s.error(r),t(e.purgeDone,5e3)})},5e3)},e.syncDb=function(n,a){"users"==n&&(r.adminRedirect("/admin"),r.updateRoot("userSyncInProgress",!0),o.syncUsers(a).then(function(){"toloc"==a?(r.adminRedirect("/"),o.logoutUser().then(function(){t(e.syncDone,5e3)},function(e){s.error(e),r.updateRoot("userSyncInProgress",!0)})):t(e.syncDone,5e3)},function(r){s.error(r),t(e.syncDone,5e3)}))},e.pageUsers=function(){return Math.ceil(e.userRes.length/e.userShowOnPage)},e.purgeDone=function(){s.notify("User database has been purged."),r.updateRoot("userPurgeInProgress",!1)},e.syncDone=function(){s.notify("User database has been synced."),r.updateRoot("userSyncInProgress",!0)}}]),angular.module("stage").factory("stAdminSvc",["$location","$parse","$rootScope","$window",function(e,t,r,n){return{adminRedirect:function(t){e.path(t)},updateRoot:function(e,r){var n=t("$rootScope."+e);n=r},whatEnv:function(){return n.env}}}]),angular.module("stage").factory("stAdminUserSvc",["$filter","stUserSvc",function(e,t){return{actionDone:function(e){switch(e){case"purge":var t="purged";$rootScope.userPurgeInProgress=!1;break;case"sync":var t="synced";$rootScope.userSyncInProgress=!1}t&&stTickerSvc.notify("User database has been "+t+".")},populateUsers:function(){return t.query()},searchUsers:function(t,r){return e("userfind")(t,r)}}}]),angular.module("stage").controller("stDevDbCtrl",["$scope","$http","$timeout",function(e,t,r){e.ddbView=null,e.ddbConsoleType=null,e.localMongoStatus=!1,e.remoteMongoStatus=!1,e.azureStreamStatus=!1,e.ddbStreamWell="",e.ddbChangeView=function(t){switch(t){case"overview":e.ddbView=null,e.ddbConsoleType=null;break;case"localMongo":e.ddbView=t,e.ddbConsoleType="cmd",e.ddbStreamWell="Connected to local MongoDB service\n",e.localMongoStatus||e.ddbConnect(t),e.ddbStream(t);break;case"remoteMongo":e.ddbView=t,e.ddbConsoleType="cmd",e.ddbStreamWell="Connected to cloud MongoDB service\n",e.remoteMongoStatus||e.ddbConnect(t),e.ddbStream(t);break;case"azureStream":e.ddbView=t,e.ddbConsoleType="view",e.ddbStreamWell="Connected to Azure log streaming service\n",e.azureStreamStatus||e.ddbConnect(t),e.ddbStream(t)}},e.ddbCommand=function(){var r=e.ddbView;if(console.log(r),"cmd"!==e.ddbConsoleType)return!1;console.log("Type is cmd"),console.log(e.ddbCmdBar),console.log(e.ddbIsConnected(r));var n=!1;switch(r){case"localMongo":n=e.localMongoStatus;break;case"remoteMongo":n=e.remoteMongoStatus}return n&&e.ddbCmdBar?void t.post("/api/devdash/"+r+"/command",{cmd:e.ddbCmdBar}).then(function(t){e.ddbCmdBar=""}):!1},e.ddbConnect=function(r){t.get("/api/devdash/"+r+"/connect",{check:!0}).then(function(){"localMongo"==r?e.localMongoStatus=!0:"remoteMongo"==r?e.remoteMongoStatus=!0:"azureStream"==r&&(e.azureStreamStatus=!0)})},e.ddbDisconnect=function(t){"localMongo"==t?e.localMongoStatus=!1:"remoteMongo"==t?e.remoteMongoStatus=!1:"azureStream"==t&&(e.azureStreamStatus=!1)},e.ddbIsConnected=function(r){t.get("/api/devdash/"+r+"/status",{check:!0}).then(function(t){return"localMongo"==r?"Connected"==t.data&&200==t.status?(e.localMongoStatus=!0,!0):(e.localMongoStatus=!1,!1):"remoteMongo"==r?"Connected"==t.data&&200==t.status?(e.remoteMongoStatus=!0,!0):(e.remoteMongoStatus=!1,!1):"azureStream"==r?"Connected"==t.data&&200==t.status?(e.azureStreamStatus=!0,!0):(e.azureStreamStatus=!1,!1):void 0})},e.ddbStream=function(t){if("undefined"!=typeof EventSource){var n=new EventSource("/api/devdash/"+t+"/stream");n.addEventListener("message",function(t){e.$apply(function(){var n=JSON.parse(t.data);n=n.replace(/\[0m/g,""),n=n.replace(/\[36m/g,""),e.ddbStreamWell+=n.trim()+"\n",r(function(){var e=document.getElementById("streamWell");e.scrollTop=e.scrollHeight},50)})},!1),n.addEventListener("error",function(r){e.$apply(function(){e.ddbDisconnect(t),e.ddbStreamWell+="The stream for "+t+" has been unexpectedly closed.\n"}),n.close()},!1)}else e.ddbStreamWell="This browser does not support streaming.\n"}}]),angular.module("stage").factory("stDevDbSvc",["$http","$q","$rootScope",function(e,t,r){return{}}]),angular.module("stage").filter("userStartPage",function(){return function(e,t){return t=+t,e.slice(t)}}),angular.module("stage").filter("userfind",function(){return function(e,t){var r=[];return angular.forEach(e,function(e){try{var n=new RegExp(t,"gi")}catch(o){return[]}(e.userName.match(n)||e.firstName.match(n)||e.lastName.match(n)||""==t)&&r.push({_id:e._id,userName:e.userName,firstName:e.firstName,lastName:e.lastName,roles:e.roles})}),r}}),angular.module("stage").controller("stMainCtrl",["$scope",function(e){}]),angular.module("stage").controller("stTickerCtrl",["$scope","stTickerSvc",function(e,t){e.custom=t.custom(),e.reset=t.reset(),e.showAll=function(){$(".ticker-container").toggleClass("expanded")}}]),angular.module("stage").factory("stTickerSvc",function(){function e(e,r,s){e=r?" "+e:e;var a=$("<span></span>").addClass("ticker-msg").html(e);s&&(s=$("<span></span>").addClass("iconic iconic-sm "+s),a.prepend(s)),r&&a.addClass(r),$("#ticker").addClass("on").prepend(a),setTimeout(function(){$("#ticker").removeClass("on")},300),n?(clearTimeout(o),o=setTimeout(function(){t(),n=!1},8e3)):(n=!0,o=setTimeout(function(){t(),n=!1},8e3))}function t(){$("#ticker #ftrmsg").remove();var e=$("<span></span>").html(r).attr("id","ftrmsg");$("#ticker").addClass("on").prepend(e),setTimeout(function(){$("#ticker").removeClass("on")},300)}var r="//tardigrade/node | Tardigrade Digital &copy; 2016",n=!1,o=null;return{custom:function(t,r,n){return t?void e(t,r,"iconic-"+n):!1},notify:function(t){return t?void e(t,"success","iconic-circle-check"):!1},error:function(t){return t?void e(t,"error","iconic-circle-x"):!1},info:function(t){return t?void e(t,null,"iconic-info"):!1},reset:function(){t()}}});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInN0YWdlLmpzIiwiYWNjb3VudC9zdEF1dGhTdmMuanMiLCJhY2NvdW50L3N0SWRlbnRpdHlTdmMuanMiLCJhY2NvdW50L3N0TG9naW5DdHJsLmpzIiwiYWNjb3VudC9zdExvZ2luV2lkZ2V0LmpzIiwiYWNjb3VudC9zdFByb2ZpbGVDdHJsLmpzIiwiYWNjb3VudC9zdFVzZXJTdmMuanMiLCJhZG1pbi9zdEFkbWluQ3RybC5qcyIsImFkbWluL3N0QWRtaW5TdmMuanMiLCJhZG1pbi9zdEFkbWluVXNlclN2Yy5qcyIsImFkbWluL3N0RGV2RGJDdHJsLmpzIiwiYWRtaW4vc3REZXZEYlN2Yy5qcyIsImFkbWluL3N0UGFnZUZpbHRlci5qcyIsImFkbWluL3N0VXNlckZpbHRlci5qcyIsIm1haW4vc3RNYWluQ3RybC5qcyIsInRpY2tlci9zdFRpY2tlckN0cmwuanMiLCJ0aWNrZXIvc3RUaWNrZXJTdmMuanMiXSwibmFtZXMiOlsiYW5ndWxhciIsIm1vZHVsZSIsImNvbmZpZyIsIiRyb3V0ZVByb3ZpZGVyIiwiJGxvY2F0aW9uUHJvdmlkZXIiLCJyb3V0ZVJvbGVDaGVja3MiLCJhZG1pbiIsImF1dGgiLCJzdEF1dGhTdmMiLCJhdXRob3JpemVDdXJyZW50VXNlckZvclJvdXRlIiwidXNlciIsImF1dGhvcml6ZUF1dGhlbnRpY2F0ZWRVc2VyRm9yUm91dGUiLCJndWVzdCIsInVuYXV0aGVudGljYXRlZFVzZXIiLCJodG1sNU1vZGUiLCJ3aGVuIiwidGVtcGxhdGVVcmwiLCJjb250cm9sbGVyIiwicmVzb2x2ZSIsIm90aGVyd2lzZSIsInJlZGlyZWN0VG8iLCJydW4iLCIkcm9vdFNjb3BlIiwiJGxvY2F0aW9uIiwiJG9uIiwiZXZ0IiwiY3VycmVudCIsInByZXZpb3VzIiwicmVqZWN0aW9uIiwicGF0aCIsImZhY3RvcnkiLCIkaHR0cCIsIiRxIiwic3RJZGVudGl0eVN2YyIsInN0VXNlclN2YyIsImF1dGhlbnRpY2F0ZVVzZXIiLCJ1c2VybmFtZSIsInBhc3N3b3JkIiwiZGZkIiwiZGVmZXIiLCJwb3N0IiwidGhlbiIsInJlc3BvbnNlIiwiZGF0YSIsInN1Y2Nlc3MiLCJleHRlbmQiLCJjdXJyZW50VXNlciIsInByb21pc2UiLCJjcmVhdGVVc2VyIiwibmV3VXNlckRhdGEiLCJuZXdVc2VyIiwiJHNhdmUiLCJyZWplY3QiLCJyZWFzb24iLCJsb2dvdXRVc2VyIiwibG9nb3V0IiwidW5kZWZpbmVkIiwicHVyZ2VVc2VycyIsIm1ldGhvZCIsInVybCIsImNvbnNvbGUiLCJsb2ciLCJzeW5jVXNlcnMiLCJkaXJlY3Rpb24iLCJoZWFkZXJzIiwiQ29udGVudC1UeXBlIiwiY29sbGVjdGlvbiIsInVwZGF0ZUN1cnJlbnRVc2VyIiwiY2xvbmUiLCJjb3B5IiwiJHVwZGF0ZSIsImlzQXV0aGVudGljYXRlZCIsInJvbGUiLCJpc0F1dGhvcml6ZWQiLCIkd2luZG93Iiwic3RhZ2VVc2VyIiwidGhpcyIsInJvbGVzIiwiaW5kZXhPZiIsIiRzY29wZSIsInN0VGlja2VyU3ZjIiwiaWRlbnRpdHkiLCJzaWduaW4iLCIkaW52YWxpZCIsIiQiLCJsb2dpbldpZGdldCIsImFkZENsYXNzIiwiZXJyb3IiLCJub3RpZnkiLCJzaWdub3V0IiwiZGlyZWN0aXZlIiwicmVzdHJpY3QiLCJyZXBsYWNlIiwiZW1haWwiLCJ1c2VyTmFtZSIsImZpcnN0TmFtZSIsImxhc3ROYW1lIiwidXBkYXRlIiwibGVuZ3RoIiwiJHJlc291cmNlIiwiVXNlclJlc291cmNlIiwiX2lkIiwiaXNBcnJheSIsInB1cmdlIiwicHJvdG90eXBlIiwiaXNBZG1pbiIsIiR0aW1lb3V0Iiwic3RBZG1pblN2YyIsInN0QWRtaW5Vc2VyU3ZjIiwiZW52Iiwid2hhdEVudiIsInVzZXJzIiwicG9wdWxhdGVVc2VycyIsInVzZXJSZXMiLCJ1c2VyRmllbGQiLCJ1c2VyUmV2ZXJzZSIsInVzZXJDdXJyZW50UGFnZSIsInVzZXJTaG93T25QYWdlIiwidXNlclN5bmNFbmFibGVkIiwidXNlclN5bmNEaXIiLCJmaWx0ZXJVc2VycyIsInJlcyIsInNlYXJjaFVzZXJzIiwidXNlclNlYXJjaCIsInNvcnRVc2VycyIsImZpZWxkIiwiaW52ZXJ0IiwiYWRtaW5SZWRpcmVjdCIsInVwZGF0ZVJvb3QiLCJwdXJnZURvbmUiLCJzeW5jRGIiLCJzeW5jRGlyIiwic3luY0RvbmUiLCJwYWdlVXNlcnMiLCJNYXRoIiwiY2VpbCIsIiRwYXJzZSIsIm9iaiIsInZhbCIsInJvb3RPYmoiLCIkZmlsdGVyIiwiYWN0aW9uRG9uZSIsImFjdCIsImFjdFZlcmIiLCJ1c2VyUHVyZ2VJblByb2dyZXNzIiwidXNlclN5bmNJblByb2dyZXNzIiwicXVlcnkiLCJkZGJWaWV3IiwiZGRiQ29uc29sZVR5cGUiLCJsb2NhbE1vbmdvU3RhdHVzIiwicmVtb3RlTW9uZ29TdGF0dXMiLCJhenVyZVN0cmVhbVN0YXR1cyIsImRkYlN0cmVhbVdlbGwiLCJkZGJDaGFuZ2VWaWV3Iiwic3ZjIiwiZGRiQ29ubmVjdCIsImRkYlN0cmVhbSIsImRkYkNvbW1hbmQiLCJkZGJDbWRCYXIiLCJkZGJJc0Nvbm5lY3RlZCIsInN2Y1N0YXQiLCJjbWQiLCJnZXQiLCJjaGVjayIsImRkYkRpc2Nvbm5lY3QiLCJzdGF0dXMiLCJzdHJtU291cmNlIiwiRXZlbnRTb3VyY2UiLCJhZGRFdmVudExpc3RlbmVyIiwiZXZlbnQiLCIkYXBwbHkiLCJtc2ciLCJKU09OIiwicGFyc2UiLCJ0cmltIiwic3ciLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwic2Nyb2xsVG9wIiwic2Nyb2xsSGVpZ2h0IiwiZXJyIiwiY2xvc2UiLCJmaWx0ZXIiLCJpbnB1dCIsInN0YXJ0Iiwic2xpY2UiLCJxIiwibWF0Y2hlZCIsImZvckVhY2giLCJ1IiwiZXhwIiwiUmVnRXhwIiwiZSIsIm1hdGNoIiwicHVzaCIsImN1c3RvbSIsInJlc2V0Iiwic2hvd0FsbCIsInRvZ2dsZUNsYXNzIiwiYWRkVGlja2VyIiwibHZsIiwiaWMiLCJtc2dvYmoiLCJodG1sIiwicHJlcGVuZCIsInNldFRpbWVvdXQiLCJyZW1vdmVDbGFzcyIsInRvc2V0IiwiY2xlYXJUaW1lb3V0IiwidG8iLCJyZXNldFRpY2tlciIsInJlbW92ZSIsImZ0ciIsImF0dHIiLCJpbmZvIl0sIm1hcHBpbmdzIjoiQUFBQUEsUUFBQUMsT0FBQSxTQUFBLGFBQUEsVUFBQSxjQUFBLGNBRUFELFFBQUFDLE9BQUEsU0FBQUMsUUFBQSxpQkFBQSxvQkFBQSxTQUFBQyxFQUFBQyxHQUNBLEdBQUFDLElBQ0FDLE9BQUFDLE1BQUEsWUFBQSxTQUFBQyxHQUFBLE1BQUFBLEdBQUFDLDZCQUFBLFlBQ0FDLE1BQUFILE1BQUEsWUFBQSxTQUFBQyxHQUFBLE1BQUFBLEdBQUFHLHdDQUNBQyxPQUFBTCxNQUFBLFlBQUEsU0FBQUMsR0FBQSxNQUFBQSxHQUFBSyx5QkFHQVQsR0FBQVUsV0FBQSxHQUNBWCxFQUNBWSxLQUFBLEtBQ0FDLFlBQUEsc0JBQ0FDLFdBQUEsZUFFQUYsS0FBQSxVQUNBQyxZQUFBLDhCQUNBQyxXQUFBLGNBQ0FDLFFBQUFiLEVBQUFDLFFBRUFTLEtBQUEsY0FDQUMsWUFBQSxzQ0FDQUMsV0FBQSxjQUNBQyxRQUFBYixFQUFBQyxRQUVBUyxLQUFBLG9CQUNBQyxZQUFBLGlDQUNBQyxXQUFBLGNBQ0FDLFFBQUFiLEVBQUFDLFFBRUFTLEtBQUEsdUJBQ0FDLFlBQUEsb0NBQ0FDLFdBQUEsY0FDQUMsUUFBQWIsRUFBQUMsUUFFQVMsS0FBQSxzQkFDQUMsWUFBQSxvQ0FDQUMsV0FBQSxjQUNBQyxRQUFBYixFQUFBQyxRQUVBUyxLQUFBLHFCQUNBQyxZQUFBLG1DQUNBQyxXQUFBLGNBQ0FDLFFBQUFiLEVBQUFDLFFBRUFTLEtBQUEsVUFDQUMsWUFBQSxnQ0FDQUMsV0FBQSxjQUNBQyxRQUFBYixFQUFBTyxRQUVBRyxLQUFBLFdBQ0FDLFlBQUEsaUNBQ0FDLFdBQUEsZUFDQUMsUUFBQWIsRUFBQU8sUUFFQUcsS0FBQSxhQUNBQyxZQUFBLG1DQUNBQyxXQUFBLGdCQUNBQyxRQUFBYixFQUFBSyxPQUVBUyxXQUNBQyxXQUFBLFNBSUFwQixRQUFBQyxPQUFBLFNBQUFv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RUFBQSxJQTBCQSxRQUNBZCxPQUFBLFNBQUF4QixFQUFBNkIsRUFBQUMsR0FBQSxNQUFBOUIsT0FBQTRCLEdBQUE1QixFQUFBNkIsRUFBQSxVQUFBQyxJQUFBLEdBQ0FqSCxPQUFBLFNBQUFtRixHQUFBLE1BQUFBLE9BQUE0QixHQUFBNUIsRUFBQSxVQUFBLHdCQUFBLEdBQ0FwRixNQUFBLFNBQUFvRixHQUFBLE1BQUFBLE9BQUE0QixHQUFBNUIsRUFBQSxRQUFBLG9CQUFBLEdBQ0EyQyxLQUFBLFNBQUEzQyxHQUFBLE1BQUFBLE9BQUE0QixHQUFBNUIsRUFBQSxLQUFBLGdCQUFBLEdBQ0F5QixNQUFBLFdBQUFjIiwiZmlsZSI6ImFwcC5qcyIsInNvdXJjZXNDb250ZW50IjpbImFuZ3VsYXIubW9kdWxlKCdzdGFnZScsIFsnbmdSZXNvdXJjZScsICduZ1JvdXRlJywgJ3VpLmdyYXZhdGFyJywgJ25nQW5pbWF0ZSddKTtcclxuXHJcbmFuZ3VsYXIubW9kdWxlKCdzdGFnZScpLmNvbmZpZyhmdW5jdGlvbigkcm91dGVQcm92aWRlciwgJGxvY2F0aW9uUHJvdmlkZXIpIHtcclxuICB2YXIgcm91dGVSb2xlQ2hlY2tzID0ge1xyXG4gICAgYWRtaW46IHsgYXV0aDogLypAbmdJbmplY3QqLyBmdW5jdGlvbihzdEF1dGhTdmMpIHsgcmV0dXJuIHN0QXV0aFN2Yy5hdXRob3JpemVDdXJyZW50VXNlckZvclJvdXRlKCdhZG1pbicpOyB9IH0sXHJcbiAgICB1c2VyOiB7IGF1dGg6IC8qQG5nSW5qZWN0Ki8gZnVuY3Rpb24oc3RBdXRoU3ZjKSB7IHJldHVybiBzdEF1dGhTdmMuYXV0aG9yaXplQXV0aGVudGljYXRlZFVzZXJGb3JSb3V0ZSgpOyB9IH0sXHJcbiAgICBndWVzdDogeyBhdXRoOiAvKkBuZ0luamVjdCovIGZ1bmN0aW9uKHN0QXV0aFN2YykgeyByZXR1cm4gc3RBdXRoU3ZjLnVuYXV0aGVudGljYXRlZFVzZXIoKTsgfSB9XHJcbiAgfVxyXG5cclxuICAkbG9jYXRpb25Qcm92aWRlci5odG1sNU1vZGUodHJ1ZSk7XHJcbiAgJHJvdXRlUHJvdmlkZXJcclxuICAgIC53aGVuKCcvJywgeyBcclxuICAgICAgdGVtcGxhdGVVcmw6ICcvcGFydGlhbHMvbWFpbi9tYWluJywgXHJcbiAgICAgIGNvbnRyb2xsZXI6ICdzdE1haW5DdHJsJ1xyXG4gICAgfSlcclxuICAgIC53aGVuKCcvYWRtaW4nLCB7XHJcbiAgICAgIHRlbXBsYXRlVXJsOiAnL3BhcnRpYWxzL2FkbWluL3ZpZXdzL2FkbWluJywgXHJcbiAgICAgIGNvbnRyb2xsZXI6ICdzdEFkbWluQ3RybCcsIFxyXG4gICAgICByZXNvbHZlOiByb3V0ZVJvbGVDaGVja3MuYWRtaW5cclxuICAgIH0pXHJcbiAgICAud2hlbignL2FkbWluL2RkYicsIHtcclxuICAgICAgdGVtcGxhdGVVcmw6ICcvcGFydGlhbHMvYWRtaW4vdmlld3MvZGV2LWRhc2hib2FyZCcsIFxyXG4gICAgICBjb250cm9sbGVyOiAnc3REZXZEYkN0cmwnLCBcclxuICAgICAgcmVzb2x2ZTogcm91dGVSb2xlQ2hlY2tzLmFkbWluXHJcbiAgICB9KVxyXG4gICAgLndoZW4oJy9hZG1pbi91c2Vycy9hZGQnLCB7XHJcbiAgICAgIHRlbXBsYXRlVXJsOiAnL3BhcnRpYWxzL2FkbWluL3ZpZXdzL2FkZC11c2VyJywgXHJcbiAgICAgIGNvbnRyb2xsZXI6ICdzdEFkbWluQ3RybCcsIFxyXG4gICAgICByZXNvbHZlOiByb3V0ZVJvbGVDaGVja3MuYWRtaW5cclxuICAgIH0pXHJcbiAgICAud2hlbignL2FkbWluL3VzZXJzL2RlbGV0ZScsIHtcclxuICAgICAgdGVtcGxhdGVVcmw6ICcvcGFydGlhbHMvYWRtaW4vdmlld3MvZGVsZXRlLXVzZXInLCBcclxuICAgICAgY29udHJvbGxlcjogJ3N0QWRtaW5DdHJsJywgXHJcbiAgICAgIHJlc29sdmU6IHJvdXRlUm9sZUNoZWNrcy5hZG1pblxyXG4gICAgfSlcclxuICAgIC53aGVuKCcvYWRtaW4vdXNlcnMvcHVyZ2UnLCB7XHJcbiAgICAgIHRlbXBsYXRlVXJsOiAnL3BhcnRpYWxzL2FkbWluL3ZpZXdzL3B1cmdlLXVzZXJzJywgXHJcbiAgICAgIGNvbnRyb2xsZXI6ICdzdEFkbWluQ3RybCcsIFxyXG4gICAgICByZXNvbHZlOiByb3V0ZVJvbGVDaGVja3MuYWRtaW5cclxuICAgIH0pXHJcbiAgICAud2hlbignL2FkbWluL3VzZXJzL3N5bmMnLCB7XHJcbiAgICAgIHRlbXBsYXRlVXJsOiAnL3BhcnRpYWxzL2FkbWluL3ZpZXdzL3N5bmMtdXNlcnMnLCBcclxuICAgICAgY29udHJvbGxlcjogJ3N0QWRtaW5DdHJsJywgXHJcbiAgICAgIHJlc29sdmU6IHJvdXRlUm9sZUNoZWNrcy5hZG1pblxyXG4gICAgfSlcclxuICAgIC53aGVuKCcvbG9naW4nLCB7XHJcbiAgICAgIHRlbXBsYXRlVXJsOiAnL3BhcnRpYWxzL2FjY291bnQvdmlld3MvbG9naW4nLCBcclxuICAgICAgY29udHJvbGxlcjogJ3N0TG9naW5DdHJsJyxcclxuICAgICAgcmVzb2x2ZTogcm91dGVSb2xlQ2hlY2tzLmd1ZXN0XHJcbiAgICB9KVxyXG4gICAgLndoZW4oJy9zaWdudXAnLCB7XHJcbiAgICAgIHRlbXBsYXRlVXJsOiAnL3BhcnRpYWxzL2FjY291bnQvdmlld3Mvc2lnbnVwJywgXHJcbiAgICAgIGNvbnRyb2xsZXI6ICdzdFNpZ251cEN0cmwnLFxyXG4gICAgICByZXNvbHZlOiByb3V0ZVJvbGVDaGVja3MuZ3Vlc3RcclxuICAgIH0pXHJcbiAgICAud2hlbignL3NldHRpbmdzJywge1xyXG4gICAgICB0ZW1wbGF0ZVVybDogJy9wYXJ0aWFscy9hY2NvdW50L3ZpZXdzL3NldHRpbmdzJywgXHJcbiAgICAgIGNvbnRyb2xsZXI6ICdzdFByb2ZpbGVDdHJsJyxcclxuICAgICAgcmVzb2x2ZTogcm91dGVSb2xlQ2hlY2tzLnVzZXJcclxuICAgIH0pXHJcbiAgICAub3RoZXJ3aXNlKHtcclxuICAgICAgcmVkaXJlY3RUbzogJy8nXHJcbiAgICB9KTtcclxufSk7XHJcblxyXG5hbmd1bGFyLm1vZHVsZSgnc3RhZ2UnKS5ydW4oZnVuY3Rpb24oJHJvb3RTY29wZSwgJGxvY2F0aW9uKSB7XHJcbiAgJHJvb3RTY29wZS4kb24oJyRyb3V0ZUNoYW5nZUVycm9yJywgZnVuY3Rpb24oZXZ0LCBjdXJyZW50LCBwcmV2aW91cywgcmVqZWN0aW9uKSB7XHJcbiAgICBpZihyZWplY3Rpb24gPT09ICdub3QgYXV0aG9yaXplZCcpIHtcclxuICAgICAgJGxvY2F0aW9uLnBhdGgoJy8nKTtcclxuICAgIH1cclxuICB9KVxyXG59KTsiLCJhbmd1bGFyLm1vZHVsZSgnc3RhZ2UnKS5mYWN0b3J5KCdzdEF1dGhTdmMnLCBmdW5jdGlvbigkaHR0cCwgJHEsIHN0SWRlbnRpdHlTdmMsIHN0VXNlclN2Yykge1xyXG4gIHJldHVybiB7XHJcbiAgICAvLyBhdXRoZW50aWNhdGVVc2VyOiBWZXJpZmllcyBsb2dpbiBjcmVkZW50aWFscyBhbmQgc2lnbnMgaW4gdXNlclxyXG4gICAgYXV0aGVudGljYXRlVXNlcjogZnVuY3Rpb24odXNlcm5hbWUsIHBhc3N3b3JkKSB7XHJcbiAgICAgIHZhciBkZmQgPSAkcS5kZWZlcigpO1xyXG4gICAgICAkaHR0cC5wb3N0KCcvbG9naW4nLCB7dXNlcm5hbWU6dXNlcm5hbWUsIHBhc3N3b3JkOnBhc3N3b3JkfSkudGhlbihmdW5jdGlvbihyZXNwb25zZSkge1xyXG4gICAgICAgIGlmKHJlc3BvbnNlLmRhdGEuc3VjY2Vzcykge1xyXG4gICAgICAgICAgdmFyIHVzZXIgPSBuZXcgc3RVc2VyU3ZjKCk7XHJcbiAgICAgICAgICBkZWxldGUgcmVzcG9uc2UuZGF0YS51c2VyWydoYXNoZWRfcHdkJ107XHJcbiAgICAgICAgICBkZWxldGUgcmVzcG9uc2UuZGF0YS51c2VyWydzYWx0J107XHJcbiAgICAgICAgICBhbmd1bGFyLmV4dGVuZCh1c2VyLCByZXNwb25zZS5kYXRhLnVzZXIpO1xyXG4gICAgICAgICAgc3RJZGVudGl0eVN2Yy5jdXJyZW50VXNlciA9IHVzZXI7XHJcbiAgICAgICAgICBkZmQucmVzb2x2ZSh0cnVlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICBkZmQucmVzb2x2ZShmYWxzZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgICAgcmV0dXJuIGRmZC5wcm9taXNlO1xyXG4gICAgfSxcclxuICAgIFxyXG4gICAgLy8gY3JlYXRlVXNlcjogQ3JlYXRlcyBhIG5ldyB1c2VyXHJcbiAgICBjcmVhdGVVc2VyOiBmdW5jdGlvbihuZXdVc2VyRGF0YSkge1xyXG4gICAgICB2YXIgbmV3VXNlciA9IG5ldyBzdFVzZXJTdmMobmV3VXNlckRhdGEpO1xyXG4gICAgICB2YXIgZGZkID0gJHEuZGVmZXIoKTtcclxuICAgICAgXHJcbiAgICAgIG5ld1VzZXIuJHNhdmUoKS50aGVuKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGRmZC5yZXNvbHZlKCk7XHJcbiAgICAgIH0sIGZ1bmN0aW9uKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgZGZkLnJlamVjdChyZXNwb25zZS5kYXRhLnJlYXNvbik7XHJcbiAgICAgIH0pXHJcbiAgICAgIFxyXG4gICAgICByZXR1cm4gZGZkLnByb21pc2U7XHJcbiAgICB9LFxyXG4gICAgXHJcbiAgICAvLyBsb2dvdXRVc2VyOiBFbmRzIHRoZSBjdXJyZW50IHVzZXIncyBzZXNzaW9uXHJcbiAgICBsb2dvdXRVc2VyOiBmdW5jdGlvbigpIHtcclxuICAgICAgdmFyIGRmZCA9ICRxLmRlZmVyKCk7XHJcbiAgICAgICRodHRwLnBvc3QoJy9sb2dvdXQnLCB7bG9nb3V0OiB0cnVlfSkudGhlbihmdW5jdGlvbigpIHtcclxuICAgICAgICBzdElkZW50aXR5U3ZjLmN1cnJlbnRVc2VyID0gdW5kZWZpbmVkO1xyXG4gICAgICAgIGRmZC5yZXNvbHZlKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgICByZXR1cm4gZGZkLnByb21pc2U7XHJcbiAgICB9LFxyXG4gICAgXHJcbiAgICAvL3B1cmdlVXNlcnM6IFJlbW92ZXMgYWxsIHVzZXJzIGFuZCByZXN0b3JlcyB1c2VyIGRhdGFiYXNlIHRvIGRlZmF1bHRzXHJcbiAgICBwdXJnZVVzZXJzOiBmdW5jdGlvbigpIHtcclxuICAgICAgdmFyIGRmZCA9ICRxLmRlZmVyKCk7XHJcbiAgICAgICRodHRwKHtcclxuICAgICAgICBtZXRob2Q6ICdQVVJHRScsXHJcbiAgICAgICAgdXJsOiAnL2FwaS91c2VycydcclxuICAgICAgfSkudGhlbihmdW5jdGlvbigpIHtcclxuICAgICAgICBjb25zb2xlLmxvZygnVXNlciBkYXRhYmFzZSBoYXMgYmVlbiBwdXJnZWQnKTtcclxuICAgICAgICBkZmQucmVzb2x2ZSgpO1xyXG4gICAgICB9KTtcclxuICAgICAgcmV0dXJuIGRmZC5wcm9taXNlO1xyXG4gICAgfSxcclxuICAgIFxyXG4gICAgLy8gc3luY1VzZXJzOiBTeW5jcyB1c2VyIGRhdGFiYXNlIGNvbGxlY3Rpb25cclxuICAgIHN5bmNVc2VyczogZnVuY3Rpb24oZGlyZWN0aW9uKSB7XHJcbiAgICAgIHZhciBkZmQgPSAkcS5kZWZlcigpO1xyXG4gICAgICAkaHR0cCh7XHJcbiAgICAgICAgbWV0aG9kOiAnQ09QWScsXHJcbiAgICAgICAgdXJsOiAnL2FwaS9kYicsXHJcbiAgICAgICAgaGVhZGVyczogeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nIH0sXHJcbiAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgY29sbGVjdGlvbjogJ3VzZXJzJyxcclxuICAgICAgICAgIGRpcmVjdGlvbjogZGlyZWN0aW9uXHJcbiAgICAgICAgfVxyXG4gICAgICB9KS50aGVuKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdVc2VyIGRhdGFiYXNlIGhhcyBiZWVuIHN5bmNlZCcpO1xyXG4gICAgICAgIGRmZC5yZXNvbHZlKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgICByZXR1cm4gZGZkLnByb21pc2U7XHJcbiAgICB9LFxyXG4gICAgXHJcbiAgICAvLyB1cGRhdGVDdXJyZW50VXNlcjogVXBkYXRlcyBwcm9maWxlIG9mIGN1cnJlbnQgdXNlclxyXG4gICAgdXBkYXRlQ3VycmVudFVzZXI6IGZ1bmN0aW9uKG5ld1VzZXJEYXRhKSB7XHJcbiAgICAgIHZhciBkZmQgPSAkcS5kZWZlcigpO1xyXG4gICAgICBcclxuICAgICAgdmFyIGNsb25lID0gYW5ndWxhci5jb3B5KHN0SWRlbnRpdHlTdmMuY3VycmVudFVzZXIpO1xyXG4gICAgICBhbmd1bGFyLmV4dGVuZChjbG9uZSwgbmV3VXNlckRhdGEpO1xyXG4gICAgICBjbG9uZS4kdXBkYXRlKCkudGhlbihmdW5jdGlvbigpIHtcclxuICAgICAgICBzdElkZW50aXR5U3ZjLmN1cnJlbnRVc2VyID0gY2xvbmU7XHJcbiAgICAgICAgZGZkLnJlc29sdmUoKTtcclxuICAgICAgfSwgZnVuY3Rpb24ocmVzcG9uc2UpIHtcclxuICAgICAgICBkZmQucmVqZWN0KHJlc3BvbnNlLmRhdGEucmVhc29uKTtcclxuICAgICAgfSk7XHJcbiAgICAgIHJldHVybiBkZmQucHJvbWlzZTtcclxuICAgIH0sXHJcbiAgICBcclxuICAgIC8vIGF1dGhvcml6ZUF1dGhlbnRpY2F0ZWRVc2VyRm9yUm91dGU6IENoZWNrcyB3aGV0aGVyIHVzZXIgaXMgc2lnbmVkIGluXHJcbiAgICBhdXRob3JpemVBdXRoZW50aWNhdGVkVXNlckZvclJvdXRlOiBmdW5jdGlvbigpIHtcclxuICAgICAgaWYoc3RJZGVudGl0eVN2Yy5pc0F1dGhlbnRpY2F0ZWQoKSkgeyByZXR1cm4gdHJ1ZTsgfVxyXG4gICAgICBlbHNlIHsgcmV0dXJuICRxLnJlamVjdCgnbm90IGF1dGhvcml6ZWQnKTsgfVxyXG4gICAgfSxcclxuICAgIFxyXG4gICAgLy8gYXV0aG9yaXplQ3VycmVudFVzZXJGb3JSb3V0ZTogQ2hlY2tzIHdoZXRoZXIgY3VyZW50IHVzZXIgaGFzIHJvbGVcclxuICAgIGF1dGhvcml6ZUN1cnJlbnRVc2VyRm9yUm91dGU6IGZ1bmN0aW9uKHJvbGUpIHtcclxuICAgICAgaWYoc3RJZGVudGl0eVN2Yy5pc0F1dGhvcml6ZWQocm9sZSkpIHsgcmV0dXJuIHRydWU7IH1cclxuICAgICAgZWxzZSB7IHJldHVybiAkcS5yZWplY3QoJ25vdCBhdXRob3JpemVkJyk7IH1cclxuICAgIH0sXHJcbiAgICBcclxuICAgIC8vIHVuYXV0aGVudGljYXRlZFVzZXI6IENoZWNrcyB3aGV0aGVyIHVzZXIgaXMgbm90IHNpZ25lZCBpblxyXG4gICAgdW5hdXRoZW50aWNhdGVkVXNlcjogZnVuY3Rpb24oKSB7XHJcbiAgICAgIGlmKCFzdElkZW50aXR5U3ZjLmlzQXV0aGVudGljYXRlZCgpKSB7IHJldHVybiB0cnVlOyB9XHJcbiAgICAgIGVsc2UgeyByZXR1cm4gJHEucmVqZWN0KCd1c2VyIHNpZ25lZCBpbicpOyB9XHJcbiAgICB9XHJcbiAgfVxyXG59KTsiLCJhbmd1bGFyLm1vZHVsZSgnc3RhZ2UnKS5mYWN0b3J5KCdzdElkZW50aXR5U3ZjJywgZnVuY3Rpb24oJHdpbmRvdywgc3RVc2VyU3ZjKSB7XHJcbiAgdmFyIGN1cnJlbnRVc2VyO1xyXG4gIGlmKCR3aW5kb3cuc3RhZ2VVc2VyKSB7IFxyXG4gICAgY3VycmVudFVzZXIgPSBuZXcgc3RVc2VyU3ZjKCk7XHJcbiAgICBkZWxldGUgJHdpbmRvdy5zdGFnZVVzZXJbJ2hhc2hlZF9wd2QnXTtcclxuICAgIGRlbGV0ZSAkd2luZG93LnN0YWdlVXNlclsnc2FsdCddO1xyXG4gICAgYW5ndWxhci5leHRlbmQoY3VycmVudFVzZXIsICR3aW5kb3cuc3RhZ2VVc2VyKTtcclxuICB9XHJcbiAgcmV0dXJuIHtcclxuICAgIGN1cnJlbnRVc2VyOiBjdXJyZW50VXNlcixcclxuICAgIGlzQXV0aGVudGljYXRlZDogZnVuY3Rpb24oKSB7IHJldHVybiAhIXRoaXMuY3VycmVudFVzZXI7IH0sXHJcbiAgICBpc0F1dGhvcml6ZWQ6IGZ1bmN0aW9uKHJvbGUpIHsgcmV0dXJuICEhdGhpcy5jdXJyZW50VXNlciAmJiB0aGlzLmN1cnJlbnRVc2VyLnJvbGVzLmluZGV4T2Yocm9sZSkgPiAtMTsgfVxyXG4gIH1cclxufSk7IiwiYW5ndWxhci5tb2R1bGUoJ3N0YWdlJykuY29udHJvbGxlcignc3RMb2dpbkN0cmwnLCBmdW5jdGlvbigkc2NvcGUsICRsb2NhdGlvbiwgc3RBdXRoU3ZjLCBzdElkZW50aXR5U3ZjLCBzdFRpY2tlclN2Yykge1xyXG4gICRzY29wZS5pZGVudGl0eSA9IHN0SWRlbnRpdHlTdmM7XHJcbiAgJHNjb3BlLnNpZ25pbiA9IGZ1bmN0aW9uKHVzZXJuYW1lLCBwYXNzd29yZCkge1xyXG4gICAgaWYoIXVzZXJuYW1lIHx8ICFwYXNzd29yZCB8fCB1c2VybmFtZS4kaW52YWxpZCB8fCBwYXNzd29yZC4kaW52YWxpZCkge1xyXG4gICAgICBpZighdXNlcm5hbWUgfHwgdXNlcm5hbWUuJGludmFsaWQpIHsgJChsb2dpbldpZGdldC51c2VybmFtZSkuYWRkQ2xhc3MoJ2ludmFsaWQnKTsgfVxyXG4gICAgICBpZighcGFzc3dvcmQgfHwgcGFzc3dvcmQuJGludmFsaWQpIHsgJChsb2dpbldpZGdldC5wYXNzd29yZCkuYWRkQ2xhc3MoJ2ludmFsaWQnKTsgfVxyXG4gICAgICBzdFRpY2tlclN2Yy5lcnJvcignUGxlYXNlIGVudGVyIGEgdmFsaWQgZW1haWwgYWRkcmVzcyBhbmQgcGFzc3dvcmQuJyk7XHJcbiAgICAgIHJldHVybiBmYWxzZTsgIFxyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgIHN0QXV0aFN2Yy5hdXRoZW50aWNhdGVVc2VyKHVzZXJuYW1lLCBwYXNzd29yZCkudGhlbihmdW5jdGlvbihzdWNjZXNzKSB7XHJcbiAgICAgICAgaWYoc3VjY2Vzcykge1xyXG4gICAgICAgICAgdXNlcm5hbWUgPSAnJztcclxuICAgICAgICAgIHBhc3N3b3JkID0gJyc7XHJcbiAgICAgICAgICAkc2NvcGUudXNlcm5hbWUgPSAnJztcclxuICAgICAgICAgICRzY29wZS5wYXNzd29yZCA9ICcnO1xyXG4gICAgICAgICAgdmFyIHBhdGggPSBzdElkZW50aXR5U3ZjLmlzQXV0aG9yaXplZCgnYWRtaW4nKSA/ICcvYWRtaW4nIDogJy8nO1xyXG4gICAgICAgICAgc3RUaWNrZXJTdmMubm90aWZ5KCdZb3UgaGF2ZSBiZWVuIHN1Y2Nlc3NmdWxseSBhdXRoZW50aWNhdGVkLicpO1xyXG4gICAgICAgICAgaWYoJGxvY2F0aW9uLnBhdGgoJ2xvZ2luJykpIHsgJGxvY2F0aW9uLnBhdGgocGF0aCk7IH1cclxuICAgICAgICAgIGlmKHN0SWRlbnRpdHlTdmMuaXNBdXRob3JpemVkKCdhZG1pbicpKSB7ICRsb2NhdGlvbi5wYXRoKHBhdGgpOyB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgeyBzdFRpY2tlclN2Yy5lcnJvcignSW52YWxpZCBlbWFpbCBhZGRyZXNzIG9yIHBhc3N3b3JkIHdhcyBnaXZlbi4nKSB9XHJcbiAgICAgIH0pOyAgICAgIFxyXG4gICAgfVxyXG4gIH1cclxuICBcclxuICAkc2NvcGUuc2lnbm91dCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgc3RBdXRoU3ZjLmxvZ291dFVzZXIoKS50aGVuKGZ1bmN0aW9uKCkge1xyXG4gICAgICAkc2NvcGUudXNlcm5hbWUgPSBcIlwiO1xyXG4gICAgICAkc2NvcGUucGFzc3dvcmQgPSBcIlwiO1xyXG4gICAgICBzdFRpY2tlclN2Yy5ub3RpZnkoJ1lvdSBoYXZlIGJlZW4gc2lnbmVkIG91dC4nKTtcclxuICAgICAgJGxvY2F0aW9uLnBhdGgoJy8nKTtcclxuICAgIH0pXHJcbiAgfVxyXG59KTsiLCJhbmd1bGFyLm1vZHVsZSgnc3RhZ2UnKS5kaXJlY3RpdmUoJ3N0TG9naW5XaWRnZXQnLCBmdW5jdGlvbigpIHtcclxuICByZXR1cm4ge1xyXG4gICAgcmVzdHJpY3Q6ICdFJyxcclxuICAgIHJlcGxhY2U6IHRydWUsXHJcbiAgICB0ZW1wbGF0ZVVybDogJy9wYXJ0aWFscy9hY2NvdW50L3ZpZXdzL2xvZ2luLXdpZGdldCdcclxuICB9O1xyXG59KTsiLCJhbmd1bGFyLm1vZHVsZSgnc3RhZ2UnKS5jb250cm9sbGVyKCdzdFByb2ZpbGVDdHJsJywgZnVuY3Rpb24oJHNjb3BlLCBzdEF1dGhTdmMsIHN0SWRlbnRpdHlTdmMsIHN0VGlja2VyU3ZjKSB7XHJcbiAgJHNjb3BlLmVtYWlsID0gc3RJZGVudGl0eVN2Yy5jdXJyZW50VXNlci51c2VyTmFtZTtcclxuICAkc2NvcGUuZmlyc3ROYW1lID0gc3RJZGVudGl0eVN2Yy5jdXJyZW50VXNlci5maXJzdE5hbWU7XHJcbiAgJHNjb3BlLmxhc3ROYW1lID0gc3RJZGVudGl0eVN2Yy5jdXJyZW50VXNlci5sYXN0TmFtZTtcclxuICBcclxuICAkc2NvcGUudXBkYXRlID0gZnVuY3Rpb24oKSB7XHJcbiAgICB2YXIgbmV3VXNlckRhdGEgPSB7XHJcbiAgICAgIHVzZXJOYW1lOiAkc2NvcGUuZW1haWwsXHJcbiAgICAgIGZpcnN0TmFtZTogJHNjb3BlLmZpcnN0TmFtZSxcclxuICAgICAgbGFzdE5hbWU6ICRzY29wZS5sYXN0TmFtZVxyXG4gICAgfVxyXG5cclxuICAgIGlmKCRzY29wZS5wYXNzd29yZCAmJiAkc2NvcGUucGFzc3dvcmQubGVuZ3RoID4gMCkgeyBuZXdVc2VyRGF0YS5wYXNzd29yZCA9ICRzY29wZS5wYXNzd29yZDsgfVxyXG5cclxuICAgIHN0QXV0aFN2Yy51cGRhdGVDdXJyZW50VXNlcihuZXdVc2VyRGF0YSkudGhlbihcclxuICAgICAgZnVuY3Rpb24oKSB7IHN0VGlja2VyU3ZjLm5vdGlmeSgnWW91ciBwcm9maWxlIGhhcyBiZWVuIHVwZGF0ZWQuJykgfSwgXHJcbiAgICAgIGZ1bmN0aW9uKHJlYXNvbikgeyBzdFRpY2tlclN2Yy5lcnJvcihyZWFzb24pOyB9XHJcbiAgICApO1xyXG4gIH1cclxufSk7IiwiYW5ndWxhci5tb2R1bGUoJ3N0YWdlJykuZmFjdG9yeSgnc3RVc2VyU3ZjJywgZnVuY3Rpb24oJHJlc291cmNlKSB7XHJcbiAgdmFyIFVzZXJSZXNvdXJjZSA9ICRyZXNvdXJjZSgnL2FwaS91c2Vycy86aWQnLCB7X2lkOiBcIkBpZFwifSwge1xyXG4gICAgdXBkYXRlOiB7bWV0aG9kOiAnUFVUJywgaXNBcnJheTogZmFsc2V9LFxyXG4gICAgcHVyZ2U6IHttZXRob2Q6ICdQVVJHRScsIGlzQXJyYXk6IGZhbHNlfVxyXG4gIH0pO1xyXG4gIFxyXG4gIFVzZXJSZXNvdXJjZS5wcm90b3R5cGUuaXNBZG1pbiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgcmV0dXJuIHRoaXMucm9sZXMgJiYgdGhpcy5yb2xlcy5pbmRleE9mKCdhZG1pbicpID4gLTE7XHJcbiAgfVxyXG4gIFxyXG4gIHJldHVybiBVc2VyUmVzb3VyY2U7XHJcbn0pIiwiYW5ndWxhci5tb2R1bGUoJ3N0YWdlJykuY29udHJvbGxlcignc3RBZG1pbkN0cmwnLCBmdW5jdGlvbigkc2NvcGUsICR0aW1lb3V0LCBzdEFkbWluU3ZjLCBzdEFkbWluVXNlclN2Yywgc3RBdXRoU3ZjLCBzdFRpY2tlclN2Yykge1xyXG4gICRzY29wZS5lbnYgPSBzdEFkbWluU3ZjLndoYXRFbnYoKTtcclxuICAkc2NvcGUudXNlcnMgPSBzdEFkbWluVXNlclN2Yy5wb3B1bGF0ZVVzZXJzKCk7XHJcbiAgJHNjb3BlLnVzZXJSZXMgPSAkc2NvcGUudXNlcnM7XHJcbiAgJHNjb3BlLnVzZXJGaWVsZCA9ICd1c2VyTmFtZSc7XHJcbiAgJHNjb3BlLnVzZXJSZXZlcnNlID0gZmFsc2U7XHJcbiAgJHNjb3BlLnVzZXJDdXJyZW50UGFnZSA9IDA7XHJcbiAgJHNjb3BlLnVzZXJTaG93T25QYWdlID0gJzEwJztcclxuICAkc2NvcGUudXNlclN5bmNFbmFibGVkID0gJHNjb3BlLmVudiA9PSAnZGV2ZWxvcG1lbnQnID8gdHJ1ZSA6IGZhbHNlO1xyXG4gICRzY29wZS51c2VyU3luY0RpciA9ICd0b2xvYyc7XHJcblxyXG4gICRzY29wZS5maWx0ZXJVc2VycyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgJHNjb3BlLnVzZXJSZXMgPSBbXTtcclxuICAgIHZhciByZXMgPSBzdEFkbWluVXNlclN2Yy5zZWFyY2hVc2Vycygkc2NvcGUudXNlcnMsICRzY29wZS51c2VyU2VhcmNoKTtcclxuICAgICRzY29wZS51c2VyUmVzID0gcmVzO1xyXG4gICAgJHNjb3BlLnVzZXJDdXJyZW50UGFnZSA9IDA7XHJcbiAgfVxyXG5cclxuICAkc2NvcGUuc29ydFVzZXJzID0gZnVuY3Rpb24oZmllbGQsIGludmVydCkge1xyXG4gICAgJHNjb3BlLnVzZXJSZXZlcnNlID0gKCRzY29wZS51c2VyRmllbGQgPT09IGZpZWxkID8gISRzY29wZS51c2VyUmV2ZXJzZSA6IGZhbHNlKTtcclxuICAgIGlmKGludmVydCkgeyAkc2NvcGUudXNlclJldmVyc2UgPSAoJHNjb3BlLnVzZXJGaWVsZCA9PT0gZmllbGQgPyAkc2NvcGUudXNlclJldmVyc2UgOiB0cnVlKTsgfVxyXG4gICAgJHNjb3BlLnVzZXJGaWVsZCA9IGZpZWxkO1xyXG4gIH1cclxuICBcclxuICAkc2NvcGUuY3JlYXRlVXNlciA9IGZ1bmN0aW9uKCkge1xyXG4gICAgdmFyIG5ld1VzZXJEYXRhID0ge1xyXG4gICAgICB1c2VyTmFtZTogJHNjb3BlLmVtYWlsLFxyXG4gICAgICBwYXNzd29yZDogJHNjb3BlLnBhc3N3b3JkLFxyXG4gICAgICBmaXJzdE5hbWU6ICRzY29wZS5maXJzdE5hbWUsXHJcbiAgICAgIGxhc3ROYW1lOiAkc2NvcGUubGFzdE5hbWVcclxuICAgIH07XHJcbiAgICBcclxuICAgIHN0QXV0aFN2Yy5jcmVhdGVVc2VyKG5ld1VzZXJEYXRhKS50aGVuKFxyXG4gICAgICBmdW5jdGlvbigpIHsgc3RUaWNrZXJTdmMubm90aWZ5KCdDcmVhdGVkIHVzZXIgYWNjb3VudCAnICsgbmV3VXNlckRhdGEudXNlck5hbWUgKyAgJy4nKTsgc3RBZG1pblN2Yy5hZG1pblJlZGlyZWN0KCcvYWRtaW4nKTsgfSwgXHJcbiAgICAgIGZ1bmN0aW9uKHJlYXNvbikgeyBzdFRpY2tlclN2Yy5lcnJvcihyZWFzb24pOyB9XHJcbiAgICApO1xyXG4gIH1cclxuICBcclxuICAkc2NvcGUucHVyZ2VVc2VycyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgc3RBZG1pblN2Yy5hZG1pblJlZGlyZWN0KCcvYWRtaW4nKTtcclxuICAgIHN0QWRtaW5TdmMudXBkYXRlUm9vdCgndXNlclB1cmdlSW5Qcm9ncmVzcycsIHRydWUpO1xyXG4gICAgJHRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcbiAgICAgIHN0QXV0aFN2Yy5wdXJnZVVzZXJzKCkudGhlbihcclxuICAgICAgICBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgc3RBZG1pblN2Yy5hZG1pblJlZGlyZWN0KCcvJyk7XHJcbiAgICAgICAgICAgIHN0QXV0aFN2Yy5sb2dvdXRVc2VyKCkudGhlbihcclxuICAgICAgICAgICAgZnVuY3Rpb24oKSB7ICR0aW1lb3V0KCRzY29wZS5wdXJnZURvbmUsIDUwMDApOyB9LFxyXG4gICAgICAgICAgICBmdW5jdGlvbihyZWFzb24pIHsgXHJcbiAgICAgICAgICAgICAgc3RUaWNrZXJTdmMuZXJyb3IocmVhc29uKTtcclxuICAgICAgICAgICAgICBzdEFkbWluU3ZjLnVwZGF0ZVJvb3QoJ3VzZXJQdXJnZUluUHJvZ3Jlc3MnLCBmYWxzZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICk7XHJcbiAgICAgICAgfSwgXHJcbiAgICAgICAgZnVuY3Rpb24ocmVhc29uKSB7IHN0VGlja2VyU3ZjLmVycm9yKHJlYXNvbik7ICR0aW1lb3V0KCRzY29wZS5wdXJnZURvbmUsIDUwMDApOyB9XHJcbiAgICAgICk7XHJcbiAgICB9LCA1MDAwKTtcclxuICB9XHJcbiAgXHJcbiAgJHNjb3BlLnN5bmNEYiA9IGZ1bmN0aW9uKGNvbGxlY3Rpb24sIHN5bmNEaXIpIHtcclxuICAgIGlmKGNvbGxlY3Rpb24gPT0gJ3VzZXJzJykge1xyXG4gICAgICBzdEFkbWluU3ZjLmFkbWluUmVkaXJlY3QoJy9hZG1pbicpO1xyXG4gICAgICBzdEFkbWluU3ZjLnVwZGF0ZVJvb3QoJ3VzZXJTeW5jSW5Qcm9ncmVzcycsIHRydWUpO1xyXG4gICAgICBzdEF1dGhTdmMuc3luY1VzZXJzKHN5bmNEaXIpLnRoZW4oXHJcbiAgICAgICAgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICBpZihzeW5jRGlyID09ICd0b2xvYycpIHtcclxuICAgICAgICAgICAgc3RBZG1pblN2Yy5hZG1pblJlZGlyZWN0KCcvJyk7XHJcbiAgICAgICAgICAgIHN0QXV0aFN2Yy5sb2dvdXRVc2VyKCkudGhlbihcclxuICAgICAgICAgICAgICBmdW5jdGlvbigpIHsgJHRpbWVvdXQoJHNjb3BlLnN5bmNEb25lLCA1MDAwKTsgfSxcclxuICAgICAgICAgICAgICBmdW5jdGlvbihyZWFzb24pIHtcclxuICAgICAgICAgICAgICAgIHN0VGlja2VyU3ZjLmVycm9yKHJlYXNvbik7XHJcbiAgICAgICAgICAgICAgICBzdEFkbWluU3ZjLnVwZGF0ZVJvb3QoJ3VzZXJTeW5jSW5Qcm9ncmVzcycsIHRydWUpO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGVsc2UgeyAkdGltZW91dCgkc2NvcGUuc3luY0RvbmUsIDUwMDApOyB9XHJcbiAgICAgICB9LFxyXG4gICAgICAgIGZ1bmN0aW9uKHJlYXNvbikgeyBzdFRpY2tlclN2Yy5lcnJvcihyZWFzb24pOyAkdGltZW91dCgkc2NvcGUuc3luY0RvbmUsIDUwMDApOyB9XHJcbiAgICAgICk7XHJcbiAgICB9XHJcbiAgfVxyXG4gIFxyXG4gICRzY29wZS5wYWdlVXNlcnMgPSBmdW5jdGlvbigpIHtcclxuICAgIHJldHVybiBNYXRoLmNlaWwoJHNjb3BlLnVzZXJSZXMubGVuZ3RoLyRzY29wZS51c2VyU2hvd09uUGFnZSk7XHJcbiAgfVxyXG4gIFxyXG4gICRzY29wZS5wdXJnZURvbmUgPSBmdW5jdGlvbigpIHtcclxuICAgIHN0VGlja2VyU3ZjLm5vdGlmeSgnVXNlciBkYXRhYmFzZSBoYXMgYmVlbiBwdXJnZWQuJyk7IFxyXG4gICAgc3RBZG1pblN2Yy51cGRhdGVSb290KCd1c2VyUHVyZ2VJblByb2dyZXNzJywgZmFsc2UpO1xyXG4gIH1cclxuICBcclxuICAkc2NvcGUuc3luY0RvbmUgPSBmdW5jdGlvbigpIHtcclxuICAgIHN0VGlja2VyU3ZjLm5vdGlmeSgnVXNlciBkYXRhYmFzZSBoYXMgYmVlbiBzeW5jZWQuJyk7IFxyXG4gICAgc3RBZG1pblN2Yy51cGRhdGVSb290KCd1c2VyU3luY0luUHJvZ3Jlc3MnLCB0cnVlKTtcclxuICB9XHJcbn0pOyIsImFuZ3VsYXIubW9kdWxlKCdzdGFnZScpLmZhY3RvcnkoJ3N0QWRtaW5TdmMnLCBmdW5jdGlvbigkbG9jYXRpb24sICRwYXJzZSwgJHJvb3RTY29wZSwgJHdpbmRvdykge1xyXG4gIHJldHVybiB7XHJcbiAgICBhZG1pblJlZGlyZWN0OiBmdW5jdGlvbihwYXRoKSB7XHJcbiAgICAgICRsb2NhdGlvbi5wYXRoKHBhdGgpO1xyXG4gICAgfSxcclxuICAgIHVwZGF0ZVJvb3Q6IGZ1bmN0aW9uKG9iaiwgdmFsKSB7XHJcbiAgICAgIHZhciByb290T2JqID0gJHBhcnNlKCckcm9vdFNjb3BlLicgKyBvYmopO1xyXG4gICAgICByb290T2JqID0gdmFsO1xyXG4gICAgfSxcclxuICAgIHdoYXRFbnY6IGZ1bmN0aW9uKCkge1xyXG4gICAgICByZXR1cm4gJHdpbmRvdy5lbnY7XHJcbiAgICB9XHJcbiAgfTtcclxufSk7IiwiYW5ndWxhci5tb2R1bGUoJ3N0YWdlJykuZmFjdG9yeSgnc3RBZG1pblVzZXJTdmMnLCBmdW5jdGlvbigkZmlsdGVyLCBzdFVzZXJTdmMpIHtcclxuICByZXR1cm4ge1xyXG4gICAgYWN0aW9uRG9uZTogZnVuY3Rpb24oYWN0KSB7XHJcbiAgICAgIHN3aXRjaChhY3QpIHtcclxuICAgICAgICBjYXNlICdwdXJnZSc6XHJcbiAgICAgICAgICB2YXIgYWN0VmVyYiA9ICdwdXJnZWQnXHJcbiAgICAgICAgICAkcm9vdFNjb3BlLnVzZXJQdXJnZUluUHJvZ3Jlc3MgPSBmYWxzZTtcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgJ3N5bmMnOlxyXG4gICAgICAgICAgdmFyIGFjdFZlcmIgPSAnc3luY2VkJ1xyXG4gICAgICAgICAgJHJvb3RTY29wZS51c2VyU3luY0luUHJvZ3Jlc3MgPSBmYWxzZTtcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcbiAgICAgIGlmKGFjdFZlcmIpIHtzdFRpY2tlclN2Yy5ub3RpZnkoJ1VzZXIgZGF0YWJhc2UgaGFzIGJlZW4gJyArIGFjdFZlcmIgKyAnLicpOyB9XHJcbiAgICB9LFxyXG4gICAgcG9wdWxhdGVVc2VyczogZnVuY3Rpb24oKSB7XHJcbiAgICAgIHJldHVybiBzdFVzZXJTdmMucXVlcnkoKTtcclxuICAgIH0sXHJcbiAgICBzZWFyY2hVc2VyczogZnVuY3Rpb24odXNlcnMsIHF1ZXJ5KSB7XHJcbiAgICAgIHJldHVybiAkZmlsdGVyKCd1c2VyZmluZCcpKHVzZXJzLCBxdWVyeSk7XHJcbiAgICB9XHJcbiAgfTtcclxufSk7IiwiYW5ndWxhci5tb2R1bGUoJ3N0YWdlJykuY29udHJvbGxlcignc3REZXZEYkN0cmwnLCBmdW5jdGlvbigkc2NvcGUsICRodHRwLCAkdGltZW91dCkge1xyXG4gICRzY29wZS5kZGJWaWV3ID0gbnVsbFxyXG4gICRzY29wZS5kZGJDb25zb2xlVHlwZSA9IG51bGxcclxuICAkc2NvcGUubG9jYWxNb25nb1N0YXR1cyA9IGZhbHNlO1xyXG4gICRzY29wZS5yZW1vdGVNb25nb1N0YXR1cyA9IGZhbHNlO1xyXG4gICRzY29wZS5henVyZVN0cmVhbVN0YXR1cyA9IGZhbHNlO1xyXG4gICRzY29wZS5kZGJTdHJlYW1XZWxsID0gJyc7XHJcblxyXG4gICRzY29wZS5kZGJDaGFuZ2VWaWV3ID0gZnVuY3Rpb24oc3ZjKSB7XHJcbiAgICBzd2l0Y2goc3ZjKSB7XHJcbiAgICAgIGNhc2UgJ292ZXJ2aWV3JzogXHJcbiAgICAgICAgJHNjb3BlLmRkYlZpZXcgPSBudWxsO1xyXG4gICAgICAgICRzY29wZS5kZGJDb25zb2xlVHlwZSA9IG51bGw7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgJ2xvY2FsTW9uZ28nOlxyXG4gICAgICAgICRzY29wZS5kZGJWaWV3ID0gc3ZjO1xyXG4gICAgICAgICRzY29wZS5kZGJDb25zb2xlVHlwZSA9ICdjbWQnO1xyXG4gICAgICAgICRzY29wZS5kZGJTdHJlYW1XZWxsID0gJ0Nvbm5lY3RlZCB0byBsb2NhbCBNb25nb0RCIHNlcnZpY2VcXG4nO1xyXG4gICAgICAgIGlmKCEkc2NvcGUubG9jYWxNb25nb1N0YXR1cykgJHNjb3BlLmRkYkNvbm5lY3Qoc3ZjKTtcclxuICAgICAgICAkc2NvcGUuZGRiU3RyZWFtKHN2Yyk7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgJ3JlbW90ZU1vbmdvJzpcclxuICAgICAgICAkc2NvcGUuZGRiVmlldyA9IHN2YztcclxuICAgICAgICAkc2NvcGUuZGRiQ29uc29sZVR5cGUgPSAnY21kJztcclxuICAgICAgICAkc2NvcGUuZGRiU3RyZWFtV2VsbCA9ICdDb25uZWN0ZWQgdG8gY2xvdWQgTW9uZ29EQiBzZXJ2aWNlXFxuJztcclxuICAgICAgICBpZighJHNjb3BlLnJlbW90ZU1vbmdvU3RhdHVzKSAkc2NvcGUuZGRiQ29ubmVjdChzdmMpO1xyXG4gICAgICAgICRzY29wZS5kZGJTdHJlYW0oc3ZjKTtcclxuICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSAnYXp1cmVTdHJlYW0nOlxyXG4gICAgICAgICRzY29wZS5kZGJWaWV3ID0gc3ZjO1xyXG4gICAgICAgICRzY29wZS5kZGJDb25zb2xlVHlwZSA9ICd2aWV3JztcclxuICAgICAgICAkc2NvcGUuZGRiU3RyZWFtV2VsbCA9ICdDb25uZWN0ZWQgdG8gQXp1cmUgbG9nIHN0cmVhbWluZyBzZXJ2aWNlXFxuJztcclxuICAgICAgICBpZighJHNjb3BlLmF6dXJlU3RyZWFtU3RhdHVzKSAkc2NvcGUuZGRiQ29ubmVjdChzdmMpO1xyXG4gICAgICAgICRzY29wZS5kZGJTdHJlYW0oc3ZjKTtcclxuICAgICAgICBicmVhaztcclxuICAgIH1cclxuICB9XHJcblxyXG4gICRzY29wZS5kZGJDb21tYW5kID0gZnVuY3Rpb24oKSB7XHJcbiAgICB2YXIgc3ZjID0gJHNjb3BlLmRkYlZpZXc7XHJcbiAgICBjb25zb2xlLmxvZyhzdmMpO1xyXG4gICAgaWYoJHNjb3BlLmRkYkNvbnNvbGVUeXBlICE9PSAnY21kJykgcmV0dXJuIGZhbHNlO1xyXG4gICAgZWxzZSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKCdUeXBlIGlzIGNtZCcpO1xyXG4gICAgICBjb25zb2xlLmxvZygkc2NvcGUuZGRiQ21kQmFyKTtcclxuICAgICAgY29uc29sZS5sb2coJHNjb3BlLmRkYklzQ29ubmVjdGVkKHN2YykpO1xyXG4gICAgICB2YXIgc3ZjU3RhdCA9IGZhbHNlXHJcbiAgICAgIHN3aXRjaChzdmMpIHtcclxuICAgICAgICBjYXNlICdsb2NhbE1vbmdvJzpcclxuICAgICAgICAgIHN2Y1N0YXQgPSAkc2NvcGUubG9jYWxNb25nb1N0YXR1cztcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgJ3JlbW90ZU1vbmdvJzpcclxuICAgICAgICAgIHN2Y1N0YXQgPSAkc2NvcGUucmVtb3RlTW9uZ29TdGF0dXM7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgfVxyXG4gICAgICBpZihzdmNTdGF0ICYmICRzY29wZS5kZGJDbWRCYXIpIHtcclxuICAgICAgICAkaHR0cC5wb3N0KCcvYXBpL2RldmRhc2gvJyArIHN2YyArICcvY29tbWFuZCcsIHtjbWQ6ICRzY29wZS5kZGJDbWRCYXJ9KS50aGVuKGZ1bmN0aW9uKHJlcykge1xyXG4gICAgICAgICAgJHNjb3BlLmRkYkNtZEJhciA9ICcnO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2UgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgJHNjb3BlLmRkYkNvbm5lY3QgPSBmdW5jdGlvbihzdmMpIHtcclxuICAgICRodHRwLmdldCgnL2FwaS9kZXZkYXNoLycgKyBzdmMgKyAnL2Nvbm5lY3QnLCB7Y2hlY2s6IHRydWV9KS50aGVuKGZ1bmN0aW9uKCkge1xyXG4gICAgICBpZihzdmMgPT0gJ2xvY2FsTW9uZ28nKSAkc2NvcGUubG9jYWxNb25nb1N0YXR1cyA9IHRydWU7XHJcbiAgICAgIGVsc2UgaWYoc3ZjID09ICdyZW1vdGVNb25nbycpICRzY29wZS5yZW1vdGVNb25nb1N0YXR1cyA9IHRydWU7XHJcbiAgICAgIGVsc2UgaWYoc3ZjID09ICdhenVyZVN0cmVhbScpICRzY29wZS5henVyZVN0cmVhbVN0YXR1cyA9IHRydWU7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gICRzY29wZS5kZGJEaXNjb25uZWN0ID0gZnVuY3Rpb24oc3ZjKSB7XHJcbiAgICAvLyAkaHR0cC5nZXQoJy9hcGkvZGV2ZGFzaC8nICsgc3ZjICsgJy9kaXNjb25uZWN0Jywge2NoZWNrOiB0cnVlfSkudGhlbihmdW5jdGlvbigpIHtcclxuICAgICAgaWYoc3ZjID09ICdsb2NhbE1vbmdvJykgJHNjb3BlLmxvY2FsTW9uZ29TdGF0dXMgPSBmYWxzZTtcclxuICAgICAgZWxzZSBpZihzdmMgPT0gJ3JlbW90ZU1vbmdvJykgJHNjb3BlLnJlbW90ZU1vbmdvU3RhdHVzID0gZmFsc2U7XHJcbiAgICAgIGVsc2UgaWYoc3ZjID09ICdhenVyZVN0cmVhbScpICRzY29wZS5henVyZVN0cmVhbVN0YXR1cyA9IGZhbHNlO1xyXG4gICAgLy8gfSk7XHJcbiAgfVxyXG5cclxuICAkc2NvcGUuZGRiSXNDb25uZWN0ZWQgPSBmdW5jdGlvbihzdmMpIHtcclxuICAgICRodHRwLmdldCgnL2FwaS9kZXZkYXNoLycgKyBzdmMgKyAnL3N0YXR1cycsIHtjaGVjazogdHJ1ZX0pLnRoZW4oZnVuY3Rpb24ocmVzKSB7XHJcbiAgICAgIGlmKHN2YyA9PSAnbG9jYWxNb25nbycpIHtcclxuICAgICAgICBpZihyZXMuZGF0YSA9PSAnQ29ubmVjdGVkJyAmJiByZXMuc3RhdHVzID09IDIwMCkge1xyXG4gICAgICAgICAgJHNjb3BlLmxvY2FsTW9uZ29TdGF0dXMgPSB0cnVlO1xyXG4gICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgJHNjb3BlLmxvY2FsTW9uZ29TdGF0dXMgPSBmYWxzZTtcclxuICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSBpZihzdmMgPT0gJ3JlbW90ZU1vbmdvJykge1xyXG4gICAgICAgIGlmKHJlcy5kYXRhID09ICdDb25uZWN0ZWQnICYmIHJlcy5zdGF0dXMgPT0gMjAwKSB7XHJcbiAgICAgICAgICAkc2NvcGUucmVtb3RlTW9uZ29TdGF0dXMgPSB0cnVlO1xyXG4gICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgJHNjb3BlLnJlbW90ZU1vbmdvU3RhdHVzID0gZmFsc2U7XHJcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIGVsc2UgaWYoc3ZjID09ICdhenVyZVN0cmVhbScpIHtcclxuICAgICAgICBpZihyZXMuZGF0YSA9PSAnQ29ubmVjdGVkJyAmJiByZXMuc3RhdHVzID09IDIwMCkge1xyXG4gICAgICAgICAgJHNjb3BlLmF6dXJlU3RyZWFtU3RhdHVzPSB0cnVlO1xyXG4gICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgJHNjb3BlLmF6dXJlU3RyZWFtU3RhdHVzID0gZmFsc2U7XHJcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gICRzY29wZS5kZGJTdHJlYW0gPSBmdW5jdGlvbihzdmMpIHtcclxuICAgIGlmKHR5cGVvZihFdmVudFNvdXJjZSkgIT09ICd1bmRlZmluZWQnKSB7XHJcbiAgICAgIHZhciBzdHJtU291cmNlID0gbmV3IEV2ZW50U291cmNlKCcvYXBpL2RldmRhc2gvJyArIHN2YyArICcvc3RyZWFtJyk7XHJcbiAgICAgIHN0cm1Tb3VyY2UuYWRkRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgJHNjb3BlLiRhcHBseShmdW5jdGlvbigpIHtcclxuICAgICAgICAgIHZhciBtc2cgPSBKU09OLnBhcnNlKGV2ZW50LmRhdGEpO1xyXG4gICAgICAgICAgLy8gUmVwbGFjZSBzcGVjaWFsIGNoYXJhY3RlcnNcclxuICAgICAgICAgIG1zZyA9IG1zZy5yZXBsYWNlKC9cXFswbS9nLCAnJyk7XHJcbiAgICAgICAgICBtc2cgPSBtc2cucmVwbGFjZSgvXFxbMzZtL2csICcnKTtcclxuICAgICAgICAgICRzY29wZS5kZGJTdHJlYW1XZWxsICs9IG1zZy50cmltKCkgKyAnXFxuJztcclxuICAgICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB2YXIgc3cgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3RyZWFtV2VsbCcpO1xyXG4gICAgICAgICAgICBzdy5zY3JvbGxUb3AgPSBzdy5zY3JvbGxIZWlnaHQ7XHJcbiAgICAgICAgICB9LCA1MCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0sIGZhbHNlKTtcclxuICAgICAgc3RybVNvdXJjZS5hZGRFdmVudExpc3RlbmVyKCdlcnJvcicsIGZ1bmN0aW9uKGVycikge1xyXG4gICAgICAgICRzY29wZS4kYXBwbHkoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAkc2NvcGUuZGRiRGlzY29ubmVjdChzdmMpO1xyXG4gICAgICAgICAgJHNjb3BlLmRkYlN0cmVhbVdlbGwgKz0gJ1RoZSBzdHJlYW0gZm9yICcgKyBzdmMgKyAnIGhhcyBiZWVuIHVuZXhwZWN0ZWRseSBjbG9zZWQuXFxuJztcclxuICAgICAgICB9KTtcclxuICAgICAgICBzdHJtU291cmNlLmNsb3NlKCk7XHJcbiAgICAgIH0sIGZhbHNlKTtcclxuICAgIH1cclxuICAgIGVsc2UgJHNjb3BlLmRkYlN0cmVhbVdlbGwgPSAnVGhpcyBicm93c2VyIGRvZXMgbm90IHN1cHBvcnQgc3RyZWFtaW5nLlxcbic7XHJcbiAgfVxyXG59KTsiLCJhbmd1bGFyLm1vZHVsZSgnc3RhZ2UnKS5mYWN0b3J5KCdzdERldkRiU3ZjJywgZnVuY3Rpb24oJGh0dHAsICRxLCAkcm9vdFNjb3BlKSB7XHJcbiAgcmV0dXJuIHtcclxuICB9O1xyXG59KTsiLCJhbmd1bGFyLm1vZHVsZSgnc3RhZ2UnKS5maWx0ZXIoJ3VzZXJTdGFydFBhZ2UnLCBmdW5jdGlvbigpIHtcclxuICAgIHJldHVybiBmdW5jdGlvbihpbnB1dCwgc3RhcnQpIHtcclxuICAgICAgICBzdGFydCA9ICtzdGFydDtcclxuICAgICAgICByZXR1cm4gaW5wdXQuc2xpY2Uoc3RhcnQpO1xyXG4gICAgfVxyXG59KTsiLCJhbmd1bGFyLm1vZHVsZSgnc3RhZ2UnKS5maWx0ZXIoJ3VzZXJmaW5kJywgZnVuY3Rpb24oKSB7XHJcbiAgcmV0dXJuIGZ1bmN0aW9uKHVzZXJzLCBxKSB7XHJcbiAgICB2YXIgbWF0Y2hlZCA9IFtdO1xyXG4gICAgYW5ndWxhci5mb3JFYWNoKHVzZXJzLCBmdW5jdGlvbih1KSB7XHJcbiAgICAgIHRyeSB7IHZhciBleHAgPSBuZXcgUmVnRXhwKHEsICdnaScpOyB9IGNhdGNoKGUpIHsgcmV0dXJuIFtdOyB9XHJcbiAgICAgIGlmKHUudXNlck5hbWUubWF0Y2goZXhwKSB8fCB1LmZpcnN0TmFtZS5tYXRjaChleHApIHx8IHUubGFzdE5hbWUubWF0Y2goZXhwKSB8fCBxID09ICcnKSB7XHJcbiAgICAgICAgbWF0Y2hlZC5wdXNoKHtcclxuICAgICAgICAgIF9pZDogdS5faWQsIFxyXG4gICAgICAgICAgdXNlck5hbWU6IHUudXNlck5hbWUsIFxyXG4gICAgICAgICAgZmlyc3ROYW1lOiB1LmZpcnN0TmFtZSwgXHJcbiAgICAgICAgICBsYXN0TmFtZTogdS5sYXN0TmFtZSxcclxuICAgICAgICAgIHJvbGVzOiB1LnJvbGVzXHJcbiAgICAgICAgfSlcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gbWF0Y2hlZDtcclxuICB9XHJcbn0pOyIsImFuZ3VsYXIubW9kdWxlKCdzdGFnZScpLmNvbnRyb2xsZXIoJ3N0TWFpbkN0cmwnLCBmdW5jdGlvbigkc2NvcGUpIHtcclxuXHJcbn0pOyIsImFuZ3VsYXIubW9kdWxlKCdzdGFnZScpLmNvbnRyb2xsZXIoJ3N0VGlja2VyQ3RybCcsIFsnJHNjb3BlJywgJ3N0VGlja2VyU3ZjJywgZnVuY3Rpb24oJHNjb3BlLCBzdFRpY2tlclN2Yykge1xyXG4gICRzY29wZS5jdXN0b20gPSBzdFRpY2tlclN2Yy5jdXN0b20oKTtcclxuICAkc2NvcGUucmVzZXQgPSBzdFRpY2tlclN2Yy5yZXNldCgpO1xyXG4gICRzY29wZS5zaG93QWxsID0gZnVuY3Rpb24oKSB7ICQoJy50aWNrZXItY29udGFpbmVyJykudG9nZ2xlQ2xhc3MoJ2V4cGFuZGVkJyk7IH1cclxufV0pOyIsImFuZ3VsYXIubW9kdWxlKCdzdGFnZScpLmZhY3RvcnkoJ3N0VGlja2VyU3ZjJywgZnVuY3Rpb24oKSB7XHJcbiAgdmFyIGZ0ciA9ICcvL3RhcmRpZ3JhZGUvbm9kZSB8IFRhcmRpZ3JhZGUgRGlnaXRhbCAmY29weTsgMjAxNic7XHJcbiAgdmFyIHRvc2V0ID0gZmFsc2U7XHJcbiAgdmFyIHRvID0gbnVsbDtcclxuICBcclxuICBmdW5jdGlvbiBhZGRUaWNrZXIobXNnLCBsdmwsIGljKSB7XHJcbiAgICBtc2cgPSBsdmwgPyAoJyAnICsgbXNnKSA6IG1zZztcclxuICAgIHZhciBtc2dvYmogPSAkKCc8c3Bhbj48L3NwYW4+JykuYWRkQ2xhc3MoJ3RpY2tlci1tc2cnKS5odG1sKG1zZyk7XHJcbiAgICBpZihpYykgeyBcclxuICAgICAgaWMgPSAkKCc8c3Bhbj48L3NwYW4+JykuYWRkQ2xhc3MoJ2ljb25pYyBpY29uaWMtc20gJyArIGljKTsgXHJcbiAgICAgIG1zZ29iai5wcmVwZW5kKGljKTsgXHJcbiAgICB9XHJcbiAgICBpZihsdmwpIHsgbXNnb2JqLmFkZENsYXNzKGx2bCk7IH1cclxuICAgICQoJyN0aWNrZXInKS5hZGRDbGFzcygnb24nKS5wcmVwZW5kKG1zZ29iaik7XHJcbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkgeyQoJyN0aWNrZXInKS5yZW1vdmVDbGFzcygnb24nKTt9LCAzMDApO1xyXG4gICAgaWYoIXRvc2V0KSB7IHRvc2V0ID0gdHJ1ZTsgdG8gPSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkgeyByZXNldFRpY2tlcigpOyB0b3NldCA9IGZhbHNlOyB9LCA4MDAwKTsgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgIGNsZWFyVGltZW91dCh0byk7XHJcbiAgICAgIHRvID0gc2V0VGltZW91dChmdW5jdGlvbigpIHsgcmVzZXRUaWNrZXIoKTsgdG9zZXQgPSBmYWxzZTsgfSwgODAwMCk7XHJcbiAgICB9XHJcbiAgfVxyXG4gIFxyXG4gIGZ1bmN0aW9uIHJlc2V0VGlja2VyKCkge1xyXG4gICAgJCgnI3RpY2tlciAjZnRybXNnJykucmVtb3ZlKCk7XHJcbiAgICB2YXIgbXNnb2JqID0gJCgnPHNwYW4+PC9zcGFuPicpLmh0bWwoZnRyKS5hdHRyKCdpZCcsICdmdHJtc2cnKTtcclxuICAgICQoJyN0aWNrZXInKS5hZGRDbGFzcygnb24nKS5wcmVwZW5kKG1zZ29iaik7XHJcbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkgeyQoJyN0aWNrZXInKS5yZW1vdmVDbGFzcygnb24nKTt9LCAzMDApO1xyXG4gIH1cclxuICBcclxuICByZXR1cm4ge1xyXG4gICAgY3VzdG9tOiBmdW5jdGlvbihtc2csIGx2bCwgaWMpIHsgaWYoIW1zZykgeyByZXR1cm4gZmFsc2U7IH07IGFkZFRpY2tlcihtc2csIGx2bCwgKCdpY29uaWMtJyArIGljKSk7IH0sXHJcbiAgICBub3RpZnk6IGZ1bmN0aW9uKG1zZykgeyBpZighbXNnKSB7IHJldHVybiBmYWxzZTsgfTsgYWRkVGlja2VyKG1zZywgJ3N1Y2Nlc3MnLCAnaWNvbmljLWNpcmNsZS1jaGVjaycpOyB9LFxyXG4gICAgZXJyb3I6IGZ1bmN0aW9uKG1zZykgeyBpZighbXNnKSB7IHJldHVybiBmYWxzZTsgfTsgYWRkVGlja2VyKG1zZywgJ2Vycm9yJywgJ2ljb25pYy1jaXJjbGUteCcpOyB9LFxyXG4gICAgaW5mbzogZnVuY3Rpb24obXNnKSB7IGlmKCFtc2cpIHsgcmV0dXJuIGZhbHNlOyB9OyBhZGRUaWNrZXIobXNnLCBudWxsLCAnaWNvbmljLWluZm8nKTsgfSxcclxuICAgIHJlc2V0OiBmdW5jdGlvbigpIHsgcmVzZXRUaWNrZXIoKTsgfVxyXG4gIH1cclxufSk7Il0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
